(function(m){var k=window.AmazonUIPageJS||window.P,n=k._namespace||k.attributeErrors,a=n?n("DetailPageAlohaAssets"):k;a.guardFatal?a.guardFatal(m)(a,window):a.execute(function(){m(a,window)})})(function(m,k,n){m.when("A","a-modal").register("aloha.utils",function(a,h){return{showAjaxErrorModal:function(a,c,b){var d=h.get(a);null===d?d=h.create(a,{content:b,header:c}):d.update({content:b,header:c});d.show().refresh()}}});m.when("ready").register("aloha-buy-now-integration",function(){var a=
{};m.when("turbo-checkout-buy-now-integration").execute(function(h){a=h});return{isBuyNow:function(h){return"function"===typeof a.isBuyNow&&a.isBuyNow(h)},checkoutWith:function(h,e){return a.checkoutWith(h,e)}}})});
/* ******** */
(function(m){var p=window.AmazonUIPageJS||window.P,q=p._namespace||p.attributeErrors,f=q?q("SimilaritiesDetailJS",""):p;f.guardFatal?f.guardFatal(m)(f,window):f.execute(function(){m(f,window)})})(function(m,p,q){m.when("jQuery","A").execute("sims-bind-parse-aui",function(f,d){function n(){var h=d.parseJSON;d.each(f('script[type\x3d"a-state"]'),function(k){k=f(k);if(!k.data("a-eval")){var g=k.attr("data-a-state");if(g&&(g=h(g),g.key&&-1!==f.inArray(g.key,l))){var a=h(k.html());d.state.replace(g.key,
a);k.data("a-eval",!0)}}})}var l=["sims-fbt","sims-list","view_to_purchase-sims-weblab-state"];d.on("a:pageUpdate",function(){n()})});m.when("jQuery","A","a-checkbox","p13n-sc-util","p13n-sc-call-on-visible","p13n-sc-logger").register("sims-fbt",function(f,d,n,l,h,k){function g(a){var b=this,c=a.data("sims-fbt-instance");if(c)return c;a.data("sims-fbt-instance",b);b.hasLazyInitialized=!1;f(".sims-fbt-checkbox input").show();b.$fbtRootElement=a;b.$detailsLinkText=b.$fbtRootElement.find(".sims-fbt-details-link a");
b.auiCheckboxes=[];c=this.$fbtRootElement.find("div.sims-fbt-checkbox");this.numOfItems=c.length;for(var e=0;e<this.numOfItems;e++)this.auiCheckboxes[e]=n(c[e]),this.auiCheckboxes[e].check();d.declarative.remove(b.$detailsLinkText,"details-link-click");d.declarative.remove(f(".sims-fbt-details-help-link"),"help-link-click");d.declarative.remove(f(".sims-fbt-map-details-link"),"help-link-click");d.declarative.create(b.$detailsLinkText,"details-link-click");d.declarative.create(f(".sims-fbt-details-help-link"),
"help-link-click");d.declarative.create(f(".sims-fbt-map-details-link"),"help-link-click");var g=f("#sims-fbt-container");h.register(a,function(){k.logAction({featureElement:g,action:"view",replicateAsinImpressions:!0,meta:{numsims:b.numOfItems}})});return b}g.prototype={lazyInitialize:function(){if(!this.hasLazyInitialized){this.$priceBlock=this.$fbtRootElement.find(".sims-fbt-price-box");this.$totalPriceDiv=this.$priceBlock.find(".sims-fbt-total-price");this.$addToCartButton=this.$priceBlock.find(".sims-fbt-add-to-cart");
this.$addToWishlistButton=this.$priceBlock.find(".sims-fbt-add-to-wishlist");this.$sellerInfo=this.$fbtRootElement.find(".sims-fbt-seller-info");this.$detailsText=this.$fbtRootElement.find(".sims-fbt-shipping-details-text");this.haveDetails=0!==this.$detailsText.length;try{this.FBTData=d.state("sims-fbt")}catch(a){l.log.error("[sims-fbt] Unable to find Data Attribute (page state) "+a);return}this.images=[];this.plusSigns=[];for(var b=0;b<this.numOfItems;b++)this.images[b]=this.$fbtRootElement.find(".sims-fbt-image-"+
(b+1)),0<b&&(this.plusSigns[b]=this.$fbtRootElement.find(".sims-fbt-plus-"+(b+1)));this.hasLazyInitialized=!0}},toggleSellerInfo:function(){this.lazyInitialize();var a=this.$sellerInfo.is(":hidden");a||this.$sellerInfo.hide();this.updateSellerText(a);a&&this.$sellerInfo.show(200)},handleCheckboxChange:function(a){var b=a.$declarativeParent,c=a.data,e=parseInt(c.itemNum,10);this.lazyInitialize();this.auiCheckboxes[e-1].disable();a=this.$priceBlock;this.auiCheckboxes[e-1].isUnchecked()&&(a=a.add(this.handleItemUnchecked(b,
c,e)));var f=this;a.fadeOut(function(){f.handleItemChecked(b,c,e)})},handleItemChecked:function(a,b,c){this.updateButtons(a);this.updateTotalPrice(a);this.updateSellerText(this.$sellerInfo.is(":visible"));if(0<=this.findFirstCheckedItem()){b=this.$priceBlock;this.auiCheckboxes[c-1].isChecked()&&(a.find(".sims-fbt-checkbox-label").removeClass("sims-fbt-unselected-item"),a=this.findFirstVisibleItem(),1<=a&&(c>a?b=b.add(this.plusSigns[c-1]):c<a&&(b=b.add(this.plusSigns[a-1]))),b=b.add(this.images[c-
1]));var e=this;b.fadeIn(function(){e.auiCheckboxes[c-1].enable()})}else this.auiCheckboxes[c-1].enable()},handleItemUnchecked:function(a,b,c){a.find(".sims-fbt-checkbox-label").addClass("sims-fbt-unselected-item");a=this.images[c-1];1<c&&(a=a.add(this.plusSigns[c-1]));c=this.findFirstCheckedItem();1<c&&(a=a.add(this.plusSigns[c-1]));return a},findFirstVisibleItem:function(){for(var a=1;a<=this.numOfItems;a++)if(this.images[a-1].is(":visible"))return a;return-1},findFirstCheckedItem:function(){for(var a=
1;a<=this.numOfItems;a++)if(this.auiCheckboxes[a-1].isChecked())return a;return-1},updateButtons:function(a){a=this.getOfferListingIDsSeletected();for(var b=1,c="preOrderText",e=a.length-1;0<=e;e--)if(!this.FBTData.itemDetails[a[e]].isPreorder){c="addToCartText";b=0;break}b?this.$addToCartButton.removeClass("a-button-primary").addClass("a-button-preorder"):this.$addToCartButton.removeClass("a-button-preorder").addClass("a-button-primary");1<=a.length?(this.$addToCartButton.find(".a-button-text").text(this.FBTData[c][a.length]),
this.$addToCartButton.attr("disabled")&&(this.$addToCartButton.removeClass("a-button-disabled"),this.$addToCartButton.removeAttr("disabled")),this.$addToWishlistButton.find(".a-button-text").text(this.FBTData.addToWishListText[a.length]),this.$addToWishlistButton.attr("disabled")&&(this.$addToWishlistButton.removeClass("a-button-disabled"),this.$addToWishlistButton.removeAttr("disabled"))):(this.$addToCartButton.find(".a-button-text").text(this.FBTData.addToCartText[1]),this.$addToCartButton.addClass("a-button-disabled"),
this.$addToCartButton.attr("disabled","disabled"),this.$addToWishlistButton.find(".a-button-text").text(this.FBTData.addToWishListText[1]),this.$addToWishlistButton.addClass("a-button-disabled"),this.$addToWishlistButton.attr("disabled","disabled"))},updateTotalPrice:function(a){var b=this.getOfferListingIDsSeletected(),c=/(<span class=\"sims-fbt-price-value\">)(.*)(<\/span>)/,e=0,f=a=0,d=0;if(0===b.length)this.$totalPriceDiv.hide();else{for(var g=0;g<b.length&&!d;g++){if(this.FBTData.itemDetails[b[g]].doesMAPPolicyApply){d=
1;break}else isFinite(this.FBTData.itemDetails[b[g]].price)&&(e+=parseFloat(this.FBTData.itemDetails[b[g]].price,10));isFinite(this.FBTData.itemDetails[b[g]].points)&&(a+=parseInt(this.FBTData.itemDetails[b[g]].points,10),f+=parseFloat(this.FBTData.itemDetails[b[g]].pointsValue,10))}this.$totalPriceDiv.show();b=this.$totalPriceDiv.find(".sims-fbt-total-price-value");d?(b.html(this.FBTData.MAPText),b.removeClass("a-color-price").addClass("sims-fbt-map-text").addClass("a-size-base")):(d=this.FBTData.currencySymbol,
g=this.formatPrice(e),d=d.match(c)?d.replace(c,"$1"+g+"$3"):d+g,b.html(d),b.removeClass("sims-fbt-map-text").addClass("a-color-price").removeClass("a-size-base"));c=this.$totalPriceDiv.find(".sims-fbt-points-wrapper");0<a?(e=parseInt(100*f/e+.5,10),f=c.find(".sims-fbt-points-value"),d=c.find(".sims-fbt-points-percentage"),f.html(a),d.html(e),c.show()):c.hide()}},getOfferListingIDsSeletected:function(){var a=[];f("input",".sims-fbt-checkbox").each(function(){this.checked&&a.push(this.value)});return a},
formatPrice:function(a){for(var b=(a-parseInt(a,10)).toFixed(2),b=b.replace("0.","."),c=parseInt(a,10),e=0;0<c;){var d=c%10,c=parseInt(c/10,10),b=d.toString()+b;e++;0===e%3&&0<c&&(b=","+b)}"EUR"===this.FBTData.currencyCode?(b=b.replace(/,/,"+"),b=b.replace(/\./,","),b=b.replace(/\+/,".")):"JPY"===this.FBTData.currencyCode&&(b=b.replace(".00",""));1>Math.abs(a)&&(b="0"+b);return b},updateSellerText:function(a){var b="",c="",e="",e=0;if(this.haveDetails){for(c=1;c<=this.numOfItems;c++)this.auiCheckboxes[c-
1].isChecked()&&(b+=c,e++);c=0===e?this.getString("noDetails"):1===e?"":"seller"===this.FBTData.shippingDetails[b]?this.getString("differentSellers"):"availabilityone"===this.FBTData.shippingDetails[b]?this.getString("differentAvailabilityOne"):"availabilitysome"===this.FBTData.shippingDetails[b]?this.getString("differentAvailabilitySome"):"";e=0===e?"":""===c?this.getString(a?"hideDetailsLong":"showDetailsLong"):this.getString(a?"hideDetails":"showDetails");c!==this.$detailsText.text()&&this.$detailsText.text(c);
e!==this.$detailsLinkText.text()&&this.$detailsLinkText.text(e)}},getString:function(a){if(this.FBTData&&this.FBTData.fbtStrings)return this.FBTData.fbtStrings[a]}};(function(){function a(){return f("#sims-fbt-content").data("sims-fbt-instance")}function b(){var a=f("#sims-fbt-content");a.length&&new g(a)}d.declarative("help-link-click","click",function(a){a.$event.preventDefault();p.open(a.$event.target.href,"AmazonHelp","width\x3d550,height\x3d550,resizable\x3d1,scrollbars\x3d1,toolbar\x3d0,status\x3d0").focus();
return!1});d.declarative("details-link-click","click",function(b){b.$event.preventDefault();(b=a())&&b.toggleSellerInfo()});d.declarative("fbt-checkbox-click","change",function(b){var e=a();e&&e.handleCheckboxChange(b)});d.state.bind("sims-fbt",b);d.on("afterReady",b)})();return g});m.when("A","jQuery","p13n-sc-call-on-visible","p13n-sc-logger").execute("sims-vtp-logger",function(f,d,n,l){var h=d(".vtp-container");0<h.length&&n.register(h,function(){l.logAction({featureElement:h,action:"view",replicateAsinImpressions:!0})})});
m.when("A","jQuery","p13n-sc-call-on-visible","p13n-sc-logger").execute("sims-vtp-logger",function(f,d,n,l){var h=d("#vtp_hero-sims-feature");0<h.length&&n.register(h,function(){l.logAction({featureElement:h,action:"view",replicateAsinImpressions:!0})})});(function(f,d){m.when("jQuery","A","a-carousel-framework","p13n-sc-util").register("sims-prime-filter-checkbox-carousel",function(d,l,h,k){l.declarative("filterPrimeCheckbox-change","change",function(g){var a=g.$target.prop("checked");if(g=g.$declarativeParent.parents().find(".sims-carousel-holder")){var b=
g.data("similarity-type");if(b){var c;if(c=a?d("#"+b+"-sims-filtered-carousel").html():d("#"+b+"-sims-unfiltered-carousel").html())return g.replaceWith(function(){return d(c).hide().fadeIn()}),a=a?"p13n:sims:prime-list:checkbox:checked":"p13n:sims:prime-list:checkbox:unchecked",k.count(a,(f.ue.count(a)||0)+1),h.createAll(),h.initializeAll(),!0;k.log.error("Sims-prime-filtering: Unable to find a carousel to replace the existing carousel with")}else k.log.error("Sims-prime-filtering: unable to find the required data-attribute similarityType")}else k.log.error("Sims-prime-filtering: sims-carousel-holder could not be found")})})})(p,
document)});
/* ******** */
(function(l){var v=window.AmazonUIPageJS||window.P,y=v._namespace||v.attributeErrors,b=y?y("SoftlinesRecommendationsAssets"):v;b.guardFatal?b.guardFatal(l)(b,window):b.execute(function(){l(b,window)})})(function(l,v,y){l.when("A","jQuery","softlines-utils","atf").register("looks-data-cache",function(b,d,c){var a=d("#multipleRecommendations"),f=[],e=!1,h=[],g="cts",k=!1,l={};if(0<a.length){var q=a.attr("data-ids");if(c.isString(q))if(q=b.parseJSON(q),d.isPlainObject(q)&&d.isArray(q.recommendations)){b=
q.recommendations;for(var u=b.length,q=0;q<u;q++){var n=b[q];if(d.isPlainObject(n)&&d.isArray(n.asins)){var p=n.asins;if(d.isArray(p)){p=p.splice(0,Math.min(4,p.length));n.asins=p;h.push(n);for(var v=p.length,y=[],n=0;n<v;n++){var A=p[n];d.isPlainObject(A)&&c.isString(A.asin)&&y.push(A.asin)}p=y.join();p=encodeURIComponent(p);f.push(p)}}}1<u&&(e=!0)}else if(d.isPlainObject(q)&&d.isPlainObject(q.recommendations)&&(b=q.recommendations.recommendations,g=q.recommendations.reftagSuffix,null!==q.recommendations.recommendationUrlParams&&
(l=d.param(q.recommendations.recommendationUrlParams)),k=!0,d.isArray(b))){u=b.length;for(q=0;q<u;q++)if(n=b[q],d.isArray(n)){p=n.splice(0,Math.min(4,n.length));h.push(p);v=p.length;y=[];for(n=0;n<v;n++)A=p[n],d.isPlainObject(A)&&c.isString(A.id)&&y.push(A.id);p=y.join();p=encodeURIComponent(p);f.push(p)}1<u&&(e=!0)}}var A=a.attr("data-asin"),S=a.attr("data-injectedViewModel"),H=a.attr("data-showSimplifiedPrice"),ja=a.attr("data-showRecommendationsPrimeEligibility"),da=a.attr("data-primeEligibleLocale");
return{getLooks:function(){return h},getLooksAsins:function(){return f},getAsin:function(){return A},getRecommendationUrlParams:function(){return l},getReftagSuffix:function(){return g},isShovelerArrowsEnabled:function(){return e},isNewFormat:function(){return k},getInjectedViewModel:function(){return S},getShowSimplifiedPrice:function(){return H},getShowRecommendationsPrimeEligibility:function(){return ja},getIsPrimeEligibleLocale:function(){return da}}});l.when("A","jQuery","recommendations-carousel-data",
"softlines-utils","looks-data-cache","atf").register("complete-the-look-carousel-data",function(b,d,c,a,f){b=b.extend({},c);var e={SOFTLINES_CTL:"ctl-carousel",SOFTLINES_RECS_CTL:"srecs-ctl-carousel",ctl:"ctl-carousel",srecsc:"srecs-ctl-carousel"};b.getCounterPrefix=function(a){return e[a]};b.getProducts=function(){var b=[],c=f.getLooks(),e,l,q=c.length;for(e=0;e<q;e++){var u=c[e];if(d.isPlainObject(u)&&d.isArray(u.asins)){var n=u.asins,p=n.length;for(l=0;l<p;l++){var v=n[l];d.isPlainObject(v)&&a.isString(v.asin)&&
b.push(v.asin)}}if(d.isArray(u))for(n=u,p=n.length,l=0;l<p;l++)v=n[l],d.isPlainObject(v)&&a.isString(v.id)&&(u="",null!==v.asinSpecificUrlParams&&(u=d.param(v.asinSpecificUrlParams)),b.push(v.id+":"+u))}return b};b.getDataSetType=function(){var b=f.getLooks(),c=b.length,e="";if(!0===f.isNewFormat())return f.getReftagSuffix();0<c&&(b=b[0],d.isPlainObject(b)&&d.isArray(b.asins)&&(b=b.asins,0<b.length&&(b=b[0],d.isPlainObject(b)&&a.isString(b.asinDataSetType)&&(e=b.asinDataSetType))));return e};return b});
l.when("jQuery","softlines-utils","looks-data-cache","atf").register("lookFeedback",function(b,d,c){function a(){0<q.length&&0<l.length&&(q.removeClass("visibleFeedbackBlock"),l.removeClass("hidden"),q.addClass("hidden"),l.addClass("visibleFeedbackBlock"));"undefined"!==typeof Storage&&localStorage.setItem(e,"1")}function f(a){b.ajax({timeout:4E3,type:"GET",url:"/gp/softlines/logger/seed/"+g+"/look/"+h+("/ref=ctl_look_"+k+"_vote_"+a),data:{vote:a}})}var e,h,g=c.getAsin(),k,l=b("#afterCtlFeedback"),
q=b("#beforeCtlFeedback");b("#ctlButtonYes").click(function(){a();f("yes")});b("#ctlButtonNo").click(function(){a();f("no")});return{updateFeedback:function(a){k=a;--a;var b=c.getLooksAsins();0<=a&&a<b.length&&(h=b[a]);e=g+h;"undefined"!==typeof Storage&&(a=localStorage.getItem(e),0<q.length&&0<l.length&&(q.removeClass("hiddenFeedbackBlock"),"1"===a?(q.addClass("hidden"),l.removeClass("hidden"),l.addClass("visibleFeedbackBlock")):(q.removeClass("hidden"),q.addClass("visibleFeedbackBlock"),l.addClass("hidden"))))}}});
l.when("A","metrics-logger").register("csm-metrics-logger",function(b,d){var c=v.ue,a=b.extend({},d);a.addCount=function(a,b){var d=c.count(a)||0;c.count(a,d+b)};return a});l.when("jQuery","softlines-utils","looks-data-cache").register("ob-link-generator",function(b,d,c){return{getOutfitBuilderUrlForPageNumber:function(a){--a;var f,e=b("#outfitBuilder"),h=c.getLooksAsins();0<=a&&a<h.length&&0<e.length&&(e=e.data("outfitbuilderurlprefix"),d.isStringNotEmpty(e)&&(f=e+h[a]));return f}}});l.when("A",
"jQuery","a-carousel-framework","a-carousel-ajax-standard","complete-the-look-carousel-data","looks-data-cache","softlines-utils","csm-metrics-logger","ob-link-generator","lookFeedback","ready").execute("complete-the-look-ajax",function(b,d,c,a,f,e,h,g,k,l){var q=f.getDataSetType(),u=f.getCounterPrefix(q);b=b.extend({},a);b.getItems=function(b,c,d){d.asin=e.getAsin();d.dataSetType=f.getDataSetType();d.reftagSuffix=e.getReftagSuffix();d.recommendationsUrlParams=e.getRecommendationUrlParams();var g=
e.getInjectedViewModel();h.isStringNotEmpty(g)&&(d.injectViewModel=g);d.showSimplifiedPrice=e.getShowSimplifiedPrice();d.showRecommendationsPrimeEligibility=e.getShowRecommendationsPrimeEligibility();d.isPrimeEligibleLocale=e.getIsPrimeEligibleLocale();a.getItems(b,c,d)};b.init=function(b){l.updateFeedback(1);var c=f.getProducts();b.setAttr("ajax",{url:"/gp/product/ajax-handlers/complete-the-look-carousel.html",id_list:c});return a.init(b)};b.afterInit=function(b){a.afterInit(b);var c=e.getLooks(),
f=0;d.isArray(c)&&(f=c.length);g.addCount(u+":shown",1);b.onChange("pageNumber",function(a,b){var c=":back";a>b&&(c=":next");a===f&&1===b&&(c=":back");b===f&&1===a&&(c=":next");l.updateFeedback(a);var e=d("#outfitBuilder");if(0<e.length){var n=k.getOutfitBuilderUrlForPageNumber(a);h.isStringNotEmpty(n)&&e.attr("href",n)}g.addCount(u+":page:"+a+c,1)})};c.registerStrategy("ajax","complete-the-look",b)});l.when("A","jQuery","a-carousel-framework","looks-data-cache","complete-the-look-carousel-data",
"csm-metrics-logger","ready").execute("complete-the-look-display",function(b,d,c,a,f,e){function h(a){function b(a){a.dom.$viewport.css("height","")}a.onChange("pageNumber",function(){a.dom.$carousel.children("li").css("visibility","")});a.onChange("pageSize",function(c,d){c>d&&b(a)});a.onChange("loading",function(c){c||b(a)});a.onChange("firstVisibleItem",function(){b(a)});a.onChange("animating",function(b,c){if(!b){var e=a.getAttr("firstVisibleItem")-1,f=e+a.getAttr("pageSize");a.dom.$carousel.children("li").each(function(a,
b){var c=a>=e&&a<f;d(b).css("visibility",c?"":"hidden").attr("aria-hidden",c?"false":"true")})}});a.onChange("single_page_align minimum_gutter_width",function(){this.repaint(a)});a.onChange("minimum_gutter_width",function(){this.repaint(a)});a.onChange("pageNumber",function(a){l.when("is-softlines-recommendations-edp-enabled").execute(function(b){b&&l.when("srecs-edp-carousel-page-change-handler").execute(function(b){b.refreshEDP(a)})})})}var g=.82;b=f.getDataSetType();var k=f.getCounterPrefix(b),
v=d("#recommendations");c.registerStrategy("display","complete-the-look",{repaint:function(b){a.isShovelerArrowsEnabled()||(g=1);b.getDimensions();var c=v.width()*g,d=Math.round(.225*c),e=Math.round(.0125*c);b.setAttr("currentGutter",0);b.setAttr("pageSize",4);var f=b.dom.$carousel,h=f.children("li"),c=h.length,k=b.getAttr("firstVisibleItem")-1,l=k+4,y=d+"px",ja="0 "+e+"px";h.each(function(a,b){var c=a>=k&&a<l;b.style.visibility=c?"":"hidden";b.style.width=y;b.style.margin=ja;b.setAttribute("aria-hidden",
c?"false":"true")});e=h.first().outerWidth(!0);h=c*e;f.removeClass("a-text-right a-text-center");f.css("width",h+"px");f={carousel:{width:h,outerWidth:f.outerWidth()},items:[]};for(h=0;h<c;h++)f.items.push({width:d,outerWidth:e});b.updateDimensionsCache(f);b.gotoIndex(b.getAttr("firstVisibleItem"),{animationDuration:0});b.triggerEvent("repaint")},resize:function(a,b){b.viewport&&void 0!==b.viewport.width&&(this.repaint(a),e.addCount(k+":resized",1))},init:function(b){var c=a.isShovelerArrowsEnabled(),
d=[];c&&(d=f.getProducts());0<d.length&&b.setAttr("set_size",d.length);b.setAttr("minimum_gutter_width",0);b.setAttr("first_item_flush_left",!0);this.repaint(b);c&&(c=b.getDimensions(),b.dom.$container.find(".a-carousel-left, .a-carousel-right, .a-carousel-viewport").css("height",Math.max(c.viewport.height,c.items[0]?c.items[0].height:0)+"px"));c=b.getAttr("firstVisibleItem");1<c&&(b.setAttr("firstVisibleItem",c),c=Math.ceil(c/b.getAttr("pageSize")),b.gotoPage(c));h(b)}})});l.when("jQuery").register("softlines-utils",
function(b){function d(a){return"undefined"!==b.type(a)&&"null"!==b.type(a)}function c(a){return d(a)&&"string"===b.type(a)}return{isNotNull:d,isString:c,isStringNotEmpty:function(a){return c(a)&&0<a.length}}});l.register("metrics-logger",function(){return{addCount:function(b,d){}}});l.register("recommendations-carousel-data",function(){return{getProducts:function(){}}});l.when("jQuery","atf").register("is-softlines-recommendations-edp-enabled",function(b){var d=!1;0<b("#recommendationsData").length&&
(d=!0);return d});l.when("is-softlines-recommendations-edp-enabled").execute(function(b){b&&(l.when("A","jQuery","atf").register("recommendations-data-cache",function(b,c){var a,f,e,h=!1,g=!1,k,l=c("#recommendationsData");if(0<l.length){a=l.attr("data-seed-asin");var q=l.attr("data-recommended-asins");"undefined"!==typeof q&&(f=b.parseJSON(q));e=l.attr("data-dataset-type");h="true"===l.attr("data-is-multiple-looks-enabled");g="true"===l.attr("data-is-shoveler-enabled");q=l.attr("data-edp-defect-display-data");
"undefined"!==typeof q&&(k=b.parseJSON(q))}return{getSeedAsin:function(){return a},getRecommendedAsins:function(){return f},setRecommendedAsins:function(a){0<l.length&&c.isArray(a)&&(a=JSON.stringify(a),l.attr("data-recommended-asins",a),f=b.parseJSON(a))},getRecommendationsDatasetType:function(){return e},isShovelerEnabled:function(){return g},isMultipleLooksEnabled:function(){return h},getEDPDefectDisplayData:function(){return k}}}),l.when("A","jQuery","recommendations-data-cache","ready").register("softlines-recommendations-edp-helper",
function(b,c,a){function f(){var b=e.featureContext(),d={},f=b.cqAttributeType,l=b.cqFlagName,u=b.resolver,n=b.featureName,p=n+"-"+b.dataHash;l&&0<l.length&&(d.flag=l);var l=a.getRecommendedAsins(),v=a.getRecommendationsDatasetType();d.recommendedAsins=encodeURIComponent(l);d.datasetType=v;l=JSON.stringify(l)+v;l in e.cacheStorage?d=e.cacheStorage[l]:(d=h.generateTemplateViewModel(p,b.defects,e,d,f,u),e.cacheStorage[l]=d);f="#"+b.placeHolderId;b=c("#"+b.templateId).html();h.renderEDP(f,b,d,n)}var e,
h;b.on("SoftlinesEDPRecommendationsActionEventHandler",function(a){e=a;l.when("EDPUtils").execute(function(a){h=a;f()})});return{getSrecsEDPScopeHandler:function(){return e},srecsEDPActionEvent:f}}),l.when("softlines-recommendations-edp-helper","looks-data-cache","recommendations-data-cache","ready").register("srecs-edp-carousel-page-change-handler",function(b,c,a){return{refreshEDP:function(f){var e=c.getLooksAsins();--f;0<=f&&f<e.length&&(e=e[f]);e=decodeURIComponent(e);e=e.split(",");a.setRecommendedAsins(e);
b.srecsEDPActionEvent()}}}))})});
/* ******** */
(function(g){var e=window.AmazonUIPageJS||window.P,m=e._namespace||e.attributeErrors,a=m?m("SoftlinesPWAssets"):e;a.guardFatal?a.guardFatal(g)(a,window):a.execute(function(){g(a,window)})})(function(g,e,m){g.when("A","LUXController","softlines-common-utils","afterLoad","a-state").register("PWAddressValidator",function(a,f,k){var c=a.$,d,h=function(){function h(c){if(e.hasOwnProperty(c)&&e.addressId)return e.addressId;if(!c)return!1;var d=k.getCurrentAsin();a.ajax("/gp/product/ajax-handlers/pw-address-validator.html?ie\x3dUTF8\x26",
{method:"get",params:{asin:d,pwAddressIdList:c},success:b,error:function(){console.log("PWAddress validation AJAX call failed for adderss ID : "+c);return!1}})}function b(a){a=a?a.replace(/(\n+\s+)+/g,""):"";k.isStringNotEmpty(a)&&c(a).each(function(a){var b=c(this);a=b.data("addressid");b=b.data("eligibility");if(a&&b)return e[a]=b,console.log(a+" : "+b),b})}function q(){d=a.state("pwState")?a.state("pwState"):{}}function r(){d.hasOwnProperty("isTryState")&&(g.isTryState=d.isTryState);d.hasOwnProperty("isPWEnabled")&&
(g.isPWEnabled=d.isPWEnabled);var b=a.state("unifiedLocation")?a.state("unifiedLocation"):{},b=b.hasOwnProperty("urlParams")?b.urlParams:{},b=k.extendAndOverride(b,g);a.state("unifiedLocation",{urlParams:b})}var g={isTryState:!1,isPWExperienceEnabled:!0,isLocUXPageRefresh:!0,isPWEnabled:!1},l={},e={},m=f.locationChangeEventName,n=f.locationTypes;q();r();f&&d.hasOwnProperty("isPWEnabled")&&d.isPWEnabled&&(l=f.getLocationData(),l.hasOwnProperty("addressId")&&l.addressId&&(e[l.addressId]="ELIGIBLE"));
a.state.bind("pwState",function(a,b){if(b.isTryState||b.isPWEnabled)q(),r()});a.on(m,function(a){l=a;a=l.locationType;!a||a!==n.accountAddress&&a!==n.defaultAddress||h(l.addressId)});return{getLocationData:function(){return l},getAddressEligibilityMap:function(){return e},getAddressIdPWEligibility:h,locationTypes:n,eligibleValue:"ELIGIBLE",ineligibleValue:"INELIGIBLE"}};d=a.state("pwState")?a.state("pwState"):{};return d.hasOwnProperty("isPWExperienceEnabled")&&d.isPWExperienceEnabled?h():{}});"use strict";
g.when("A","pw-common-utils","a-modal","atf").execute(function(a,f,k){var c=a.$;f.registerTrySelectHandler(function(){a.state("pwState",{isTryState:!0,isPWChildState:!0});b({isTryState:!0})});f.registerBuySelectHandler(function(){f.isPwBuyBoxVisible()&&(a.state("pwState",{isTryState:!1,isPWChildState:!0}),b({isTryState:!1}))});var d=function(){c(document).undelegate("#pw-add-to-cart-button","click.pwBuyboxAtc");c(document).delegate("#pw-add-to-cart-button","click.pwBuyboxAtc",function(){var a=k.get(c("#watchWarrantyModalPwAtc"));
if(!a||a.isVisible())e.ue&&e.ue.log("LEWIS_ADD_TO_CART","PW_DUMMY_CSM_CHANNEL"),c("#pwAddToCart").submit()})},h=function(){a.on("a:pageUpdate",function(){var b=p();b&&(b.isPWChildState=f.isPwBuyBoxVisible(),a.state("pwState",b),b.isPWChildState&&d())})},p=function(){var a,b=c("#pwController_feature_div");f.isNotEmpty(b)&&(b=b.find("script"),f.isNotEmpty(b)&&(b=b.html())&&(a=c.parseJSON(b)));return a},b=function(a){var b=p();b&&(b=c.extend(b,a),(a=f.toString(b))&&c("#pwController_feature_div").find("script").html(a))};
g.when("ready","a-state").execute(function(){var b=a.state("pwState")?a.state("pwState"):{};b.hasOwnProperty("isPWExperienceEnabled")&&b.isPWExperienceEnabled&&(h(),d())})});g.declare("PWConfig",{buyBox:{auiEvents:{tryRowSelectEvent:"a:accordion:pwBuyBoxAccordion:tryAccordionRow:select",buyRowSelectEvent:"a:accordion:pwBuyBoxAccordion:buyAccordionRow:select"},tryAccordionRowID:"#tryAccordionRow"}});"use strict";g.when("A").execute(function(a){var f=a.$;a.state.bind("pwState",function(a,c){if((c.isTryState||
c.isPWEnabled)&&a.isPWChildState){var d,h;a.isTryState&&a.isPWEnabled?(d=f(".pw-try-feature"),h=f(".pw-buy-feature")):(d=f(".pw-buy-feature"),h=f(".pw-try-feature"));0<d.length&&d.removeClass("pw-hidden");0<h.length&&h.addClass("pw-hidden")}})});"use strict";g.when("A","pw-common-utils","afterLoad").execute(function(a,f){function k(a){var c=f.isPwBuyBoxVisible();a=!a.isTryState&&a.isPWEnabled&&c;!h&&a&&(a=d("#pwOnboardingHintPopoverTriggerId"))&&a.click()}function c(){return d(".pwOnboardingHintContent").parents(".a-popover-wrapper")}
var d=a.$,h=!1,e;g.when("ready","a-state").execute(function(){var b=a.state("pwState")?a.state("pwState"):{},c=a.state("pwOnboardingHintState")?a.state("pwOnboardingHintState"):{};c.hasOwnProperty("deviceType")&&b.hasOwnProperty("isTryState")&&b.hasOwnProperty("isPWEnabled")&&(e=c.deviceType,k(b))});a.state.bind("pwState",function(a){!a.isTryState&&a.isPWChildState&&k(a)});a.on("a:popover:dismiss:pwOnboardingHint",function(b){h=!0;f.isNotEmpty(e)&&a.ajax("/gp/product/ajax-handlers/pw-onboarding-hint-shown.html?ie\x3dUTF8\x26",
{method:"post",params:{deviceType:e}})});a.on("a:popover:beforeShow:pwOnboardingHint",function(a){if(a=c())a.addClass("pwOnboardingHintPopoverWrapper"),(a=a.children(".a-arrow-border"))&&a.addClass("pwOnboardingHide")});a.on("a:popover:afterShow:pwOnboardingHint",function(a){(a=c())&&(a=a.children(".a-popover-inner"))&&a.addClass("pwOnboardingHintPopoverInner")})});"use strict";g.when("A","PWConfig").register("pw-common-utils",function(a,f){var e=function(){};e.prototype.isNotEmpty=function(a){return a&&
a.length};e.prototype.isPwBuyBoxVisible=function(c){c=a.$(f.buyBox.tryAccordionRowID);return this.isNotEmpty(c)};e.prototype.registerTrySelectHandler=function(c){a.on(f.buyBox.auiEvents.tryRowSelectEvent,c)};e.prototype.registerBuySelectHandler=function(c){a.on(f.buyBox.auiEvents.buyRowSelectEvent,c)};e.prototype.toString=function(c){var d=c;if("object"===typeof c){var e="",d="";a.each(c,function(a,b){d+=e+'"'+b+'":'+a;e=","});d&&(d="{"+d+"}")}return d};return new e})});
/* ******** */
(function(b){var f=window.AmazonUIPageJS||window.P,h=f._namespace||f.attributeErrors,a=h?h("FreeSampleAssets"):f;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,f,h){b.when("A","a-popover","ready").execute(function(a,c){0===a.$("#freeSampleInlineJavascript").length&&b.register("sampling-feature",function(){function b(){var c=a.$("#csxfsSelectedBlock").height()*d.IMAGE_PADDING_FACTOR;a.$("#csxfsImageSelected").css("padding-top",c);a.$("#csxfsYourGiftText").css({left:d.MOVE_MAX_X,
opacity:0});a.$("#csxfsSampleImages").css({height:0,opacity:0});a.$(".csxfs_normal").each(function(){a.$(this).css("borderWidth",d.BORDERWIDTH_MIN)})}function f(b){b=a.$("#"+b);var d=a.$("#a-popover-csxDetailsPopOver");c.create(b,{name:"csxDetailsPopOver",width:715,position:"triggerBottom",content:d.html(),activate:a.capabilities.touch?"onmouseover":"onclick"})}function h(b,c){"1"!==a.$("#buybox_feature_div").css("opacity")?setTimeout(function(){h(b,c)},500):(a.$(".csxfs_featurecontainer").show(),
l=!1,p(),f("csxfsTitleDetailsLink"),f("csxfsSecondaryDetailsLink"),m()?(a.$("#csxfsSelectSampleButton, #csxfsImageSelected").bind("click",function(){b.animateIn(c)}),a.$(".csxfs_normal").bind("click",v).bind("click",function(){b.animateOut(c)}),a.$(".csxfs_normal").hover(A,B),a.$("#csxfsNoThanks").bind("click",x).unbind("click",v)):(a.$("#csxfsImageSelected").bind("click",z),a.$("#csxfsAcceptSampleButton").bind("click",v),a.$("#csxfsDeclineSampleButton").bind("click",x)),a.$("#csxfsImageSelected").hasClass("csxfs_faded_image")?
(u=!1,a.$("#addToCart").find("#freeSampleOfferListingID").val(""),a.$("#csxfsSelectedAsin").val("")):(a.$("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")),a.$("#csxfsSelectedAsin").val(a.$("#csxfsImg0").data("asin"))))}var d={MOVE_MAX_X:16,MOVE_MIN_X:0,BORDERWIDTH_MAX:1,BORDERWIDTH_MIN:0,DELAY:"slow",FEATURE_CONTAINER_HEIGHT:114},l=!0,k=function(){a.$("#csffsFeaturecontainer").animate({height:d.FEATURE_HEIGHT},d.DELAY,function(){a.$("#csxfsSelectedSampleText").css({left:d.MOVE_MAX_X,
opacity:0})});a.$("#csxfsSamplesBlock").removeClass("a-hidden");a.$("#csxfsSelectedBlock").addClass("a-hidden");a.$("#csxfsImageSelected").removeClass("csxfs_faded_image");a.$("#csxfsSampleImages").animate({height:d.SAMPLES_HEIGHT,opacity:1},d.DELAY);a.$(".csxfs_normal").each(function(){a.$(this).animate({borderWidth:d.BORDERWIDTH_MAX},"3000")});a.$("#csxfsYourGiftText").animate({left:d.MOVE_MIN_X,opacity:1},d.DELAY);e(!0);return!1},e=function(b){b?(a.$("#csxfsFreeSampleDeclinedTitle").hide(),a.$("#csxfsSelectedSampleText").removeClass("csxfs_nosampleselected_text"),
a.$("#csxfsSampleTitle").show(),a.$("#csxfsFreeSampleTitle").show()):(a.$("#csxfsFreeSampleDeclinedTitle").show(),a.$("#csxfsSelectedSampleText").addClass("csxfs_nosampleselected_text"),a.$("#csxfsSampleTitle").hide(),a.$("#csxfsFreeSampleTitle").hide())},n=function(){l=!1;a.$("#csxfsLnkDiffGiftSec").hide();a.$("#csxfsLnkChooseGift").show();a.$("#csxfsLnkNoGift").hide();e(!1);a.$("#csxfsImageSelected").addClass("csxfs_faded_image");a.$("#freeSampleOfferListingID").remove();a.$("#csxfsAcceptSample").show();
a.$.get(a.$(this).data("foresterurl"));return!1},m=function(){return 1<a.$("#csxfsItemsCount").val()?!0:!1},g=function(){var b=a.$(this).data("foresterurl");b&&a.$.get(b);m()?q():(p(),a.$("#addToCart").find("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")),a.$("#csxfsSampleTitle").text(a.$("#csxfsImg0").data("title")).show(),a.$("#csxfsImageSelected").removeClass("csxfs_faded_image"),a.$("#csxfsLnkNoGift").show(),e(!0),a.$("#csxfsAcceptSample").hide())},q=function(){a.$("#csxfsLnkDiffGiftSec").show();
a.$("#csxfsLnkChooseGift").hide();a.$("#csxfsLnkNoGift").show();k();return!1},p=function(){l||(a.$("#addToCart").prepend(a.$('<input type="hidden" id="freeSampleOfferListingID" name="freeSampleOfferListingID" value="">')),l=!0)},y=function(){var c=a.$(this).find("img").attr("src"),e=a.$(this).data("title");a.$("#csxfsSampleImages").animate({height:0,opacity:0},d.DELAY);a.$("#csxfsSamplesBlock").addClass("a-hidden");a.$("#csxfsImageSelected").attr("src",c);a.$("#csxfsSampleTitle").text(e);a.$("#csxfsSelectedBlock").removeClass("a-hidden");
c=a.$("#csxfsSelectedBlock").height()*d.IMAGE_PADDING_FACTOR;a.$("#csxfsImageSelected").css("padding-top",c);a.$("#csffsFeaturecontainer").animate({height:d.FEATURE_CONTAINER_HEIGHT},"3000",function(){a.$("#csxfsYourGiftText").css({left:d.MOVE_MAX_X,opacity:0})});a.$("#csxfsSelectedSampleText").animate({left:d.MOVE_MIN_X,opacity:1},d.DELAY);a.$(".csxfs_normal").each(function(){a.$(this).removeClass("csxfs_highlight")});a.$(this).addClass("csxfs_highlight");b();p();a.$("#addToCart").find("#freeSampleOfferListingID").val(a.$(this).data("offerlistingid"));
a.$.get(a.$(this).data("foresterurl"))},t,u=!0,v=function(){u=!0;a.$("#csxfsSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsNoSample").addClass("csxfs_hidden_elements");a.$("#csxfsImageSelected").removeClass("csxfs_faded_image");if(m()){var b=a.$("#csxfsSampleTitle").text().trim(),c=a.$(this).data("title"),b=b.substring(0,b.indexOf(" ")+1)+c;a.$("#csxfsSampleTitle").text(b);a.$("#csxfsSelectProductSubheadingText").text(c);t=c;c=a.$(this).find("img").attr("src");a.$("#csxfsImageSelected").attr("src",
c);a.$(".csxfs_normal").removeClass("csxfs_highlight");a.$(this).addClass("csxfs_highlight");a.$("#csxfsButtonTextChange").removeClass("csxfs_hidden_elements");a.$("#csxfsButtonTextSelect").addClass("csxfs_hidden_elements");a.$("#csxfsFreeSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsTitleDetailsLink").removeClass("csxfs_hidden_elements");a.$("#csxfsSelectSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsCountSampleChoices").addClass("csxfs_hidden_elements");a.$("#freeSampleOfferListingID").val(a.$(this).data("offerlistingid"));
a.$("#csxfsSelectedAsin").val(a.$(this).data("asin"));a.$.get(a.$(this).data("foresterurl"))}else a.$("#csxfsDeclineSampleButton").removeClass("csxfs_hidden_elements"),a.$("#csxfsAcceptSampleButton").addClass("csxfs_hidden_elements"),a.$("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")),a.$("#csxfsSelectedAsin").val(a.$("#csxfsImg0").data("asin")),a.$.get(a.$("#csxfsImg0").data("foresterurl"))},x=function(){u=!1;a.$("#csxfsSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsNoSample").removeClass("csxfs_hidden_elements");
a.$("#csxfsImageSelected").addClass("csxfs_faded_image");if(m()){a.$(".csxfs_normal").removeClass("csxfs_highlight");a.$("#csxfsNoThanks").addClass("csxfs_highlight");var b=a.$(this).data("title");a.$("#csxfsSelectProductSubheadingText").text(b);t=b;a.$("#csxfsButtonTextChange").addClass("csxfs_hidden_elements");a.$("#csxfsButtonTextSelect").removeClass("csxfs_hidden_elements");a.$("#csxfsFreeSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsTitleDetailsLink").addClass("csxfs_hidden_elements");
a.$("#csxfsSelectSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsCountSampleChoices").removeClass("csxfs_hidden_elements")}else a.$("#csxfsDeclineSampleButton").addClass("csxfs_hidden_elements"),a.$("#csxfsAcceptSampleButton").removeClass("csxfs_hidden_elements");a.$("#freeSampleOfferListingID").val("");a.$("#csxfsSelectedAsin").val("");a.$.get(a.$("#csxfsNoThanks").data("foresterurl"));return!1},z=function(){u?x():v()},A=function(){t=a.$("#csxfsSelectProductSubheadingText").text();
a.$("#csxfsSelectProductSubheadingText").text(a.$(this).data("title"))},B=function(){a.$("#csxfsSelectProductSubheadingText").text(t)};return{init:function(){a.$(".csxfs_featurecontainer").show();var c=a.$("#csffsFeaturecontainer").hasClass("a-hidden");a.$("#csffsFeaturecontainer").removeClass("a-hidden");d.FEATURE_HEIGHT=a.$("#csxfsSamplesBlock").removeClass("a-hidden").height();d.SAMPLES_HEIGHT=a.$("#csxfsSampleImages").height();a.$("#csxfsSamplesBlock").addClass("a-hidden");d.FEATURE_CONTAINER_HEIGHT=
a.$("#csffsFeaturecontainer").height();c&&a.$("#csffsFeaturecontainer").addClass("a-hidden");a.$("#csxfsImageSelected").hasClass("csxfs_faded_image")&&a.$("#addToCart").find("#freeSampleOfferListingID").val("");b();a.$("#csxfsLnkDiffGift").bind("click",k);a.$("#csxfsLnkNoGift").bind("click",n);a.$(".csxfs_normal").bind("click",y);a.$("#csxfsImageSelected").bind("click",g);a.$("#csxfsLnkChooseGift").bind("click",q);a.$("#csxfsAcceptSample").bind("click",g)},initV2:h}})})});
/* ******** */
(function(h){var m=window.AmazonUIPageJS||window.P,q=m._namespace||m.attributeErrors,a=q?q("HSXDetailPageFeaturesAssets"):m;a.guardFatal?a.guardFatal(h)(a,window):a.execute(function(){h(a,window)})})(function(h,m,q){h.when("jQuery","A").execute(function(a,g){g.on("a:popover:ajaxContentLoaded:g2s2SizeChartView",function(b){function c(b){return k+a.param({asin:p,sizeChartDept:b,deviceType:n})}function f(){var b=a("#sizechart_department_dropdown_native_select").children(":selected").attr("data-deptName"),
b=c(b);g(b)}function g(b){a.ajax({url:b,cache:!0,beforeSend:function(){if(d.data(b)!==q){var a=d.data(b);d.html(a);return!1}d.addClass(m);return!0},complete:function(){d.removeClass(m)},success:function(a){d.data(b,a);d.html(a)}})}function h(a){g(a.data.rwAjaxSizeChartUrl)}b=a("#spinnerContainer");var e=a("#sizeChartSpinnerUrl").attr("data-sizechart-spinner-url");b.css("background-image","url("+e+")");b=b.attr("data-showTab");e=a("#sizeChartHeight").attr("data-height");a(".heightG2S2SizeChartPC").css("height",
e+"px");if("true"===b){var d=a("#tabContent"),k="/gp/product/ajax-handlers/apparel-sizing-chart.html/ref=dp_sizechart?ie=UTF8&isUDP=1&",m="loadingSpinnerSizeChart",p=d.attr("data-asin"),n=d.attr("data-deviceType");b=a("#dataForJs").attr("data-numberOfDepts");if("false"===a("#dataForJs").attr("data-show-department-dropdown"))for(e=0;e<b;e++){var l=a("#dept"+e).attr("data-deptName"),x=a("#dept"+e).attr("data-isActive"),l=c(l);"true"===x&&d.data(l,d.html());a("#dept"+e).click({rwAjaxSizeChartUrl:l},
h)}else a("#sizechart_department_dropdown_native_select").change(f),l=a("#sizechart_department_dropdown_native_select").children(":selected").attr("data-deptName"),l=c(l),d.data(l,d.html())}})});h.when("jQuery","A","cf").execute(function(a,g){function b(){var a=g.viewport().height,b=a-e.heightBuffer;m&&(a/=2,b=a-a*e.popupHeightBufferPercent/100);return Math.min(Math.max(b,e.minHeight),e.maxHeight)}function c(){var c=f.attr("data-header"),q="data-"+h,p=f.attr("href"),n=b(),p={name:"g2s2SizeChartView",
url:p+"&height="+n};m?(c=g.viewport().width*e.widthPercent/100,c=Math.min(Math.max(c,e.minWidth),e.maxWidth),a.extend(p,{width:c.toString(),position:"triggerBottom"})):a.extend(p,{width:"800",header:c});c=JSON.stringify(p);d.attr(q,c)}var f=a("#size-chart-url"),h=f.attr("data-sizeChartActionType"),m="a-popover"===h,e={widthPercent:70,minWidth:300,maxWidth:800,minHeight:300,maxHeight:700,popupHeightBufferPercent:5,heightBuffer:300},d=a("#size-chart-popover");g.on("resize",function(){var c=a("#fit-guide"),
e=b();if(0===c.length){if(0<d.length){var c=d.data(h),f="",n=c.url.split("?"),l=n[0],n=n[1],m="";if(n)for(var n=n.split("&"),q=n.length,t=0;t<q;t++)"height"!==n[t].split("=")[0]&&(f+=m+n[t],m="&");c.url=l+"?"+f+(m+"height="+e);d.data(h,c)}}else g.capabilities.ios||c.height(e)});0<d.length&&c()})});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("DetailPageOffersMulticlickAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){b.when("A","preventMulticlick:forceFormSubmit","ready").execute(function(a,b){var c=!1,d=function(d){var k=a.$(document);k&&k.delegate(d,"click",function(){var e=a.$(d);if(!e||"submit"!==e.prop("type"))return!0;if(c)return e.attr("disabled",!0),!1;b(e);c=!0;setTimeout(function(){c=
!1;e.attr("disabled",!1)},3E4);return!0})};a.on("mash:willReappear",function(){c=!1});d("#one-click-button");d("#oneClickBuyButton");d("#prime-toggle-main")});b.when("A","ready").register("preventMulticlick:forceFormSubmit",function(a){return function(a){}})});
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("DetailPageDesktopOffersAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){b.when("jQuery","a-popover","A","a-dropdown","ready").register("moq",function(a,b,c,d){function h(){c.on("a:popover:beforeShow:moqAtcPopover",function(b){var c=a("#quantity");p(c);setTimeout(function(){c.addClass("highlightQuantityDropdownBorder")},20)});c.on("a:popover:afterHide:moqAtcPopover",
function(b){b=a("#quantity");b.removeClass("highlightQuantityDropdownBorder");q(b)});c.on("a:popover:beforeShow:MOQPreLoadPopOver",function(b){b=a("#quantity");p(b)});c.on("a:popover:afterHide:MOQPreLoadPopOver",function(b){b=a("#quantity");q(b)});c.on("a:dropdown:quantity:select",function(b){b=d.getSelect("quantity");var c=b.getOption(0),g=a("#quantity");c.info()[0].selected?c.update({text:c.info()[0].value}):c.update({text:g.children("option[data-displayText]").attr("data-displayText")});0===b.val().length?
e(g):r()})}function g(a){var b=a.parent().parent("div").innerWidth()-a.prev("label").outerWidth()-1;100<b&&a.width(b)}function e(){m("#add-to-cart-button");m("#buy-now-button");m("#one-click-button");m("#oneClickBuyButton")}function r(){n("#add-to-cart-button");n("#buy-now-button");n("#one-click-button");n("#oneClickBuyButton")}function m(f){f=a(f);if(0!==f.length&&null===b.get(f)){f.prop("type","button");var d=c.state("moq-atc-popover"),d=d?d.popoverContent:a("script#moqPopoverContent").html();0!==
d.length&&(f.addClass("cursorDisabled"),b.create(f,{name:"moqAtcPopover",position:"triggerLeft",closeButton:"false",inlineContent:d}))}}function n(f){f=a(f);0!==f.length&&null!==b.get(f)&&(f.prop("type","submit"),f.removeClass("cursorDisabled"),b.remove(f))}function p(a){l++;1===l&&0===d.getSelect("quantity").val().length&&(a.prop("disabled",!0),a.addClass("quantityBarGrayOut"))}function q(a){l--;0===l&&setTimeout(function(){0===l&&(a.prop("disabled",!1),a.removeClass("quantityBarGrayOut"))},370)}
function u(){var b=a("#quantity"),c=d.getSelect("quantity");b.hasClass("aok-hidden")||(c.setValue(""),g(b),c=a("#oneTimeBuyBox"),0!==c.length&&c.click(function(){setTimeout(function(){g(b)},20)}),0<l&&(b.prop("disabled",!0),b.addClass("quantityBarGrayOut")),0===d.getSelect(b).val().length&&e(b),t||(h(),t=!0))}var l=0,t=!1;return{initializeQuantitySelect:function(){u()},disableFormForMoq:function(){e()},reenableFormForMoq:function(){r()}}})});
/* ******** */
(function(b){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,c=d?d("ActionPanelAssets"):a;c.guardFatal?c.guardFatal(b)(c,window):c.execute(function(){b(c,window)})})(function(b,a,d){b.when("A","jQuery","action-panel").register("usedBuyBoxDPv2",function(c,e,a){var d=function(){e("#one-click-button-ubb, #toggleBuyBox #used #add-to-cart-button-ubb").click(function(){e("#addToCart").attr("action",function(c,b){return b.replace("ref=dp_start-bbf_1_glance","ref=dp_start-ubbf_1_glance")});
return!0});b.when("a-popover").execute(function(b){var a=function(a){a.preventDefault();a=e("#usedItemConditionInfoLink");b.create(a,{width:250,position:"triggerBottom",activate:c.capabilities.touch?"onmousemove":"onclick",closeButton:!1,popoverLabel:"Used condition details",name:"usedItemConditionDetailsPopover",dataStrategy:"preload"}).show()};e(document).undelegate("#usedItemConditionInfoLink","click",a);e(document).delegate("#usedItemConditionInfoLink","click",a)})};return{init:function(){d()}}})});
/* ******** */
(function(p){var n=window.AmazonUIPageJS||window.P,q=n._namespace||n.attributeErrors,h=q?q("BuyBackAssets"):n;h.guardFatal?h.guardFatal(p)(h,window):h.execute(function(){p(h,window)})})(function(p,n,q){p.when("A","a-button","buyback-util","bbMetric","BBPageState","DiagnosticsState","Logger","ready").register("DiagnosticsUtils",function(h,m,g,b,a,c,e){e.log("DiagnosticsUtils file");var d=h.$;return{buyBackState:a.get(),setupNonAutoDetectAccordionRowCallback:null,startDiagnosticsFlow:function(){e.log("startDiagnosticsFlow");
"function"!==typeof submitDiagnosticsForm&&(document.getElementById("backUrl").value=n.location.href,document.getElementById("diagnosticsForm").submit())},getAndroidVersion:function(){e.log("getAndroidVersion");var a=navigator.userAgent.match(/Android[\/]*[\d\.]+/),b="0.0";null!==a&&null!==a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));return parseFloat(b,10)},getAmazonAppVersion:function(){e.log("getAmazonAppVersion");var a=navigator.userAgent.match(/Amazon.com[\/]*[\d\.]+/),b="0.0";null!==a&&null!==
a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));return parseFloat(b.split(".")[0]+"."+b.split(".")[1],10)},checkPhoneRootedAPI:function(){e.log("checkPhoneRootedAPI");n.cordova.require("cordova/exec")(this.phoneRootedCallbackSuccess.bind(this),this.phoneRootedCallbackError.bind(this),"MShopMobileAutoDiagnostic","isPhoneRooted",{})},runAutoDetectionAPI:function(){e.log("runAutoDetectionAPI");n.cordova.require("cordova/exec")(this.autoDetectCallback.bind(this),this.autoDetectCallback.bind(this),"MShopMobileAutoDiagnostic",
"getAutoDetectPhoneInfo",{})},triggerAutoClick:function(){e.log("triggerAutoClick");var a=document.getElementById("buyBackAccordionRow");null!==a&&a!==q&&a.classList.contains("a-accordion-active")&&!1===c._clickedAlready&&(c._clickedAlready=!0,this.primaryAccordionClick())},triggerAutoClickAfterDiagnostics:function(){e.log("triggerAutoClickAfterDiagnostics");if("BB"===this.buyBackState.programName){b.increment("BuyBack:mobile:autoDiagnosticRunSuccess:count");var a=d("#buyBackAccordionRow a.a-accordion-row");
null!==a&&0<a.length&&d(a)[0].click()}},primaryAccordionClick:function(){e.log("primaryAccordionClick");g.hide("autoDetectionAccordion");g.hide("withAutoDetection-accordion","withoutAutoDetection-accordion");m("#buyBackBuyNowButton").disable();if("BB"===this.buyBackState.programName){d("#autoDetectionAccordion").show();this.setHiddenRowInElement(d("#withoutAutoDetection-accordion .a-accordion-inner"));var a=d("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");
null!==a&&0<a.length&&d(a)[0].click();d("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion")}else this.runAutoDetection()},runAutoDetection:function(){e.log("runAutoDetection");c._androidVersion=this.getAndroidVersion();c._amazonAppVersion=this.getAmazonAppVersion();5>c._androidVersion?b.increment("BuyBack:mobile:autoDetectionFailedOldAppAndroid:count"):12.7>c._amazonAppVersion?b.increment("BuyBack:mobile:autoDetectionFailedOldAppAmazon:count"):(d("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),
this.checkPhoneRootedAPI(),this.runAutoDetectionAPI())},addAutoDetectDataToState:function(){e.log("addAutoDetectDataToState");this.buyBackState.imeiNumber=c.imeiNumber;this.buyBackState.deviceBrandName=c._deviceBrandName;this.buyBackState.deviceModelName=c._deviceModelName;this.buyBackState.deviceModelId=c._deviceModelId},showAutoDetectionResult:function(){e.log("showAutoDetectionResult");if(!1===c._ranPhoneRooted||!1===c._ranAutoDetection)return!1;d("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion");
if(!1===c._isAutoDetectSuccessfull||!0===c._isPhoneRooted)d("#buybackAccordion").remove(),this.setHiddenRowInElement(d("#hidden-accordion-content")),d("#hidden-accordion-content").removeClass("aok-hidden");else{b.increment("BuyBack:mobile:autoDetectionShown:count");this.setHiddenRowInElement(d("#withoutAutoDetection-accordion .a-accordion-inner"));var a=d("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");this.addAutoDetectDataToState();
null!==a&&0<a.length&&d(a)[0].click()}},setHiddenRowInElement:function(a){e.log("setHiddenRowInElement");if(null!==c._lastHiddenElem&&0===d("#hidden-accordion-content").html().length)return!1;e.log("setHiddenRowInElement:"+a.selector);d("#hidden-accordion-content").html("");c._lastHiddenElem=a;a.html(c._hiddenRowHTML);this.setupNonAutoDetectAccordionRowCallback()},autoDetectCallback:function(a){e.log("autoDetectCallback");var d=!1;if(null===a.model||a.model===q)b.increment("BuyBack:mobile:autoDetectionFailedAPI:count"),
e.log("BuyBack:mobile:autoDetectionFailedAPI:count"),d=!0;if(!d){var h=g.getModelNameFromModelId(a.model,a.brand).MobileModelName;null===h||h===q||""===h?(b.increment("BuyBack:mobile:autoDetectionFailedModel:count"),e.log("BuyBack:mobile:autoDetectionFailedModel:count"),d=!0):null===a.imeiNumber||a.imeiNumber===q||""===a.imeiNumber?(b.increment("BuyBack:mobile:autoDetectionFailedIMEI:count"),e.log("BuyBack:mobile:autoDetectionFailedIMEI:count"),d=!0):(c._imeiNumber=a.imeiNumber,c._deviceBrandName=
a.brand,c._deviceModelName=h,c._deviceModelId=a.model)}d||(a=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),null!==a&&a!==q&&0!==a.discount)||(b.increment("BuyBack:mobile:autoDetectionFailedDiscount:count"),e.log("BuyBack:mobile:autoDetectionFailedDiscount:count"),d=!0);c._ranAutoDetection=!0;c._isAutoDetectSuccessfull=!d;this.showAutoDetectionResult()},phoneRootedCallbackSuccess:function(a){e.log("phoneRootedCallbackSuccess");"true"===a.rootedStatus?(b.increment("BuyBack:mobile:autoDetectionFailedRooted:count"),
c._isPhoneRooted=!0):c._isPhoneRooted=!1;c._ranPhoneRooted=!0;this.showAutoDetectionResult()},phoneRootedCallbackError:function(a){e.log("phoneRootedCallbackError");c._isPhoneRooted=!1;c._ranPhoneRooted=!0;b.increment("BuyBack:mobile:phoneRootedAPIFailed:count");this.showAutoDetectionResult()},bindDiagnosticsFunctionality:function(b){e.log("bindDiagnosticsFunctionality");this.buyBackState=a.get();this.setupNonAutoDetectAccordionRowCallback=b;var y=this;c._hiddenRowHTML=d("#hidden-accordion-content").html();
d("#hidden-accordion-content").html("");e.log("Cleared hidden html");h.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",function(a){d("#diagnosticsSpinnerDiv").show();g.hide("autoDetectionAccordion");c._clickedAlready=!0;y.primaryAccordionClick()});d("#autoDiagnosticsIngress").click(function(){y.startDiagnosticsFlow()});h.on("a:accordion:buybackAccordion:withAutoDetection-accordion:select",function(a){m("#buyBackBuyNowButton").disable();y.accordionClick()});this.triggerAutoClick();this.triggerAutoClickAfterDiagnostics()},
setAutoDetectDiscount:function(a,b){e.log("setAutoDetectDiscount");var d={discount:0,offerId:""};if(null!==this.buyBackState.buyBackExchangeItems&&this.buyBackState.buyBackExchangeItems!==q){for(var g=0;g<this.buyBackState.buyBackExchangeItems.length;g++){var h=this.buyBackState.buyBackExchangeItems[g];if(a.toUpperCase()===h.header.toUpperCase()){c._deviceBrandName=h.header;for(var h=h.containedBuyBackProductNodes,m=0;m<h.length;m++)if(b.toUpperCase()===h[m].header.toUpperCase())return d.discount=
h[m].buyBackProductDetails.buyBackOfferDetailsList[0].discountPrice,d.offerId=h[m].buyBackProductDetails.buyBackOfferDetailsList[0].offerId,d}}return d}},accordionClick:function(){e.log("accordionClick");"BB"!==this.buyBackState.programName?this.showADRowBeforeDiagnostics():this.showADRowAfterDiagnostics()},showADRowBeforeDiagnostics:function(){e.log("showADRowBeforeDiagnostics");g.hide("autoDiagnosticsIngress");d("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");d("#deviceBrand").val(c._deviceBrandName);
d("#model").text(c._deviceModelName).removeClass("hide").addClass("show");d("#deviceModel").val(c._deviceModelName);d("#imei").val(c._imeiNumber);var a=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),b=g.getSponsoredDiscount(this.buyBackState,a.offerId,a.discount,c._imeiNumber);d("#deviceBuyBackDiscount").val(parseFloat(a.discount));d("#deviceSponsorDiscount").val(parseFloat(b));var h=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber),p=0,n=0;0===h||1>parseFloat(h.MaximumDiagnosticDiscount)?
(p=parseFloat(a.discount)+parseFloat(b),n=parseFloat(this.buyBackState.productPrice)-(parseFloat(a.discount)+parseFloat(b))):null!==h.DisplayableDiagnosticDiscount&&0!==parseFloat(h.DisplayableDiagnosticDiscount,10)?(p=parseFloat(a.discount)+parseFloat(b)+parseFloat(h.DisplayableDiagnosticDiscount),n=parseFloat(this.buyBackState.productPrice)-(parseFloat(a.discount)+parseFloat(b)+parseFloat(h.DisplayableDiagnosticDiscount)),d("#diagnosticsDiscountsReceivedValue").text(h.DisplayableDiagnosticDiscount),
g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue"),d("#maxDisplayedDiscountValue").val(h.MaximumDiagnosticDiscount),g.hide("autoDiagnosticsIngressRunDiagnosticText"),g.show("autoDiagnosticsIngressRunAgainText")):(p=parseFloat(a.discount)+parseFloat(b),n=parseFloat(this.buyBackState.productPrice)-(parseFloat(a.discount)+parseFloat(b)),g.showInline("getAdditionalDiagnosticsDiscountText","getAdditionalDiscountvalue"),d("#getAdditionalDiscountvalue").text(h.MaximumDiagnosticDiscount),
d("#maxDisplayedDiscountValue").val(h.MaximumDiagnosticDiscount));0!==parseFloat(b)&&(d("#mdSponsoredDiscountValue").text(parseFloat(b)),g.showInline("mdSponsoredDiscountValue"),g.show("mdSponsoredDiscountText"));g.show("autoDiagnosticsIngress");d("#mdTotalDiscountValue").text(p);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");d("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(n));g.hide("maxBuyBackDiscountSection");g.show("priceAfterBuyBackDiscountSection");m("#buyBackBuyNowButton").enable()},
showADRowAfterDiagnostics:function(){e.log("showADRowAfterDiagnostics");d("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");d("#deviceBrand").val(c._deviceBrandName);d("#model").text(c._deviceModelName).removeClass("hide").addClass("show");d("#deviceModel").val(c._deviceModelName);if(isNaN(this.buyBackState.deviceSponsoredDiscount)||null===this.buyBackState.deviceSponsoredDiscount||""===this.buyBackState.deviceSponsoredDiscount)this.buyBackState.deviceSponsoredDiscount="0.0";
var a=parseFloat(this.buyBackState.deviceBuyBackDiscount,10)+parseFloat(this.buyBackState.deviceSponsoredDiscount,10)+parseFloat(this.buyBackState.deviceDiagnosticsDiscount,10);d("#mdTotalDiscountValue").text(a);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");d("#diagnosticsDiscountsReceivedValue").text(this.buyBackState.deviceDiagnosticsDiscount);g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue");d("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(parseFloat(this.buyBackState.devicePriceAfterDiagnostics,
10)));g.hide("maxBuyBackDiscountSection");g.show("priceAfterBuyBackDiscountSection");a=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber);d("#maxDisplayedDiscountValue").val(a.MaximumDiagnosticDiscount);g.hide("autoDiagnosticsIngressRunDiagnosticText");g.show("autoDiagnosticsIngressRunAgainText");m("#buyBackBuyNowButton").enable()}}});p.when("A","ready").register("BBPageState",function(h){return{_buyBackState:null,init:function(){this._buyBackState=h.state("buyBackPageState")},
get:function(){null===this._buyBackState&&this.init();return this._buyBackState}}});p.when("A","ready").register("DiagnosticsState",function(h){return{_isPhoneRooted:null,_isAutoDetectSuccessfull:null,_clickedAlready:!1,_ranAutoDetection:!1,_ranPhoneRooted:!1,_imeiNumber:"",_deviceBrandName:"",_deviceModelName:"",_deviceModelId:"",_amazonAppVersion:"",_androidVersion:"",_hiddenRowHTML:"",_lastHiddenElem:null}});p.when("A").register("Logger",function(h){return{_enable:!1,
log:function(h){this._enable&&console.log(h)}}})});
/* ******** */
(function(H){var t=window.AmazonUIPageJS||window.P,q=t._namespace||t.attributeErrors,I=q?q("SDCXDetailPageAssets"):t;I.guardFatal?I.guardFatal(H)(I,window):I.execute(function(){H(I,window)})})(function(H,t,q){H.when("A","jQuery").execute(function(I,y){function L(){L.prototype.popoverRangeDisplay=function(a,c){[a.getUTCDate(),"-",a.getUTCMonth()+1,"-",a.getUTCFullYear()].join("");[c.getUTCDate(),"-",c.getUTCMonth()+1,"-",c.getUTCFullYear()].join("")};L.prototype.timeRangeDisplay=function(a,c){return a+
" - <br/>"+c}}function z(a,c){a="__"+a;c=c&&u.isDebugEnabled();return function(d){function b(a,b,d,g){a[b]&&g||(a[b]=d,c&&u.debug("     key "+b+" = "+d))}this[a]||(this[a]={});if(d.data)for(var g in d.data)d.data.hasOwnProperty(g)&&b(this[a],g,d.data[g],d.optional);else if(d.key)if(d.value!==q)b(this[a],d.key,d.value,d.optional);else return this[a][d.key]}}function J(a,c,d,b){b='<option value="';a&&(b+=a);b+='"';d&&(b+='selected="selected" ');b+='><span class="sd-timeslot-rowindex-date">';c&&(b+=
c);b+="</span>";return b+="</option>"}function M(a){var c=["__",a,"Fn"].join("");return function(a){var b;a.register&&a.fn&&(this[c]||(this[c]=[]),this[c][a.register]=a.fn);if(a.nil&&this[c])for(b in this[c])if(this[c].hasOwnProperty(b))this[c][b]();if(a.arg&&this[c])for(b in this[c])if(this[c].hasOwnProperty(b))this[c][b](a.arg)}}function E(a,c){var d="__dom"+c+"_"+a,b="__dom_cached"+c+"_"+a;return function(){if(this[b]){if(this[d])return this[d]}else{this[b]=!0;var g=this.config({key:a});g||t.console&&
t.console.firebug&&console.warn(["no",c,a,"configured"].join(" "));if(g=SDFramework.jq("#"+g))return this[d]=g;t.console&&t.console.firebug&&console.warn(["no",c,"DOM element found"].join(" "))}}}function R(a){var c={};c.config=z("region_config");a&&c.config(a);c.add=function(a){a&&(this.__regions=a)};c.load=function(a){this.__loadedRegions||(this.__loadedRegions=!0,this.__regions?this._insert(a)(this.__regions):this._ajaxLoad(a))};c.pick=function(a){return function(){var b=SDFramework.jq(["#",this.id,
" option:selected"].join("")).val();a.config({key:"region",value:b});a.selectCalendar()}};c._insert=function(a){var b=this;return function(c,h){b.__regions=c;var f="";b.config({key:"str_selectRegion"})&&(f=J("",b.config({key:"str_selectRegion"}),!0));var m=!1,n;for(n in c)c[n].oK&&c[n].oV&&(m=!0,f+=J(c[n].oK,c[n].oV,!1));b._loading(!1);if(n=(n=b.config({key:"dom_regionList"}))?SDFramework.jq("#"+n):0)m?(n.html(f).attr("disabled",!1),n.change(b.pick(a)),n.focus(b.pick(a))):(n.attr("disabled",!0),(f=
b.config({key:"str_noRegions"}))&&n.html(J("",f,!0)))}};c._ajaxLoad=function(a){var b=this._insert(a);a={merchant:a.config({key:"id_merchant"}),marketplace:a.config({key:"id_marketplace"}),ASIN:a.config({key:"id_asin"}),SKU:a.config({key:"id_sku"}),FMID:a.config({key:"id_fmid"}),regionRequest:1};if(this.config({key:"load_url"})){this._loading(!0);var c=SDFramework.jq.getJSON(this.config({key:"load_url"}),a,b);SDFramework.jq().ajaxError(function(){return function(a,d,m){d===c&&b()}}())}else b()};c._loading=
function(a){var b=this.config({key:"dom_regionLoading"});(b=b?SDFramework.jq("#"+b):0)&&b.css("display",a?"inline":"none");this.config({key:"dom_regionList"})&&SDFramework.jq("#"+this.config({key:"dom_regionList"})).css("display",a?"none":"inline")};return c}function S(a,c,d){var b={pickenabled:0,clickenabled:0};b.config=z("zipcode");a&&b.config(a);b._zi=E("dom_zipInput","zipcode");b.enable=function(a){this._zi()&&!this.pickenabled&&(this._zi().unbind("keyup"),this._zi().bind("keyup",this.pick(a)),
this._zi().bind("keypress",function(a){if(13==a.keyCode)return a.preventDefault(),a.stopPropagation(),!1}),this.pickenabled=1,this._zi().unbind("focus"),this._zi().bind("focus",this.focus(a)),this._zi().unbind("blur"),this._zi().bind("blur",this.blur(a)));var b=this.config({key:"dom_zipGo"});b&&(b=SDFramework.jq("#"+b))&&!this.clickenabled&&(b.bind("click",this.click(a)),this.clickenabled=1)};b.click=function(a){var b=this,c=this._zi();return function(){b.select(c.val(),a,!0,b.config({key:"postal_code_length"}));
return!1}};b.focus=function(a){var b=this;this._zi();return function(a){a=b.config({key:"dom_zipDefaultClass"});var c="#"+b.config({key:"dom_zipInput"}),d="#"+b.config({key:"dom_zipValue"}),e="#"+b.config({key:"dom_zipLabel"});y(c+"."+a).size();d=y(d).html();y(c).val(d);y(c).removeClass(a);y(e).hide()}};b.blur=function(a){var b=this;this._zi();return function(a){a="#"+b.config({key:"dom_zipInput"});var c="#"+b.config({key:"dom_zipEmpty"}),d=b.config({key:"dom_zipDefaultClass"}),e="#"+b.config({key:"dom_zipLabel"});
""===y(a).val()&&(c=y(c).html(),y(a).addClass(d),y(a).val(c),y(e).html(c),y(e).show())}};b.selectCallback=function(a,b){this.selectTimer=q;a.config({key:"zipcode",value:b});a.selectCalendar()};b.invalidate=function(a,b){var c=this;this.selectTimer&&clearTimeout(this.selectTimer);this.selectTimer=setTimeout(function(){c.selectCallback(a,b)},500)};b.select=function(a,b,c){this&&(this._enter_err&&this._enter_err().css("display","none"),this._valid_err&&this._valid_err().css("display","none"));var d=
"#"+this.config({key:"dom_zipValue"});y(d).html(a);(d=this.is_valid_zip_code(a,this.config({key:"postal_code_length"})))?c&&(this[d]().css("display","block"),b.config({key:"zipcode",value:q}),b.unselectCalendar()):this.invalidate(b,a)};b.pick=function(a){var b=this;return function(c){if(this){var m=SDFramework.jq(this).val(),n="#"+b.config({key:"dom_zipPrefix"}),e="#"+b.config({key:"dom_zipEmpty"}),r="#"+b.config({key:"dom_zipValue"}),n=SDFramework.jq(n).html(),e=SDFramework.jq(e).html();c=y(r).html()!=
m||13==c.keyCode;m&&(m=SDFramework.jq.trim(m.replace(n,"")),m=SDFramework.jq.trim(m.replace(e,"")));d&&c&&b.select(m,a,!0,6)}}};b.validate_zipcode=function(a,b,c){function d(a,b){a||(a="");if(!e.config({key:"postal_format"}).test(a))return"_valid_err"}function n(a){if(!a)return"_enter_err"}var e=this;return 1<a?d:n};b._enter_err=E("dom_zipEntError","entererror");b._valid_err=E("dom_zipValError","validerror");b.is_valid_zip_code=b.validate_zipcode(c,b._enter_err,b._valid_err);return b}function T(a){function c(a,
c,d){function f(a){var b=a.inputs;b&&b.clearSlotFields();if(b=a.message)b.clear(),b.parent&&b.parent()&&b.parent().hide();a.shoppingCart&&a.__setCanPlaceSdOrder(!1);(a=a.cutoff)&&a.enable(!1)}function m(a){var b={};a!==q&&a.today!==q&&a.c_m_id!==q&&a.tmr_m!==q&&a.tmr_d!==q?(b.today_m=a.c_m_id,b.today_d=a.today,b.tmr_m=a.tmr_m,b.tmr_d=a.tmr_d):(a=new Date,b.today_m=a.getMonth(),b.today_d=a.getDate(),a=new Date(a.getTime()+864E5),b.tmr_m=a.getMonth(),b.tmr_d=a.getDate());return b}return function(n){if(n)if(c.hasRes(n,
d)){var e=c.getRes(n,d);if(e)if(SDUtils.isEmptyObject(e))f(a);else{var r=a.inputs;r&&r.updateSlotFields(e);if(r=a.message){var k=0,p=a.config({key:"sd_calendar"}),w=a.config({key:"id_offerlist_id"});calID=a.zipcode?"Z:"+a.config({key:"zipcode"})+"\nO:"+w:"R:1\nO:"+w;var w=p.calData.getCal(calID),G,C;for(C in w.days)if(w.days.hasOwnProperty(C)){var v=w.days[C];v[0]===n&&(G=v[1])}(n=a.message.config({key:"timeslotDeterminationFn"}))&&n(w)&&(k=1,r.serviceCharges=w.serviceCharges);n=p.config({key:"dateDisplay"});
r.serviceDisplay=w.serviceDisplay;r.update(e.ultStart,e.ultEnd,k,e,G,n,m(w))}G=a.cutoff;e=e.ultCutoff;G&&e?G.hasTimeLeft(e)?(G.update(e),a.__setCanPlaceSdOrder(!0)):(G.enable(!0,!0),a.__setCanPlaceSdOrder(!1)):a.__setCanPlaceSdOrder(!0)}else f(a)}else f(a);else f(a)}}var d={};d.config=z("config");d.shoppingCart=new N.AddToCartWrapper;d.oneClick=new N.OneClickWrapper;d.cutoff=null;d.inputs=new ScheduledDelivery.Data.FormPersistence;d.checkbox=new ScheduledDelivery.BuyBox.SDIntentCheckbox;d.slotInput=
new ScheduledDelivery.BuyBox.SlotStorage(a?a.slotInputClass:"sd_slot_input",a?a.widgetRoot:"sd_div");d.initMessage=function(){this.message=P();this.message.showDropdown=0;this.message.showServices=1};d.noSlotNotSureMessagePresent=!1;d.noSlotUnknownMessagePresent=!1;d.unselectCalendar=function(){var a=this.config({key:"sd_calendar"});a&&(a.deactivateCalendar(),this.onCalendarUnselected())};d.onCalendarUnselected=function(){this.message&&this.message.clear();this.cutoff&&this.cutoff.hasOwnProperty("enable")&&
this.cutoff.enable(!1);var a=this.config({key:"sd_calendar"});a&&(a=a.active,this.slotInput.storeSlotInput(a),this.slotInput.clearSlotInput(a));this.shoppingCart&&this.shoppingCart.hasOwnProperty("enable")&&this.checkbox.isChecked()&&this.__setCanPlaceSdOrder(!1)};d.__setCanPlaceSdOrder=function(a){this.checkbox&&this.checkbox.exists()&&this.checkbox.isChecked()&&this.shoppingCart&&this.shoppingCart.enable(a)};d.selectCalendar=function(){var a=this.config({key:"sd_calendar"});if(a)if(this.config({key:"id_offerlist_id"})===
q||this.zipcode&&this.config({key:"zipcode"})===q)a.calendar();else if(this.config({key:"id_address"})!==q||"A1PA6795UKMFR9"!==this.config({key:"id_marketplace"})&&this.config({key:"zipcode"})!==q){var d=this.config({key:"shipoption"})||0,h=this.config({key:"id_offerlist_id"}),d={merchant:this.config({key:"id_merchant"}),marketplace:this.config({key:"id_marketplace"}),asin:this.config({key:"id_asin"}),quantity:this.config({key:"id_quantity"})?this.config({key:"id_quantity"}):1,SKU:this.config({key:"id_sku"}),
FMID:this.config({key:"id_fmid"}),offerListingID:h,shipoption:d};if(this.zipcode){var f=this.config({key:"zipcode"});d.id="Z:"+f+"\nO:"+h;1===this.config({key:"isAFN"})&&this.config({key:"id_address"})?d.address=this.config({key:"id_address"}):(d.zipcode=f,d.address=f)}else d.id="R:1\nO:"+h,d.region=1;(h=a.config({key:"load_url"}))||(h="/gp/product/features/scheduled-delivery/get-slots-json.html?powerbar=0");a.config({key:"load_url",value:h});a.config({key:"load_payload",value:d});a.selectCalled({register:"buyboxUI",
fn:c(this,a,d.id)});a.calendar(d.id)}else a.buyboxNoAddrMessage(),a.calendar()};d.initializeDOM=function(a){function c(a){var b=a.config({key:"sd_calendar"}),d=a.slotInput.repopulateSlotInput(b.active),e=a.config({key:"dom_mainElement"}),h=a.config({key:"dom_notSureError"}),k=a.config({key:"dom_unknownError"}),p=a.config({key:"isAFN"});e&&(SDFramework.jq("#"+e).show(),(e=a.shoppingCart)&&a.checkbox&&a.checkbox.exists()&&a.checkbox.isChecked()&&e.enable(d),(d=a.cutoff)&&d.enable(!1),(d=a.oneClick)&&
d.enable(!1),a.regions&&(a.regions.config({key:"load_url",value:"jurisdictions.json"}),a.regions.load(a),a.regions.pick(a)),a.zipcode&&(a.zipcode.enable(a),SDFramework.jq("#sd_zipcode_go").click(),(d=a.config({key:"dom_zipInput"}))&&SDFramework.jq("#"+d).keyup()),b.popup&&b.popup.logClientSideMetrics&&b.popup.logClientSideMetrics(b.popup.clientSideMetrics.selectSD));1===p&&a.noSlotNotSureMessagePresent&&h&&SDFramework.jq("#"+h).show();1===p&&a.noSlotUnknownMessagePresent&&k&&SDFramework.jq("#"+k).show()}
function d(a){var b=a.config({key:"dom_mainElement"}),c=a.config({key:"dom_notSureError"}),e=a.config({key:"dom_unknownError"});b&&(SDFramework.jq("#"+b).hide(),a.shoppingCart&&a.shoppingCart.enable(!0),a.oneClick&&a.oneClick.enable(!0));c&&(a.noSlotNotSureMessagePresent=SDFramework.jq("#"+c).is(":visible"),SDFramework.jq("#"+c).hide());e&&(a.noSlotUnknownMessagePresent=SDFramework.jq("#"+e).is(":visible"),SDFramework.jq("#"+e).hide());b=a.config({key:"sd_calendar"});c=b.active;b.popup&&b.popup.logClientSideMetrics&&
b.popup.logClientSideMetrics(b.popup.clientSideMetrics.unselectSD);a.slotInput.storeSlotInput(c);a.slotInput.clearSlotInput(c)}return function(){var f=a.checkbox;f&&(f.exists()&&!f.isChecked()||c(a),f.bindDOM(),f.onCheck.handlers.add(function(){c(a)}),f.onClear.handlers.add(function(){d(a)}),f.setChecked(!1),f.exists()&&d(a))}}(d);return d}function U(){function a(a,b){if(!a||0===a.length)return 0;a=a.get(0);var c=SDFramework.jq.data(a,"mutex");return b?c?c+1:1:c&&0<c?c-1:0}var c={};c.config=z("continue");
c.enable=function(c){var b=this.config({key:"enabledButton"}),g=this.config({key:"disabledButton"}),b=b?SDFramework.jq("input[name="+b+"]"):null,g=g?SDFramework.jq("#"+g):null;c?a(g,0)||(b&&0<b.length&&b.css("display","block"),g&&0<g.length&&g.css("display","none")):(g&&0<g.length&&(a(g,1),g.css("display","block")),b&&0<b.length&&b.css("display","none"))};return c}function P(){var a={};a.config=z("message");a._dom_container=E("element_container","message");a._dom=E("element","message");a._dom_service=
E("element_service","message");a.clear=function(){this._dom()&&(this._dom().html(""),this._dom_container().hide());this._dom_service()&&this._dom_service().html("")};a.hide=function(){this._dom()&&(this._dom().hide(),this._dom().parent().hide());this._dom_service()&&(this._dom_service().hide(),this._dom_service().parent().hide())};a.show=function(){this._dom()&&(this._dom_container().show(),this._dom().show());this._dom_service()&&(this._dom_container().show(),this._dom_service().show())};a.update=
function(a,d,b,g,h,f,m){if(a||d)if(a&&d||(b=!1),this._dom()){var n=a?b?this.dateDisplay.slotDisplayDateFn(new Date(1E3*a)):this.dateDisplay.displayDateFn(new Date(1E3*a)):null;f=d?b?this.dateDisplay.slotDisplayDateFn(new Date(1E3*d)):this.dateDisplay.displayDateFn(new Date(1E3*d)):null;b&&g&&(n="&nbsp;"+g.localStartTime,f=g.localEndTime+" "+this.dateDisplay.displayDateFn(new Date(1E3*d)));var e=b?this.config({key:"str_slot"}):this.config({key:"str_date"});b&&g?(b=new Date(1E3*a),b.getUTCDay(),0===
this.showDropdown?(this.config({key:"sd_item_delivery_message"})!==q&&(e=this.config({key:"sd_item_delivery_message"})),43200===d-a&&g.isHBDayDelivery&&this.config({key:"sd_item_delivery_message_without_time"})!==q&&(e=this.config({key:"sd_item_delivery_message_without_time"}))):e=this.config({key:"str_slot_message"}),e||(e=""),0===this.showDropdown&&(a="",m&&b.getUTCMonth()===m.today_m&&b.getUTCDate()===m.today_d?a=this.config({key:"sd_today"})+",":m&&b.getUTCMonth()===m.tmr_m&&b.getUTCDate()===
m.tmr_d&&(a=this.config({key:"sd_tomorrow"})+","),e=e.replace("%dot",a)),e=e.replace("%dts",g.localStartTime),e=e.replace("%dday",""),e=e.replace("%dte",g.localEndTime),e=e.replace("%dd",h)):(h=e,m=n,a=f,m=m?m:"",a=a?a:"",b=b?[m,"-",a].join(" "):""!==m?m:a,e=h+b);this._dom().html(e);this._dom().parent().show();0===this.showDropdown&&this.updateServiceMessage(this.getServices(g.reservationId));1===this.showServices&&this.showAvailableServices()}else t.console&&t.console.firebug&&t.console.warn("No message element available");
else t.console&&t.console.firebug&&t.console.log("message update called with no start or end"),this.clear()};a.showAvailableServices=function(){this._dom_service().parent().hide();if(this.serviceCharges!==q&&null!==this.serviceCharges&&!SDUtils.isEmptyObject(this.serviceCharges)){var a="",d;for(d in this.serviceCharges)if(this.serviceCharges.hasOwnProperty(d)){if(-1===d.indexOf(":"))msg_str=this.serviceDisplay[d].services===q?this.serviceDisplay[d].serviceDisplay:this.serviceDisplay[d].services.OLD.serviceDisplay;
else{var b=d.split(":");msg_str=this.serviceDisplay[b[0]].services[b[1]].serviceDisplay}msg_str=msg_str.replace("%formattag_start",'<li class="sd_bb_services">');msg_str=msg_str.replace("%formattag_end","</li>");msg_str=msg_str.replace("%formatCost_start",'<span class="a-color-price">');msg_str=msg_str.replace("%formatCost_end","</span>");msg_str=msg_str.replace("%service_cost",this.serviceCharges[d]);a+=msg_str}this._dom_service().html(a);this._dom_service().parent().show()}};a.updateServiceMessage=
function(a){this._dom_service().parent().hide();var d=this.config({key:"sd_item_delivery_service_message"});if(!(null===a||1>a.length||d===q)){for(var b="",g=0;g<a.length;g++)if(-1===a[g].indexOf(":"))b=this.serviceDisplay[a[g]].services===q?b+"<br> - "+this.serviceDisplay[a[g]].serviceAbbr:b+"<br> - "+this.serviceDisplay[a[g]].services.OLD.serviceAbbr;else var h=a[g].split(":"),b=b+"<br> - "+this.serviceDisplay[h[0]].services[h[1]].serviceAbbr;d=d.replace("%services",b);this._dom_service().html(d);
this._dom_service().parent().show()}};a.getServices=function(a){if(null===a||a===q)return null;a=a.split(";");if(4>a.length||1>a[3].length)return null;a=a[3].split("^");for(var d=[],b=0;b<a.length;b++)if(-1!==a[b].indexOf(":"))for(var g=a[b].split(":")[1],h=0;h<g.length;h++)d.push(a[b].charAt(0).toUpperCase()+":"+g.charAt(h));else for(g=a[b].split(""),h=0;h<g.length;h++)this.serviceDisplay[g[h].toUpperCase()]!==q&&d.push(g[h].toUpperCase());return d};return a}function V(a){function c(a){var b=a.inputs;
b&&b.clearSlotFields();if(b=a.message)b.clear(),b.parent&&b.parent()&&b.parent().hide();(a=a.cbutton)&&a.enable(0)}function d(a){var b=t.console;b&&b.firebug&&b.warn(a)}function b(a){var b={};a!==q&&a.today!==q&&a.c_m_id!==q&&a.tmr_m!==q&&a.tmr_d!==q?(b.today_m=a.c_m_id,b.today_d=a.today,b.tmr_m=a.tmr_m,b.tmr_d=a.tmr_d):(a=new Date,b.today_m=a.getMonth(),b.today_d=a.getDate(),a=new Date(a.getTime()+864E5),b.tmr_m=a.getMonth(),b.tmr_d=a.getDate());return b}function g(a,e,f){return function(k){if(k&&
!k.nil)if(e.hasRes(k,f)){var p=e.getRes(k,f);SDUtils.isEmptyObject(p)&&(c(a),d("No reservation selected for "+k));var h=a.inputs;h&&h.updateSlotFields(p);if(h=a.message){var g=0,m=a.config({key:"sd_calendar"}),v=m.calData.getCal(404),q=a.message.config({key:"timeslotDeterminationFn"});q&&q(v)&&(g=1);var A,l;for(l in v.days)v.days.hasOwnProperty(l)&&(q=v.days[l],q[0]===k&&(A=q[1]));k=m.config({key:"dateDisplay"});h.serviceDisplay=v.serviceDisplay;h.update(p.ultStart,p.ultEnd,g,p,A,k,b(v))}(p=a.cbutton)&&
p.enable(1)}else c(a),d("Time UI time")}}function h(a,b){if(b){var c=b.config({key:"sd_calendar"});if(c)if(a){var d;if(ScheduledDelivery.Debug.forceNoSlots)d={};else{d=b.config({key:"id_merchant"});var p=b.config({key:"id_marketplace"}),f=b.config({key:"id_request"}),h=b.config({key:"id_asin"}),m=b.config({key:"id_sku"}),v=b.config({key:"id_fmid"}),q=b.config({key:"id_quantity"}),A=b.config({key:"id_offerlist_id"}),l=b.config({key:"id_address"}),x=b.config({key:"id_itemList_id"}),t=b.config({key:"id_shipoption"}),
u;u=y.browser;if(null===u)u="";else{var z="unknown";u.mozilla?z="mozilla":u.msie?z="msie":u.webkit?z="webkit":u.safari?z="safari":u.opera&&(z="opera");u=z+":"+u.version}d={merchant:d,marketplace:p,requestId:f,asin:h,sku:m,FMID:v,quantity:q,offerListingID:A,address:l,itemListId:x,shipoption:t,browserType:u,templateSlotID:b.config({key:"id_template_slot"}),ie:"UTF8"}}c.config({key:"load_payload",value:d});(d=c.config({key:"load_url"}))||(d="/gp/product/features/scheduled-delivery/get-slots-json.html?powerbar=0");
c.config({key:"load_url",value:d});c.calData.clearCals();c.calendar(404);c.selectCalled({register:"shipoptionUI",fn:g(b,c,404)})}else c.calendar()}}function f(a){return function(){var b=a.config({key:"id_is_selected"});h(0,a);b&&h(1,a)}}var m={};m.config=z("config");m.inputs=new ScheduledDelivery.Data.FormPersistence;m.message=P();m.cbutton=U();a?y("body").bind(a,f(m)):t.console&&console.warn("Unable to bind load fn to dom element.");return m}function W(){function a(){}function c(a){var c,h,f;h=0;
f='<table id="sd-timeslot"><thead>';h='<tr><td colspan="9"><table class="sd-legend"><tr class="sd-legend"><td><table><tr>';h+='<td class="sd-timeslot-weekday-date-small">&nbsp;</td><td><span class"sd-legend">'+d.config({key:"not_available_key"})+"</span></td>";h+="</tr></table></td>";h+="<td><table><tr>";h+='<td class="sd-timeslot-highlight-date-small">&nbsp;</td><td><span class"sd-legend">'+d.config({key:"available_key"})+"</span></td>";h+="</tr></table></td>";h+="<td><table><tr>";h+='<td class="sd-timeslot-selected-date-small">&nbsp;</td><td><span class"sd-legend">'+
d.config({key:"selected_key"})+"</span></td>";h+="</tr></table></td>";h+="</tr></table></td></tr>";f+=h;var m=a.ids;h=new Date;var n=new Date(3E3,0,1);for(c in m)m.hasOwnProperty(c)&&(new Date(1E3*m[c].su)<n&&(n=new Date(1E3*m[c].su)),new Date(1E3*m[c].eu)>h&&(h=new Date(1E3*m[c].eu)));c=n;f+='<tr class="sd-timeslot-scroll-title">';f+='<th><span class="sd-timeslot-scroll-title">'+d.config({key:"months"})[a.c_m_id]+" "+c.getUTCFullYear()+"</span></th>";f+='<th><span class="sd-timeslot-scroll-title">'+
d.config({key:"months"})[a.n_m_id]+" "+h.getUTCFullYear()+"</span></th>";f+="</tr>";f+="</thead>";f+="<tbody>";f+="<tr>";f+='<td valign="top">';f+='<div id="sdcal-curr-month">';f+='<table class="sdcal-table" cellpadding="0" cellspacing="0" width=224px style="table-layout: fixed;">';for(h=0;7>h;h++)f+='<col width="32px"/>';f+='<thead class="sdcal-head">';f+="<tr>";for(h=0;7>h;h++)f+='<td class="sd-timeslot-index-date">'+d.config({key:"days"})[h]+"</td>";f+="</tr>";f+="</thead>";f+="<tbody>";f+="</tbody>";
f+="</table>";f+="</div> \x3c!-- sdcal-curr-month --\x3e";f+="</td>";f+='<td valign="top">';f+='<div id="sdcal-next-month" style="float:right;">';f+='<table class="sdcal-table" cellpadding="0" cellspacing="0" width=224px style="table-layout: fixed;">';for(h=0;7>h;h++)f+='<col width="32px"/>';f+='<thead class="sdcal-head">';f+="<tr>";for(h=0;7>h;h++)f+='<td class="sd-timeslot-index-date">'+d.config({key:"days"})[h]+"</td>";f+="</tr>";f+="</thead>";f+="<tbody>";f+="</tbody>";f+="</table>";f+="</div> \x3c!-- sdcal-next-month --\x3e";
f+="</td>";f+="</tr>";return f+="</table>"}var d={};d.config=z("config");d._dom=E("element","popup");d.popupInitialized=!1;d.popupContent=[];d.enable=function(a){a?(a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.show()):((a=this._dom())&&a.hide(),a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.hide())};d.onSelect=function(){var a=this.config({key:"available"}),c=this.config({key:"element"});SDFramework.jq("#"+c+" ."+a).click(function(a){return function(){var b=SDFramework.jq(this).attr("id"),
b=a._dateId({parse:b});a.select(b);b?a.selectCalled({arg:b}):a.selectCalled({nil:!0})}}(this))};d.click=function(){return function(){}};d.setup=function(b){function g(a){var b=Math.ceil((a.c_m_len+a.c_m_delta)/7);a=Math.ceil((a.n_m_len+(a.c_m_delta+a.c_m_len)%7)/7);return Math.max(b,a)}function h(a,b){var c=["c_m_len","c_m_delta","n_m_len"],d;for(d in c)if(c.hasOwnProperty(d)){if(!a.hasOwnProperty(c[d]))return["No",d,"data value"].join(" ");if(0>a[c[d]])return["Negative",d,"data value",c[d]].join(" ")}c=
["next_month_id","current_month_id"];for(d in c)if(!b.config({key:c[d]}))return["No",c[d],"configured"].join(" ")}function f(a,b,c){function d(a,b){if(1>a||a>f)return SDFramework.jq("<td>&nbsp;</td>").addClass(b.config({key:"notaday"}));var c=SDFramework.jq("<td>"+a+"</td>");c.addClass(b.config({key:"day"}));c.addClass(b.config({key:"notavailable"}));c.attr("id",b._dateId({date:a+h}));return c}var e,f,h;c?(e=b.config({key:"next_month_id"}),f=a.n_m_len,h=a.c_m_len,c=(a.c_m_delta+a.c_m_len)%7):(e=b.config({key:"current_month_id"}),
f=a.c_m_len,h=0,c=a.c_m_delta);e=["#",b.config({key:"element"})," #",e," table.sdcal-table tbody"].join("");a=g(a);e=SDFramework.jq(e);e.html("");for(var n=0;n<a;++n){for(var m=SDFramework.jq("<tr></tr>"),l=1;7>=l;++l)m.append(d(7*n+l-c,b));e.append(m)}}if(this._dom()){if(!this.popupInitialized){var m=this.config({key:"linkId"}),n=SDFramework.jq("#"+m);this.popupInitialized=!0}if(m=h(b,this))t.console&&t.console.firebug&&console.warn("Invalid data: "+m);else{var e=this.config({key:"element"}),m=SDFramework.jq("#"+
e);m[0]?m[0].innerHTML=c(b):t.console&&t.console.firebug&&console.warn("No "+e+" element");f(b,this,0);f(b,this,1);b.today&&this.config({key:"today"})&&SDFramework.jq(this._dateId({id:b.today})).addClass(this.config({key:"today"}));H.when("jQuery","legacy-popover").execute(function(b){n.removeAmazonPopoverTrigger();n.amazonPopoverTrigger({width:540,location:["left","bottom","right"],locationAlign:"middle",localContent:"#"+e,title:'<span class="sd-timeslot-calendar-title">'+d.config({key:"popup_date_title"})+
"</span>",modal:!0,semiStatic:!0,onHide:a,draggable:!0,closeText:d.config({key:"closeText"}),closeEventInclude:["CLICK_OUTSIDE","CLICK_TRIGGER"]})})}}};d._dateId=function(a){if(this.config({key:"prefix"})){if(a.parse)return a.parse.split("-").pop();if(a.date)return[this.config({key:"prefix"}),a.date].join("-");if(a.id){var c=this.config({key:"element"});c&&(c=["#",c," "].join(""));a=[this.config({key:"prefix"}),a.id].join("-");return c+"#"+a}}};d.add=function(a){a=SDFramework.jq(this._dateId({id:a}));
a.removeClass(this.config({key:"notavailable"}));a.addClass(this.config({key:"available"}))};d.selectCalled=M("select");d.select=function(a){var c=this.config({key:"current_month_id"}),d=this.config({key:"next_month_id"}),f=this.config({key:"selected"}),m=this.config({key:"element"}),c=["#",m," #",c," .",f].join(""),d=["#",m," #",d," .",f].join(""),m=SDFramework.jq(c),d=SDFramework.jq(d);m.removeClass(f);d.removeClass(f);a&&(a=this._dateId({id:a}),SDFramework.jq(a).addClass(f))};return d}function X(){function a(a){return function(){var b=
SDFramework.jq(["select#",this.id," option:selected"].join(""));b.val()?a.selectCalled({arg:b.val()}):a.selectCalled({nil:!0})}}var c={};c.config=z("config");c._dom=E("element","dropdrown");c.__slots=[];c.__slotIds={};c.enable=function(c){if(this._dom()){var b=this.config({key:"str_disable"});c?(b&&this.make(),this._dom().attr("disabled",!1),a(this)()):(this._dom().attr("disabled",!0),b&&this._dom().html(J("",b,!0)))}else t.console&&t.console.firebug&&console.warn("no dropdown DOM element found")};
c.make=function(){var a=this.config({key:"str_select"});if(a){this._dom()||t.console&&t.console.firebug&&console.warn("Unable to find DOM element for makeDropdown");a=J("",a,!0);if(0<this.__slots.length){this.__slots.sort(function(a,b){if(a.details.startDateUTC&&a.details.endDateUTC&&b.details.startDateUTC&&b.details.endDateUTC){var c=a.details,d=b.details,p=c.startDateUTC-d.startDateUTC;if(0!==p)return p;p=c.endDateUTC-d.endDateUTC;return 0!==p?p:(c.services!==q?c.services:"").length<=(d.services!==
q?d.services:"").length}var c=a.id,d=b.id,f=p=0,h=0,g=0;0<=c.indexOf("-")?(p=parseInt(c.substring(0,c.indexOf("-")),10),f=parseInt(c.substring(c.indexOf("-")+1),10)):p=parseInt(c,10);0<=d.indexOf("-")?(h=parseInt(d.substring(0,d.indexOf("-")),10),g=parseInt(d.substring(d.indexOf("-")+1),10)):h=parseInt(d,10);return 100*(p-h)+(f-g)});for(var b=0;b<this.__slots.length;b++){var c=this.__slots[b],h=c.id,c=c.details,f=c.name,m="";c.services&&0<c.services.length&&(m=c.services.sort().join(""));a+=J(h,f,
!1,m)}}this._dom().html(a)}else t.console&&t.console.firebug&&console.warn("Missing str_select for makeDropdown")};c.clear=function(){this.__slots=[];this.__slotIds={}};c.add=function(a,b,c,h,f){if(!this.__slotIds[a]){this.__slotIds[a]=1;var m={};m.name=b;m.startDateUTC=h;m.endDateUTC=f;m.services=c?c:"";b={};b.id=a;b.details=m;this.__slots.push(b)}};c.selectCalled=M("select");c.select=function(a){try{this._dom().val(a)}catch(b){}};c.onSelect=function(){this._dom().change(a(this));this._dom().focus(a(this))};
return c}function Y(a){function c(a,b){var c=a.ids[b];if(!c)return!1;var h=a.shipOfferingID,f=a.carrierFss,m;if(f){m=(new ScheduledDelivery.Data.ReservationIdParser(c.id)).getCarriers();for(var n=[],e=0;e<m.length;e++)n.push(f[m[e]]);m=ScheduledDelivery.Data.FulfillmentServiceSubclass.pickTightestSla.apply(q,n)}f=a.isHBDayDelivery;SDFramework.jq("#sd_buybox_root").trigger("slotSelected");return{slotId:c.srsids,reservationId:c.id,reservationType:c.rt,start:c.su,ultStart:c.s,mltStart:c.sm,localStartTime:c.sut,
end:c.eu,ultEnd:c.e,mltEnd:c.em,localEndTime:c.eut,cutoff:c.cu,ultCutoff:c.c,mltCutoff:c.cm,timeZone:c.t,tz:c.tz,minShip:c.minShip,maxShip:c.maxShip,shipOffer:h,fss:m,isHBDayDelivery:f}}a={};a.calendarData=z("calendar_data");a.clearCals=function(){this.__calendar_data=null;this.calendarData=z("calendar_data")};a.getCal=function(a){return this.calendarData({key:a})};a.hasCal=function(a){return this.calendarData({key:a})?!0:!1};a.hasRes=function(a,b){if(!a)return!1;if(!this.hasCal(b))return u.debug("no cal for "+
b),!1;var g=this.getCal(b);if(!g.ids)return u.debug("no ids in cal "+b),!1;g=c(g,a);return SDUtils.isEmptyObject(g)?(u.debug("No res data for "+a),!1):!0};a.getRes=function(a,b){if(!this.hasRes(a,b))return{};var g=this.getCal(b);return g.ids[a]?c(g,a):(u.warn("getRes messup"),{})};a.load=function(a,b){b._loading(!0);var c=b.config({key:"load_url"});t.console&&t.console.firebug&&console.warn("loading URL : "+c);var h=b.config({key:"load_payload"}),c={url:c,type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",
data:h,traditional:!0,success:function(a,b,c){return function(d,h){c.calendarData({key:b,value:d});a._loading(!1);a.calendar(b);SDFramework.jq("#sd_buybox_root").trigger("slotsReturned")}}(b,a,this),error:function(a){return function(b,c,d){t.console&&t.console.firebug&&console.warn("unable to get calendar");a._loading(!1,1);a.deactivateCalendar();SDFramework.jq("#sd_buybox_root").trigger("slotsErrored")}}(b,a,this),timeout:2E4};SDFramework.jq.ajax(c)};return a}function O(a,c,d,b,g,h,f,m){var n={};
n.identifier=a;n.startDate=c;n.startDateUTC=c;n.endDate=d;n.endDateUTC=d;n.key=g;n.selected=!1;n.textDisplay=h;n.cost=0;n.areNonVisibleServices=!1;n.config=z("config");n.showAsterisk=function(){return this.areNonVisibleServices&&m};n.getServices=function(a){var b=[];a=a.split("^");for(var c=0;c<a.length;c++){var d=a[c];if(-1!==d.indexOf(":"))for(var f=d.split(":"),d=f[0],f=f[1],h=0;h<f.length;h++)b.push(d+":"+f.charAt(h));else for(f=0;f<d.length;f++)b.push(d.charAt(f))}return b};n.initializeWithScheduledDelivery=
function(a){this.identifier=a.id;this.startDate=new Date(1E3*a.s);this.endDate=new Date(1E3*a.e);this.startDateUTC=new Date(1E3*a.su);this.endDateUTC=new Date(1E3*a.eu);this.startTimeDisplay=a.sut;this.endTimeDisplay=a.eut;this.promotion=a.prom;this.cost=a.costDisplay;this.services=this.getServices(a.service);this.areNonVisibleServices=!1;this.serviceDisplay="";for(var b in this.services)this.services.hasOwnProperty(b)&&(a=this.services[b].charAt(0),f[a]?this.serviceDisplay+=f[a].serviceAbbr+", ":
this.areNonVisibleServices=!0);this.serviceDisplay=0<this.serviceDisplay.length?this.serviceDisplay.substring(0,this.serviceDisplay.length-2):""};b&&n.initializeWithScheduledDelivery(b);n.selectSlot=function(a){this.selected=a};n.timePlacement=function(a,b,c){var d=a.getTime(),f=this.startDate.getTime(),h,g;switch(c){case "D":h=d/864E5|0;g=f/864E5|0;break;case "H":h=a.getUTCHours();g=this.startDate.getUTCHours();break;case "M":h=a.getUTCMinutes(),g=this.startDate.getUTCMinutes()}return(g-h)/b|0};
n.slotPlacement=function(a,b,c,d){return{timeSpot:this.timePlacement(a,c,d),daySpot:this.timePlacement(a,b,"D")}};n.toString=function(){var a=this.startTimeDisplay,b=this.endTimeDisplay,a=this.textDisplay?a+"-"+b+" "+this.textDisplay:this.dateDisplay&&this.dateDisplay.displayDateFn?a+"-"+b+" "+this.dateDisplay.displayDateFn(this.endDate):a+"-"+b+" "+this.endDate.toDateString(),b=!this.cost||this.cost.match(/^\s*$/)||"open"==this.cost||"&nbsp;"==this.cost?"&nbsp;":"("+this.cost+")",c="";this.showAsterisk()&&
(c="*");return[a," ",this.serviceDisplay," ",b,c].join("")};return n}function Z(a,c){function d(a,b){var c=null;-1!==a.indexOf(":")?(c=a.split(":"),c=b[c[0]].services[c[1]]):c=b[a];return c}function b(a){if(a===q)return"";for(var b=[],c=0;c<a.length;c++)if(-1!==a[c].indexOf("^"))b.push(a[c]);else for(var d=a[c].split(""),e=0;e<d.length;e++)b.push(d[e]);b.sort();return b.join("^")}var g={};g.config=z("config");g.parent=a;g.uiOwner=c;g.slots=[];g.allSlots=[];g.currentServices=[];g.slotsPerService=[];
g.slotsForServiceCombinations=[];g.services=[];g.serviceStrings=[];g.pivotDateTime=null;g.pivotDay=3;g.nightSlotEndTimeLimit=19;g.initialized=!1;g.initialize=function(a,b){this.initialized||(this.daySpan||(this.daySpan=this.uiOwner.config({key:"daySpan"})),this.dayLength||(this.dayLength=this.uiOwner.config({key:"dayLength"})),this.setPivotDate(a),this.initializeServiceType("",!0),this.defaultSlotId=b,this.initialized=!0)};g.getDefaultBaseSlot=function(){if(this.serviceStrings===q)return this.sortedSlotList()[0];
for(var a=0;a<this.sortedSlotList().length;a++){var b=this.sortedSlotList()[a],c=b.services;if(c===q||1>c.length||!this.containVisibleService(c))return b}return this.sortedSlotList()[0]};g.containVisibleService=function(a){for(var b=0;b<a.length;b++)if(this.serviceStrings[a[b]]!==q)return!0;return!1};g.getDefaultSlot=function(a){if(this.defaultSlotId)return"NO_DEFAULT"===this.defaultSlotId?null:this.getSlotByKey(this.defaultSlotId);if(0===a)return this.getDefaultBaseSlot();for(var b=a=null,c=0;c<
this.sortedSlotList().length;c++){var d=this.sortedSlotList()[c];if(parseInt(d.endTimeDisplay.split(":")[0],10)>=this.nightSlotEndTimeLimit){if(null===a||a.startDateUTC>d.startDateUTC)a=d}else if(null===b||b.startDateUTC>d.startDateUTC)b=d}return null!==b?b:a};g.setSlots=function(a,b){var c=new Date,g=a.getCal(b);this.initialize(c,g.defaultSlotId);if(g){var e=this.uiOwner.config({key:"surcharge_message"}),e=e&&0<=e.indexOf("*"),r;for(r in g.ids)if(g.ids.hasOwnProperty(r)){var k=void 0,p=void 0;for(p in g.days)g.days[p][0]&&
g.days[p][0]==r&&(k=g.days[p][1]);k=O(null,null,null,g.ids[r],r,k,g.serviceDisplay,e);p=g.serviceDisplay;if(k.endDate>new Date){var w=k,G=this.parent.config({key:"dateDisplay"});w.dateDisplay=G;this.allSlots.push(k);var w=k.services,G=p,C=[],v=void 0;for(v in w)(-1!==w[v].indexOf(":")||G[w[v]])&&C.push(w[v]);0===C.length&&C.push("");w=C;G=null;if(1<w.length){w.sort();C=w.join("");v=void 0;for(v in w)w.hasOwnProperty(v)&&(this.currentServices[w[v]]=!1,(G=d(w[v],p))||(w[v]=""),""===w[v]&&(this.slots.push(k),
this.currentServices[""]=!0),this.services[w[v]]=w[v]);this.slotsForServiceCombinations[C]||(this.slotsForServiceCombinations[C]=[]);this.slotsForServiceCombinations[C].push(k)}else 1==w.length&&(w=w[0],this.currentServices[w]=!1,(G=d(w,p))||(w=""),""===w&&(this.slots.push(k),this.currentServices[""]=!0),this.slotsPerService[w]||(this.slotsPerService[w]=[]),this.slotsPerService[w].push(k),this.services[w]=w)}}this.copyServiceStrings(g.serviceDisplay);this.formatServiceChargesString(g.serviceCharges)}g=
c;r=this.uiOwner.config({key:"dayLength"});e=r/2|0;g=this.sortedSlotList()[0].startDate;1===this.orderDayAsFirstDay&&(g=c);this.setPivotDay((g.getUTCDay()+e)%r);this.setPivotDate(g)};g.copyServiceStrings=function(a){for(var b in a)if(a.hasOwnProperty(b)&&(this.serviceStrings[b]={serviceString:a[b].serviceString,serviceLearnMore:a[b].serviceLearnMore},a[b].services)){var c=a[b].services,d;for(d in c)c.hasOwnProperty(d)&&(this.serviceStrings[b+":"+d]={serviceString:c[d].serviceString,serviceLearnMore:c[d].serviceLearnMore})}};
g.formatServiceChargesString=function(a){for(var b in a)a.hasOwnProperty(b)&&this.serviceStrings.hasOwnProperty(b)&&this.serviceStrings[b].serviceString&&(this.serviceStrings[b].serviceString=this.serviceStrings[b].serviceString.replace("%service_cost",a[b]))};g.initializeServiceType=function(a,b){this.currentServices[a]=b};g.setServiceType=function(a,b){this.currentServices[a]===q&&(a="");this.currentServices[a]=b;var c=[],d;for(d in this.currentServices)"undefined"!=typeof d&&""!==d&&this.currentServices[d]&&
c.push(d);0===c.length?this.slots=this.slotsPerService[""]:1==c.length?this.slots=this.slotsPerService[c[0]]:(c.sort(),c=c.join(""),this.slots=this.slotsForServiceCombinations[c])};g.lastGrid=null;g.setPivotDay=function(a){0<=a&&6>=a&&(this.pivotDay=a)};g.setPivotDate=function(a){this.pivotDateTime=a?new Date(a.getTime()):new Date;this.pivotDateTime.setUTCHours(0,0,0,0);var b=this.pivotDateTime.getUTCDay();this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()+this.pivotDay-b);this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate());
var b=this.uiOwner.config({key:"dayLength"}),c=+b/2|0,d=new Date(this.pivotDateTime.getTime());d.setUTCDate(d.getUTCDate()-c);var e=new Date(this.pivotDateTime.getTime());e.setUTCDate(e.getUTCDate()+c);e.setUTCHours(23,59,59,999);a.getTime()>e.getTime()?this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()+b):a.getTime()<d.getTime()&&this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()-b)};g.slotsInRange=function(){var a=+this.uiOwner.config({key:"dayLength"})/2|0,b=new Date(this.pivotDateTime);
b.setUTCDate(b.getUTCDate()-a);a=[];this.sortedSlotList();if(this.slots)for(var c=0;c<this.slots.length;c++){var d=this.slots[c].timePlacement(b,this.daySpan,"D");0<=d&&d<this.dayLength&&(a[d]||(a[d]=[]),a[d].push(this.slots[c]))}return this.lastGrid=a};g.sortedSlotList=function(){this.initialize(new Date);return this.allSlots.sort(function(a,b){return 0===a.startDate-b.startDate?a.endDate-b.endDate:a.startDate-b.startDate})};g.orderedRowKeys=function(a){a=[];var b=[],c=0;for(c in this.lastGrid)if(c==
parseInt(c,10))for(var d in this.lastGrid[c])d==parseInt(d,10)&&a.push({start:60*this.lastGrid[c][d].startDate.getUTCHours()+this.lastGrid[c][d].startDate.getUTCMinutes(),end:60*this.lastGrid[c][d].endDate.getUTCHours()+this.lastGrid[c][d].endDate.getUTCMinutes(),stime:this.lastGrid[c][d].startTimeDisplay,etime:this.lastGrid[c][d].endTimeDisplay});a.sort(function(a,b){return a.start==b.start?a.end-b.end:a.start-b.start});0<a.length&&b.push(a[0]);for(d=1;d<a.length;d++)a[d-1].start==a[d].start&&a[d-
1].end==a[d].end||b.push(a[d]);return b};g.getSlotById=function(a){if(!a)return null;for(var b=0;b<this.allSlots.length;b++)if(this.allSlots[b].identifier==a)return this.allSlots[b];return null};g.getSlotByTimes=function(a,c,d){if(!(a&&c&&d&&this.allSlots))return null;var g=d.split(";");d=[];4<=g.length&&(d=g[3].split("^"));for(g=0;g<this.allSlots.length;g++){var e=this.allSlots[g],r;if(r=e.startDate.getTime()==1E3*a&&e.endDate.getTime()==1E3*c)r=d,r=b(e.services)===b(r);if(r)return e}return null};
g.getCurrentSlotByTimes=function(a,b){if(!a||!b||!this.slots)return null;for(var c=0;c<this.slots.length;c++){var d=this.slots[c];if(d.startDate.getTime()==a&&d.endDate.getTime()==b)return d}return null};g.getSlotByKey=function(a){for(var b=0;b<this.allSlots.length;b++)if(this.allSlots[b].key===a)return this.allSlots[b];return null};return g}function aa(a){function c(a,b){var c,d=e.config({key:"notavailable"});c=e.config({key:"slotButton"});var f="",h="";if(-1===a&&-1===b)return d=e.config({key:"notavailable"}),
c='<td class="'+c+'" rowspan="1">'+('<div class="'+d+'">'),c+="</div>",c+="</td>";var g=1;if(e.model.lastGrid[b])for(var n=0;n<e.model.lastGrid[b].length;n++)if(a.start==60*e.model.lastGrid[b][n].startDate.getUTCHours()+e.model.lastGrid[b][n].startDate.getUTCMinutes()&&a.end==60*e.model.lastGrid[b][n].endDate.getUTCHours()+e.model.lastGrid[b][n].endDate.getUTCMinutes()){d=e.config({key:"available"});e.model.lastGrid[b][n].promotion&&(d+=" "+e.config({key:"promotionavailable"}));f=e.model.lastGrid[b][n].key;
h=e.model.lastGrid[b][n].cost;e.model.lastGrid[b][n].showAsterisk()&&(h+="*");var m=e.model.lastGrid[b][n],l=e.selected_id;if(!l&&m.selected||l==m.key)d+=" "+e.config({key:"selected"});e.model.lastGrid[b][n].rowspan!==q&&(g=e.model.rowspan)}[e.config({key:"prefix"}),f].join("-");c='<td id="'+f+'" class="'+c+" "+d+' ap_custom_close" rowspan="'+g+'">';c=d===e.config({key:"notavailable"})?c+"&nbsp;":c+h;return c+="</td>"}function d(a,b){var c=a+"Nav"+b,d;d=""+('<td class="'+e.config({key:c+"Class"})+
'">');d+=e.config({key:c+"Inner"});return d+"</td>"}function b(){function b(){var c=e.model.pivotDateTime.getUTCMonth(),d=e.model.pivotDateTime.getUTCFullYear(),k=e.model.pivotDateTime.getUTCDate();e.selected_id===q&&(e.selected_id=SDFramework.jq("#"+e.config({key:"element"})+" ."+e.config({key:"selected"})).attr("id"));e.navigateLateralSlots(0,k,c,d);c=e.selected_id;d=d=null;c&&(d=e.model.getSlotByKey(c),d=e.model.getCurrentSlotByTimes(d.startDate.getTime(),d.endDate.getTime()));d&&(a.enableInconsistentWithBuybox(!1),
e.selected_id=d.key,n(e,d.key))}function c(b){var d=this.id;SDFramework.jq(this).bind("click",function(b){a.enableInconsistentWithBuybox(!1);e.selected_id=d;n(e,d)});SDFramework.jq(this).dblclick(function(){SDFramework.jq(".ap_close").click()})}var d=SDFramework.jq(".sd-timeslot-scroll-title-left-enabled"),f=SDFramework.jq(".sd-timeslot-scroll-title-right-enabled"),h=SDFramework.jq("td."+e.config({key:"available"})),g=SDFramework.jq("td."+e.config({key:"selected"}));d.bind("click",function(a){a=e.model.pivotDateTime.getUTCMonth();
var b=e.model.pivotDateTime.getUTCFullYear(),c=e.model.pivotDateTime.getUTCDate();e.navigateLateralSlots(-1,c,a,b)});f.bind("click",function(a){a=e.model.pivotDateTime.getUTCMonth();var b=e.model.pivotDateTime.getUTCFullYear(),c=e.model.pivotDateTime.getUTCDate();e.navigateLateralSlots(1,c,a,b)});SDFramework.jq(".sdServiceType").click(function(a){var c=SDFramework.jq(this);a=c.is(":checked");c=c.attr("servicetype");e.selectService(c,a);b()});SDFramework.jq(".sdHSelectServiceType").change(function(a){SDFramework.jq(".sdHServiceType",
this).each(function(){var a=SDFramework.jq(this),b=a.is(":selected"),a=a.attr("servicetype");e.selectService(a,b)});setTimeout(b,0)});h.each(c);g.each(c)}function g(a,b,c){for(var d=0;d<c.length;d++)if(a==60*c[d].startDate.getUTCHours()+c[d].startDate.getUTCMinutes()&&b==60*c[d].endDate.getUTCHours()+c[d].endDate.getUTCMinutes())return d;return-1}function h(a){var b=0;if(3>a.length)return null;for(var c=-1,b=0;b<a.length-2;b++)if(a[b].start==a[b+1].start){c=b;break}if(0>c)return null;for(var d=a[c].end,
e=a[c+1].end,b=c+2;b<a.length&&!(a[b].start!=d||a[b].end>e);b++){if(a[b].end==e)return[c,b];d=a[b].end}return null}function f(){var a=e.config({key:"rootWidgetId"});SDFramework.jq("#"+a).attr("alreadyShowingPopup",1);0===e.showDropdown&&SDFramework.jq("#"+a).parents("td").eq(0).prev().find("input[type=radio]").click();t.popoverTimer&&(a=t.popoverTimer[e.config({key:"widgetIndex"})],a!==q&&clearTimeout(a));e.logClientSideMetrics(e.clientSideMetrics.openCalendar);for(var a=null!==e.selectedSlot?e.selectedSlot.services:
[],c=0;c<a.length;c++)e.model.setServiceType(a[c],1);a=e.config({key:"element"});a=SDFramework.jq("#"+a);c=e.getCalendarHtml();a&&a[0]&&(a[0].innerHTML=c);b();SDFramework.jq("#ap_overlay").bind("touchend",function(){this.click()})}function m(){e.select(e.selected_id);e.logClientSideMetrics(e.clientSideMetrics.closeCalendar);var a=e.config({key:"rootWidgetId"});SDFramework.jq("#"+a).attr("alreadyShowingPopup",0)}function n(a,b){var c=a.config({key:"element"}),d=a.config({key:"selected"});a.config({key:"available"});
SDFramework.jq("#"+c+" ."+d).removeClass(d);b&&(SDFramework.jq("#"+b).addClass(d),c=a.model.getSlotByKey(b),a.logClientSideMetricsForSlot(a.clientSideMetrics.selectSlot,c))}var e={};e.config=z("config");e._dom=E("element","popup");e.popupInitialized=!1;e.model=Z(a,e);e.selectedSlot=null;e.enable=function(a){a?(a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.show()):(this._dom()&&this._dom().hide(),a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.hide())};e.onSelect=function(){};e.click=
function(){};e.colorSwatch=function(){var a=[];a.push('<div class="calendar-header">');a.push('<span class="calendar-swatch calendar-not-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"not_available_key"})+"</span>");a.push('<span class="calendar-swatch calendar-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"available_key"})+"</span>");a.push('<span class="calendar-swatch calendar-selected">&nbsp;</span><span class="calendar-legend">'+e.config({key:"selected_key"})+
"</span>");this.promotionAvailable&&a.push('<span class="calendar-swatch calendar-promotion-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"promotion_available_key"})+"</span>");a.push("</div>");return a.join("")};e.refreshSlots=function(){for(var a in this.model.allSlots)if(this.model.allSlots.hasOwnProperty(a)){var b=this.model.allSlots[a];b.originalEndDate&&(b.endDate=b.originalEndDate);b.originalEndTimeDisplay&&(b.endTimeDisplay=b.originalEndTimeDisplay);b.rowspan=q;b.promotion!==
q&&(this.promotionAvailable=!0)}};e.getCalendarHtml=function(){var a=this.config({key:"days"}),b,p,f,g,n,m,F=this.config({key:"dayLength"}),A=+F/2|0;b=p=0;var l="";this.model.initialize(new Date);this.refreshSlots();this.model.slotsInRange();l+=this.colorSwatch();l+='<table class="sd-timeslot-header" border=0 cellpadding=2 cellspacing=0 width="470"><thead>';n=new Date(this.model.pivotDateTime.getTime());n.setUTCDate(n.getUTCDate()-A);m=new Date(this.model.pivotDateTime.getTime());m.setUTCDate(m.getUTCDate()+
A);b=n.getUTCDay();f=this.model.pivotDateTime.getUTCMonth();g=this.model.pivotDateTime.getUTCFullYear();p=this.model.pivotDateTime.getUTCDate();var x;x=this.config({key:"surcharge_message"});var t=[];t.push('<tr class="sd_notice">');t.push('<td colspan="3">');t.push('<span class="sd_notice">');t.push(x);t.push("</span>");t.push("</td>");t.push("</tr>");t.push("<tr>");t.push('<td colspan="3">');t.push('<hr class="sd_dashed" />');t.push("</td>");t.push("</tr>");x=t.join("");l+=x;x="";t=e.config({key:"months"});
t=new L(t);x=x+'<tr class="sd-timeslot-scroll-title">'+d("left",e._canMove(-1,p,f,g)?"Enabled":"Disabled");x+='<td class="sd-timeslot-scroll-title">';x+='<span class="sd-timeslot-scroll-title">';x+=t.popoverRangeDisplay(n,m);x+="</span>";x+="</td>";x+=d("right",e._canMove(1,p,f,g)?"Enabled":"Disabled");x+="</tr>";l+=x;l+="</thead>";l+="</table>";l+='<table class="sd-timeslot-table" width="470px" style="table-layout: fixed;">';l+="<tbody>";this.model.monthOfDays=[];this.model.dayOfDays=[];f=new Date;
l+='<tr class="sd-timeslot-index-date">';l+='<th class="sd-timeslot-index-date sdleft">&nbsp;</th>';for(p=g=0;p<=2*A;p++)m=new Date(n.getTime()),m.setDate(m.getUTCDate()+p),l+='<th class="sd-timeslot-index-date">',x=(b+p)%7,x=0>x?7+x:x,l+='<span class="sd-timeslot-index-date">',l=1===this.model.orderDayAsFirstDay&&e.config({key:"sd_today"})!==q&&f.getFullYear()===m.getFullYear()&&f.getUTCMonth()===m.getUTCMonth()&&f.getUTCDate()===m.getUTCDate()?l+e.config({key:"sd_today"}):l+a[x],l+="<br />"+m.getDate(),
l+="</span>",l+="</th>",this.model.monthOfDays[g]=m.getUTCMonth(),this.model.dayOfDays[g]=m.getUTCDate(),g++;l+="</tr>";a=this.model.orderedRowKeys(!0);if(0===a.length){l+="<tr>";for(b=-A;b<=A;b++)l+=c(-1,-1);l+="</tr>";l+="<tr>";l+='<td class="sd-timeslot-index-date sdleft"></td>';l+='<td class="sd-message" colspan='+F+'><span class="sd-message">'+e.config({key:"no_slots_for_week"})+"</span></td>";l+="</tr>"}this.model.cellsToMerge=h(a);this.model.availableDay=q;this.model.hideCells={};null!==this.model.cellsToMerge&&
e.checkSlots(a);this.model.availableDay!==q&&0>=this.model.availableDay&&(a.splice(this.model.cellsToMerge[0]+1,1),this.model.rowspan=this.model.cellsToMerge[1]-this.model.cellsToMerge[0]);A=new L(e.config({key:"months"}));for(p=0;p<a.length;p++){n=a[p];b=[n.stime,n.etime];l+="<tr>";l+='<td class="sd-timeslot-rowindex-date sdleft"><span class="sd-timeslot-rowindex-date">'+A.timeRangeDisplay(b[0],b[1])+"</span></td>";for(b=0;b<F;b++)e.isHidden(p,b)===q&&(l+=c(n,b));l+="</tr>"}var l=l+"</tbody>",l=
l+"</table>",A={},F={},u;for(u in this.model.services)-1!==u.indexOf(":")&&(a=u.split(":"),F[a[0]]!==q?F[a[0]].push(a[1]):(F[a[0]]=[],F[a[0]].push(a[1]),A[a[0]]=1));for(var y in this.model.services)this.model.services.hasOwnProperty(y)&&-1===y.indexOf(":")&&(A[y]?F[y].push("OLD"):(u=l,l=y,e.config({key:"strings"}),e.model.serviceStrings[l]?(a=e.model.serviceStrings[l].serviceString,b=e.model.serviceStrings[l].serviceLearnMore,n=[],n.push('<div class="sd_notice">'),a&&(n.push('<input type="checkbox" class="sdServiceType" ',
e.model.currentServices[l]?"checked":"",' serviceType="',l,'" />'),n.push(a)),b&&(n.push(" "),n.push(b)),n.push("</div>"),l=n.join("")):l="",l=u+l));for(var D in F)if(F.hasOwnProperty(D)){l+='<div class="sd_notice">';l+="<br />";l+=e.model.serviceStrings[D].serviceString;e.model.serviceStrings[D].serviceLearnMore&&(l+=" "+e.model.serviceStrings[D].serviceLearnMore);l+="<br />";l+='<select class="sdHSelectServiceType">';l+='<option value="none">-</option>';for(y=0;y<F[D].length;y++)u=F[D][y],A=D+":"+
u,a=!1,b="",a="OLD"===u?e.model.currentServices[D]:e.model.currentServices[A],b=e.model.serviceStrings[A].serviceString,l+='<option class="sdHServiceType" servicetype="',l="OLD"===u?l+D:l+A,l+='"',a&&(l+='selected="selected"'),l+=">",l+=b,l+="</option>";l+="</select>";l+="</div>"}return l};e.checkSlots=function(a){var b=this.config({key:"dayLength"});this.model.availableDay=0;this.model.matchingDays=[];for(var c=0;c<b;c++)this.model.lastGrid[c]&&e.processMatchingColumn(e.checkColumn(a,c),a,c);e.hideRow(b)};
e.hideRow=function(a){if(!(0>=this.model.availableDay))for(a=0;a<this.model.matchingDays.length;a++)e.hideOneCell(this.model.cellsToMerge[1],this.model.matchingDays[a])};e.processMatchingColumn=function(a,b,c){if(!(0>a)){a=this.model.lastGrid[c][a];a.originalEndDate=new Date(a.endDate.getTime());a.originalEndTimeDisplay=a.endTimeDisplay;a.endDate.setUTCHours(b[this.model.cellsToMerge[0]].end/60|0);a.endDate.setUTCMinutes(b[this.model.cellsToMerge[0]].end%60);a.endTimeDisplay=b[this.model.cellsToMerge[0]].etime;
a.rowspan=1;for(b=this.model.cellsToMerge[0]+1;b<this.model.cellsToMerge[1];b++)e.hideOneCell(b,c);this.model.rowspan=this.model.cellsToMerge[1]-this.model.cellsToMerge[0]+1}};e.checkColumn=function(a,b){var c=this.model.cellsToMerge[0],d=g(a[c+1].start,a[c+1].end,this.model.lastGrid[b]);if(0>d)return-1;this.model.availableDay++;if(0<=g(a[c].start,a[c].end,this.model.lastGrid[b]))return-1;for(c+=2;c<a.length&&c<=this.model.cellsToMerge[1];c++)if(0<=g(a[c].start,a[c].end,this.model.lastGrid[b]))return-1;
this.model.availableDay--;this.model.matchingDays.push(b);return d};e.isHidden=function(a,b){return this.model.hideCells['"'+this.model.monthOfDays[b]+"-"+this.model.dayOfDays[b]+"-"+a+'"']};e.hideOneCell=function(a,b){this.model.hideCells['"'+this.model.monthOfDays[b]+"-"+this.model.dayOfDays[b]+"-"+a+'"']=1};e.clientSideMetrics={};e.clientSideMetrics.selectSD="1";e.clientSideMetrics.loadSlots="2";e.clientSideMetrics.openCalendar="3";e.clientSideMetrics.selectSlot="4";e.clientSideMetrics.closeCalendar=
"5";e.clientSideMetrics.nextPageCalendar="6";e.clientSideMetrics.prevPageCalendar="7";e.clientSideMetrics.unselectSD="8";e.clientSideMetrics.selectionChanged="9";e.clientSideMetrics.initializeSDPopup="10";e.logClientSideMetrics=function(a){this.logClientSideMetricsForSlot(a,this.selectedSlot)};e.logClientSideMetricsForSlot=function(a,b){var c="",d="",e="",f="",h="",g="",n="",l="",m="",t="DP",u="",y="";if(this.model){if(this.model.parent){var D=this.model.parent.config({key:"load_payload"});D&&(c=
D.marketplace,d=D.asin,l=D.shipoption,u=D.address);this.model.parent.isSpc&&this.model.parent.isSpc()?t="SPC":(D=this.model.parent.config({key:"id_select_fn"}))&&("shipoptionselectpage"===D.substring(0,20)?t="SOSP":"emptySetSOCallback"===D&&(t="YA"))}this.model.getDefaultBaseSlot&&this.model.getDefaultBaseSlot()&&this.model.getDefaultBaseSlot().startDate&&this.model.getDefaultBaseSlot().startDate.getTime&&(e=this.model.getDefaultBaseSlot().startDate.getTime(),f=this.model.getDefaultBaseSlot().endDate.getTime());
this.model.allSlots&&this.model.allSlots.length!==q&&(y=this.model.allSlots.length.toString())}b&&(h=b.startDate.getTime(),g=b.endDate.getTime(),n=b.services,m=b.identifier);if(d instanceof Array)for(D=0;D<d.length;D++)ue.log(["mpid=",c,"&asin=",d[D],"&a=",a,"&fas=",e,"&ss=",h,"&svc=",encodeURIComponent(n),"&so=",encodeURIComponent(l),"&sid=",encodeURIComponent(m),"&page=",t,"&addr=",u,"&snum=",y,"&se=",g,"&fae=",f].join(""),"scheduled-delivery",null);else ue.log(["mpid=",c,"&asin=",d,"&a=",a,"&fas=",
e,"&ss=",h,"&svc=",encodeURIComponent(n),"&so=",encodeURIComponent(l),"&sid=",encodeURIComponent(m),"&page=",t,"&addr=",u,"&snum=",y,"&se=",g,"&fae=",f].join(""),"scheduled-delivery",null)};e.setup=function(a){function c(a,b){var d=["c_m_len","c_m_delta","n_m_len","timeslots"],k;for(k in d)if(d.hasOwnProperty(k)){if(!a.hasOwnProperty(d[k]))return["No",k,"data value"].join(" ");if(0>a[d[k]])return["Negative",k,"data value",d[k]].join(" ")}d=["next_month_id","current_month_id"];for(k in d)if(!b.config({key:d[k]}))return["No",
d[k],"configured"].join(" ")}function d(){var a=n.config({key:"element"}),a=SDFramework.jq("#"+a),c=n.getCalendarHtml();a&&a[0]&&(a[0].innerHTML=c);b()}if(!this.popupInitialized){var h=this.config({key:"linkId"}),g=SDFramework.jq("#"+h);this.popupInitialized=!0}var n=this;if(this._dom())if((h=c(a,this))&&t.console&&t.console.firebug)console.warn("Invalid data: "+h);else{a.today&&this.config({key:"today"})&&SDFramework.jq(this._dateId({id:a.today})).addClass(this.config({key:"today"}));var v=n.config({key:"element"});
H.when("jQuery","legacy-popover").execute(function(a){g.removeAmazonPopoverTrigger();g.unbind("touchend.sd");g.bind("touchend.sd",function(){this.click()});g.unbind("click.sd");g.bind("click.sd",function(){return!SDUtils.protectAgainstDoubleAction("calendarButton")});g.amazonPopoverTrigger({width:545,location:["left","bottom","right","top","centered"],locationAlign:"middle",localContent:"#"+v,title:'<span class="sd-timeslot-calendar-title">'+e.config({key:"popup_time_title"})+"</span>",modal:!0,semiStatic:!0,
onShow:f,onHide:m,draggable:!0,closeText:e.config({key:"closeText"}),closeEventInclude:["CLICK_OUTSIDE","CLICK_TRIGGER"]})});d()}};e._dateId=function(a){if(this.config({key:"prefix"})){if(a.parse)return a.parse.split("-").pop();if(a.date)return[this.config({key:"prefix"}),a.date].join("-");if(a.id){var b=this.config({key:"element"});b&&(b=["#",b," "].join(""));a=[this.config({key:"prefix"}),a.id].join("-");return b+"#"+a}}};e.add=function(a){};e.selectCalled=M("select");e.selectService=function(a,
b){this.model.setServiceType(a,b)};e.select=function(a){var b=this.config({key:"element"}),c=this.config({key:"selected"});this.config({key:"available"});this.config({key:"slotButton"});SDFramework.jq("#"+b+" ."+c).removeClass(c);a&&(SDFramework.jq("#"+a).addClass(c),this.selectCalled({arg:a}),b=!1,c="",this.selectedSlot?(c=this.selectedSlot.key,this.selectedSlot.selected=!1):b=!0,this.selectedSlot=this.model.getSlotByKey(a))&&(this.selectedSlot.selected=!0,b?this.logClientSideMetrics(this.clientSideMetrics.loadSlots):
c!==this.selectedSlot.key&&this.logClientSideMetrics(this.clientSideMetrics.selectionChanged));this.selectedSlot&&this.model.setPivotDate(this.selectedSlot.startDate)};e._canMove=function(a,b,c,d){var e=this.model.sortedSlotList(),f=e[0],e=e[e.length-1],h=new Date,g=this.config({key:"dayLength"});if(!f||!e)return!1;var n=+g/2|0;h.setUTCFullYear(2004);h.setUTCMonth(0);h.setUTCDate(1);h.setUTCFullYear(d);h.setUTCMonth(c);h.setUTCDate(b);h.setUTCHours(0,0,0,0);h.setUTCDate(h.getUTCDate()+a*g);a=new Date(h.getTime());
a.setUTCDate(a.getUTCDate()-n);a.setUTCHours(0,0,0,0);b=new Date(h.getTime());b.setUTCDate(b.getUTCDate()+n);b.setUTCHours(23,59,59,999);return b<new Date||b<f.endDate||a>e.startDate?!1:!0};e.navigateLateralSlots=function(a,c,d,e){if(this._canMove(a,c,d,e)){var f=SDFramework.jq("#"+this.config({key:"element"})),h=new Date,g=this.config({key:"dayLength"});h.setUTCFullYear(2004);h.setUTCMonth(0);h.setUTCDate(1);h.setUTCFullYear(e);h.setUTCMonth(d);h.setUTCDate(c);h.setUTCHours(0,0,0,0);h.setUTCDate(h.getUTCDate()+
a*g);this.model.setPivotDate(h);this.model.slotsInRange();c=this.getCalendarHtml();f.html(c);b();f=-1===a?this.clientSideMetrics.prevPageCalendar:this.clientSideMetrics.nextPageCalendar;0!==a&&this.logClientSideMetrics(f);return c}};return e}function ba(){function a(a,b,c,d){var e=SDUtils.isBeacon(a);c?e&&0<b?a.slideDown(b):a.show():e&&0<b?a.slideUp(b):a.hide();a=a.parents(".sd_widget_root").find(".sd_controls");d?a.show():a.hide()}function c(a,b){a.each(function(){r(this).amazonPopoverTrigger({location:["right",
"auto"],locationAlign:"top",locationMargin:-10,width:null,skin:null,hoverHideDelay:0,hoverShowDelay:0,showOnHover:!0,showCloseButton:!1,literalContent:b})})}function d(a){a.css("cursor","not-allowed");a.addClass("sd-disabled")}function b(a){a.css("cursor","");a.removeClass("sd-disabled")}function g(a,b){var c={noSlotNotSure:r("#"+a.config({key:"dom_noslotsNotSure"})),noSlotUnknown:r("#"+a.config({key:"dom_noslotsUnknown"})),ineligibleZip:r("#"+a.config({key:"dom_slotsContent"})),slotsContent:r("#"+
a.config({key:"dom_slotsContent"}))},d;for(d in c)d===b?c[d].show():c[d].hide()}function h(k,f,h){if(k.config({key:"hideWidgetOnError"})){var n=h?h.slotQualityInfo:null;h=n?n.slotQualityDetail:"";n=n?n.errorCode:"";f||(h="NORMAL");f="noSlotUnknown";switch(h){case "SYSTEM_UNKNOWN_PROMISE":f="noSlotUnknown";"JurisdictionNotFound"===n&&(f="slotsContent");break;case "BUSINESS_UNKNOWN_PROMISE":case "CAPACITY_FULL":f="noSlotUnknown";break;case "SD_INVENTORY_STATE_RESTRICTED":f="noSlotNotSure";break;case "NORMAL":f=
"slotsContent"}g(k,f);f={JurisdictionNotFound:r("#"+k.config({key:"dom_zipEntError"}))};for(var m in f)m===n?f[m].show():f[m].hide();e(k,"NORMAL"===h)}else{if("ATVPDKIKX0DER"==k.config({key:"load_payload"}).marketplace&&f){switch(h.slotQualityInfo.slotQualityDetail){case "CAPACITY_FULL":m=".sd_call_date_msg";break;case "SD_INVENTORY_STATE_RESTRICTED":m=".sd_estimate_msg";break;default:m=".sd_no_promise_msg"}r(".sd_phone_number").css("position","static");m=r(m).html();0!==r(".sd_change_phone_number").length&&
(m+=r(".sd_change_phone_number").html())}else m=h?h.errorMsg:"";var n=k.config({key:"dom_noslots"}),n=r("#"+n),q=k.config({key:"dom_reload"}),q=r("#"+q),A=k.config({key:"message_hook"}),l=r("#calendarLink"+k.popup.__config.widgetIndex),x;A&&0<A.length&&(x=A.add(l).add("#sd_dummy_click_div_"+k.popup.__config.widgetIndex));f?(x?(f=x,c(f,'<div class="sdWarn"><span class="swSprite s_alertSm"></span>'+m+"</div>"),d(f)):(m&&(f=n.find("div.sd_err_from_result_content"),f.html(m),SDUtils.isBeacon(n)&&(f=f.find("h6"),
f.contents().replaceAll(f).wrap("<h4/>"))),a(n,300,!0,!1),d(l)),q.show(),k.disableAndDeselect(h)):(x?(f=x,f.removeAmazonPopoverTrigger(),b(f)):b(l),a(n,0,!1,!0),q.hide(),k=r("#"+k.config({key:"dom_widget_root"})).parents("td").eq(0).prev().find("input[type=radio]"),k.removeAttr("disabled"),k.parents("div.fake-label.a-box").removeClass("sd-disabled"))}}function f(a){if(a.isSpc()){var b=a.config({key:"dom_widget_root"});a=a.config({key:"dom_no_widget_root"});r("#"+b+" .sd_widget").show();r("#"+b).show();
r("#"+a).hide()}}function m(a){if(a.isSpc()){var b=a.config({key:"id_is_selected"}),c=a.config({key:"dom_widget_root"});a=a.config({key:"dom_no_widget_root"});b?(r("#"+c+" .sd_widget").show(),r("#"+c).show(),r("#"+a).hide()):(r("#"+c+" .sd_widget").show(),r("#"+c).hide(),r("#"+a).show())}}function n(a,b){var c=new ScheduledDelivery.Data.ReservationIdParser(a),d=new ScheduledDelivery.Data.ReservationIdParser(b),k=c.getCharges(),e=d.getCharges();return k.currencyCode===e.currencyCode&&.01>Math.abs(e.perItem-
k.perItem)&&.01>Math.abs(e.perShipment-k.perShipment)&&c.getEncodedServices()===d.getEncodedServices()}function e(a,b){var c=r("#"+a.config({key:"dom_slotTrigger"}));c.prop?c.prop("disabled",!b):b?c.removeAttr("disabled"):c.attr("disabled","disabled");b?c.parents(".sd-button").removeClass("sd-button-disabled"):c.parents(".sd-button").addClass("sd-button-disabled")}var r=SDFramework.jq,k={};k.icon=z("icon");k.config=z("config");k.calData=Y(this);k.popup={};k.popup.config=z("config");k.popup.selectCalled=
M("select");k.dropdown=X();k.active=q;k.enableInconsistentWithBuybox=function(b){var c=this.config({key:"dom_inconsistent"});a(r("#"+c),200,b,!0)};k.buyboxNoAddrMessage=function(){g(this,"noSlotUnknown")};k.isSpc=function(){var a=this.config({key:"id_select_fn"});return a&&"spcpage"===a.substring(0,7)};k.isSosp=function(){var a=this.config({key:"id_select_fn"});return a&&"shipoptionselectpage"===a.substring(0,20)};k.isSpcSd=function(){if(this.isSpc()){var a=this.config({key:"message_hook"});return a&&
0<a.length&&0<=a.attr("src").indexOf("radio-on")}return!1};k.spcThrowCvIfSelected=function(){if(this.isSpcSd()){y("#"+this.config({key:"dom_widget_root"})+" input[type=hidden]").attr("value","");var a=this.config({key:"id_select_fn"});(a=a&&eval(a))&&a({},this.config({key:"dom_widget_root"}))}};k.handleNoSlotSelection=function(){if(this.isSosp()){var a=this.config({key:"dom_widget_root"}),a=SDFramework.jq("#"+a);a.find(".sd_change_phone_number").show();a.find(".sd_promises").show();a.find(".sd_promise_msg").show();
a.find(".sd_promise_msg >span").addClass("sd_no_slot_selection_msg")}};k.calendar=function(a){if(a)if(this.calData.hasCal(a)){this._loading(!1);this._enableIcon(!0);e(this,!0);var b=this.config({key:"dom_retry"}),c=this;r("#"+b).click(function(){g(c,"slotsContent")});b=null;if(!this.active||this.active!=a){var d=this.calData.getCal(a),v=this.popup.__config,q=this.popup.__selectFn;if(d&&d.days&&0!==d.days.length)h(this,!1),m(this);else{this.logClientSideMetricsForNoSlots(k.clientSideMetrics.initializeSDPopup);
f(this);h(this,!0,d);this.deactivateCalendar();this.active=0;this.spcThrowCvIfSelected();return}var A=this.config({key:"timeslotDeterminationFn"});if(A&&A(d)){this.popup=aa(this);this.popup.__config=v;this.popup.__selectFn=q;H.when("scheduledDelivery","ready").execute(k.getDocLoadFn());this.popup.showDropdown=this.showDropdown;this.popup.model.orderDayAsFirstDay=this.orderDayAsFirstDay;this.popup.model.setSlots(this.calData,a);this.popup.logClientSideMetrics(this.popup.clientSideMetrics.initializeSDPopup);
b=this.popup.model.getSlotByTimes(this.config({key:"selectedStart"}),this.config({key:"selectedEnd"}),this.config({key:"selectedSlot"}));!b&&this.config({key:"selectedStart"})&&this.config({key:"selectedEnd"})?(this.enableInconsistentWithBuybox(!0),b=this.popup.model.getDefaultSlot(this.daySlotAsDefaultSlot),this.spcThrowCvIfSelected()):b?this.enableInconsistentWithBuybox(!1):b=this.popup.model.getDefaultSlot(this.daySlotAsDefaultSlot);var l=r("#sd_dummy_click_div_"+v.widgetIndex);l&&0<l.length&&
l.click(function(a){var b=y("#sd_widgets_"+v.widgetIndex).parents("td").eq(0).prev().find("input[type=image]");b&&0<b.length&&b.click();a.stopPropagation()})}else{this.popup=W();this.popup.__config=v;this.popup.__selectFn=q;d=this.calData.getCal(a).ids;q=this.config({key:"selectedStart"});A=this.config({key:"selectedEnd"});for(l in d)if(d[l].hasOwnProperty("s")&&d[l].hasOwnProperty("e")){var x=d[l].s,t=d[l].e,u=d[l].eu;d[l].su==q&&u==A&&(b||(b=O(null,null,null,d[l],l)));x==q&&t==A&&(b||(b=O(null,
null,null,d[l],l)))}b?this.enableInconsistentWithBuybox(!1):(this.enableInconsistentWithBuybox(!0),this.spcThrowCvIfSelected());r(document).ready(k.getDocLoadFn())}this.active=a;this._changeCalendar()}this.dropdown&&this.dropdown.hasOwnProperty("enable")&&this.dropdown.enable(!0);this.popup&&this.popup.hasOwnProperty("enable")&&this.popup.enable(!0);b?(this.isSpcSd()&&!n(b.identifier,this.config({key:"selectedSlot"}))&&this.config({key:"existing",value:"populating this field here will force a resubmit on the following call"}),
this.popup.select(b.key),this.dropdown&&(this.dropdown.select(b.key),this.dropdown.selectCalled({arg:b.key}),this.dropdown._dom().change(function(){}))):this.handleNoSlotSelection()}else this._loadCalendar(a);else this.deactivateCalendar()};k.deactivateCalendar=function(){this._enableIcon(!1);e(this,!1);this.dropdown&&this.dropdown.hasOwnProperty("enable")&&this.dropdown.enable(!1);this.popup&&this.popup.hasOwnProperty("enable")&&this.popup.enable(!1);var a=this.config({key:"clientCallbacks"});a&&
a.calendarDisabled&&a.calendarDisabled()};k._changeCalendar=function(){function a(b){return{id:b[0],name:b[1]}}var b=this.calData.getCal(this.active);this.popup&&this.popup.setup(b);this.dropdown&&this.dropdown.clear();if(b&&b.days){var c=this.config({key:"timeslotDeterminationFn"});if(c&&c(b)){var b=this.popup.model.sortedSlotList(),d;for(d in b)if(d){var k=b[d];this.popup&&this.popup.add(k.key);this.dropdown&&this.dropdown.add(k.key,k.toString(),k.services,k.startDateUTC,k.endDateUTC)}}else for(k in b.days)b.days.hasOwnProperty(k)&&
(d=a(b.days[k]),this.popup&&this.popup.add(d.id),this.dropdown&&this.dropdown.add(d.id,d.name,""));this.dropdown&&(this.dropdown.make(),this.dropdown.onSelect());if(this.popup)this.popup.onSelect();d=function(a){};b=function(a){};this.dropdown&&(d=function(a){var b=a.dropdown;return function(a){b.select(a)}});this.popup&&(b=function(a){var b=a.popup;return function(a){b.select(a)}});if(this.dropdown||this.popup){this.popup.selectCalled({register:"dropdown",fn:d(this)});this.dropdown&&this.dropdown.selectCalled({register:"popup",
fn:b(this)});var e=this;d=function(a){if(a&&e.config({key:"existing"})&&e.config({key:"existing"})!=a){e.config({key:"existing",value:a});a=e.config({key:"id_select_fn"});var b={};y("#"+e.config({key:"dom_widget_root"})+" input[type=hidden]").each(function(){var a=y(this).attr("key"),c=y(this).attr("value");a&&(b[a]=c)});var c;a&&(c=eval(a));a=e.config({key:"dom_widget_root"});c&&c(b,a)}else e.config({key:"existing",value:a})};t.$&&this.config({key:"message_hook"})&&$(this.config({key:"message_hook"}).get(0)).unbind("click");
(b=this.config({key:"message_hook"}))&&0<b.length&&-1==b.attr("src").indexOf("radio-on")&&b.bind("click",d);this.popup&&this.popup.selectCalled({register:"rcxCallback",fn:d});this.dropdown&&this.dropdown.selectCalled({register:"rcxCallback",fn:d})}}else t.console&&t.console.firebug&&console.warn("no calendar data"),this.deactivateCalendar()};k.selectCalled=function(a){this.dropdown&&this.dropdown.selectCalled(a);this.popup&&this.popup.selectCalled&&this.popup.selectCalled(a)};k.hasRes=function(a,
b){return this.calData.hasRes(a,b)};k.getRes=function(a,b){return this.calData.getRes(a,b)};k._loadCalendar=function(a){this.calData.hasCal(a)&&this.calendar(a);this.calData.load(a,this)};k._enableIcon=function(a){var b=this.icon({key:"dom_disabled"}),c=this.icon({key:"dom_enabled"});b?(b=r(b),a?b.hide():b.show()):t.console&&t.console.firebug&&console.warn("no disabled calendar icon configured");c?(c=r(c),a?c.show():c.hide()):t.console&&t.console.firebug&&console.warn("no active calendar icon configured")};
k._getConfigDOM=function(a){a=this.config({key:a});return r(a?"#"+a:[])};k.disableAndDeselect=function(a){var b=r("#"+this.config({key:"dom_widget_root"})).parents("td").eq(0).prev().find("input:radio"),c=r("input[name='csm.scheduledDelivery']");(0===c.length||1<r("input[name="+b.attr("name")+"]:radio:not(:disabled)").length)&&"ATVPDKIKX0DER"!=this.config({key:"load_payload"}).marketplace?(b.attr("disabled","disabled"),b.is(":checked")&&r("input[name="+b.attr("name")+"]:radio:not(:disabled):first").attr("checked",
!0)):(a=a?a.defaultDates:{ultStart:2E5,ultEnd:200001,timeZone:"PST",minShip:1,maxShip:2},c.attr("value",encodeURIComponent(ScheduledDelivery.Data.Json.serialize({refdataVersion:"AFN",slot:{reservationId:"X",start:a.ultStart,mltStart:a.ultStart,end:a.ultEnd,mltEnd:a.ultEnd,timeZone:a.timeZone,tz:"America/Los_Angeles",minShip:a.minShip,maxShip:a.maxShip,fss:"NOT_FAST_TRACK"},qualityInfo:{slotQuality:"DEFERRED",slotQualityDetail:"BUSINESS_UNKNOWN_PROMISE"}}))));b.parents("div.fake-label.a-box").addClass("sd-disabled")};
k._loading=function(b,c){var d=this._getConfigDOM("dom_loadbar"),k=this._getConfigDOM("dom_reload"),e=this._getConfigDOM("dom_failbar"),f=this._getConfigDOM("dom_bar");b?(f.hide(),a(e,100,!1,!1),k.hide(),d.show()):c?(d.hide(),f.hide(),a(e,100,!0,!1),k.show(),this.disableAndDeselect()):(d.hide(),a(e,100,!1,!0),k.hide(),f.show())};k.getDocLoadFn=function(){var a=this;return function(){var b=a.icon({key:"dom_enabled"});b&&(b=r(b),a.popup.hasOwnProperty("click")&&b.click(a.popup.click()))}};k.clientSideMetrics=
{};k.clientSideMetrics.initializeSDPopup="10";k.logClientSideMetricsForNoSlots=function(a){var b="",c="",d="",k="DP",e="",f=this.config({key:"load_payload"});f&&(b=f.marketplace,c=f.asin,d=f.shipoption,e=f.address);this.isSpc()?k="SPC":(f=this.config({key:"id_select_fn"}))&&("shipoptionselectpage"===f.substring(0,20)?k="SOSP":"emptySetSOCallback"===f?k="YA":"emptyORCSetSOCallback"===f&&(k="ORC"));if(c instanceof Array)for(f=0;f<c.length;f++)ue.log(["mpid=",b,"&asin=",c[f],"&a=",a,"&fas=&ss=&svc=&so=",
encodeURIComponent(d),"&sid=&page=",k,"&addr=",e,"&snum=0&se=&fae="].join(""),"scheduled-delivery",null);else ue.log(["mpid=",b,"&asin=",c,"&a=",a,"&fas=&ss=&svc=&so=",encodeURIComponent(d),"&sid=&page=",k,"&addr=",e,"&snum=0&se=&fae="].join(""),"scheduled-delivery",null)};r(document).ready(k.getDocLoadFn());return k}function B(a){B.prototype.months=[a.strings["assoc-january_5173"],a.strings["assoc-february_5174"],a.strings["assoc-march_5175"],a.strings["assoc-april_5176"],a.strings["assoc-may_5177"],
a.strings["assoc-june_5178"],a.strings["assoc-july_5179"],a.strings["assoc-august_5180"],a.strings["assoc-september_5181"],a.strings["assoc-october_5182"],a.strings["assoc-november_5183"],a.strings["assoc-december_5184"]];B.prototype.days=[a.strings.sd_sunday_short,a.strings.sd_monday_short,a.strings.sd_tuesday_short,a.strings.sd_wednesday_short,a.strings.sd_thursday_short,a.strings.sd_friday_short,a.strings.sd_saturday_short];B.prototype.weekdays=[a.strings.sd_sunday,a.strings.sd_monday,a.strings.sd_tuesday,
a.strings.sd_wednesday,a.strings.sd_thursday,a.strings.sd_friday,a.strings.sd_saturday];B.prototype.monthShort=[a.strings.sd_january_abbrev,a.strings.sd_february_abbrev,a.strings.sd_march_abbrev,a.strings.sd_april_abbrev,a.strings.sd_may_abbrev,a.strings.sd_june_abbrev,a.strings.sd_july_abbrev,a.strings.sd_august_abbrev,a.strings.sd_september_abbrev,a.strings.sd_october_abbrev,a.strings.sd_november_abbrev,a.strings.sd_december_abbrev];97==a.locale_date?(B.prototype.textDateFn=function(a){return a.getUTCFullYear()+
" "+this.months[a.getUTCMonth()].substr(0,3)+" "+a.getUTCDate()},B.prototype.displayDateFn=function(a){return this.weekdays[a.getUTCDay()]+", "+a.getUTCFullYear()+" "+this.months[a.getUTCMonth()]+" "+a.getUTCDate()}):15==a.locale_date?(B.prototype.textDateFn=function(a){return a.getUTCDate()+" "+this.months[a.getUTCMonth()].substr(0,3)+" "+a.getUTCFullYear()},B.prototype.displayDateFn=function(a){return this.weekdays[a.getUTCDay()]+", "+a.getUTCDate()+" "+this.months[a.getUTCMonth()]+" "+a.getUTCFullYear()}):
(B.prototype.textDateFn=function(a){return this.months[a.getUTCMonth()].substr(0,3)+" "+a.getUTCDate()+", "+a.getUTCFullYear()},B.prototype.displayDateFn=function(a){return this.weekdays[a.getUTCDay()]+", "+this.months[a.getUTCMonth()]+" "+a.getUTCDate()+", "+a.getUTCFullYear()});B.prototype.slotDisplayDateFn=function(a){var d;if(a){var b=a.getUTCHours();a.getUTCMinutes();d=11<b?"pm":"am";b%=12;b=0===b?12:b;d=b+d}else d=null;return d+" "+this.displayDateFn(a)}}function Q(a){function c(b){if(!b||!b.message)return{};
if(b=b.message)f?b.config({data:{str_date:a.strings.sd_install_order_date,str_slot:a.strings.sd_install_order_time}}):(b.config({data:{str_date:a.strings.sd_delivery_order_date,str_slot:a.strings.sd_delivery_order_time,sd_item_delivery_message:a.strings.sd_item_delivery_message,sd_item_delivery_message_without_time:a.strings.sd_item_delivery_message_without_time,sd_item_delivery_service_message:a.strings.sd_item_delivery_service_message,sd_installation:a.strings.sd_installation,sd_recycling:a.strings.sd_recycling,
sd_haulaway:a.strings.sd_haulaway,sd_today:a.strings.sd_today,sd_tomorrow:a.strings.sd_tomorrow}}),a.strings.sd_for_these_items_range?b.config({key:"str_slot_message",value:a.strings.sd_for_these_items_range}):b.config({key:"str_slot_message",value:a.strings.sd_for_this_item_range}));return b}function d(b){if(b){var c=b.dropdown;c&&(c.config({key:"str_select",value:a.strings.select_date_34088}),a.buybox?c.config({key:"str_disable",value:a.strings.sd_select_postal_code}):c.config({key:"str_disable",
value:a.strings.sd_select_option}));if(c=b.popup)c.config({key:"sd_today",value:a.strings.sd_today}),c.config({key:"not_available_key",value:a.strings.sd_capacity_notavailable_52061}),c.config({key:"available_key",value:a.strings.sd_capacity_available_52060}),c.config({key:"promotion_available_key",value:a.strings.sd_capacity_promotion_available}),c.config({key:"selected_key",value:a.strings.sd_selected}),c.config({key:"no_slots_for_week",value:a.strings.sd_no_slots_for_week}),c.config({key:"sd_checkout_spc_service_list",
value:a.strings.sd_checkout_spc_service_list}),f?(c.config({key:"popup_time_title",value:a.strings.sd_select_install_time}),c.config({key:"popup_date_title",value:a.strings.sd_select_install_date})):(c.config({key:"popup_time_title",value:a.strings.sd_select_delivery_time}),c.config({key:"popup_date_title",value:a.strings.sd_select_delivery_date})),c.config({key:"strings",value:a.strings}),c.config({key:"surcharge_message",value:"MFN2013"===a.sdUseCase&&a.strings.sd_surcharge_notice_mfn||a.strings.sd_surcharge_notice_afn||
a.strings.sd_surcharge_notice});a.buybox?b.config({key:"pickDateText",value:a.strings.sd_select_postal_code}):b.config({key:"pickDateText",value:a.strings.sd_select_option});0===b.config({key:"showDropdown"})&&(b.config({key:"sd_item_delivery_message",value:a.strings.sd_item_delivery_message}),b.config({key:"sd_item_delivery_message_without_time",value:a.strings.sd_item_delivery_message_without_time}));b.config({key:"learnMoreText",value:a.strings.sd_learn_more});b.config({key:"reloadText",value:a.strings.sd_reload});
f?(b.config({key:"noSlotsAddress",value:a.strings.sd_no_installation_times}),b.config({key:"retrieveError",value:a.strings.sd_install_retrieve_error}),-1===a.merchantType.indexOf("Local")?b.config({key:"noSlotsAddressBB",value:a.strings.sd_install_no_scheduled_error}):b.config({key:"noSlotsAddressBB",value:a.strings.sd_installation_not_available_for_zipcode})):(b.config({key:"noSlotsAddress",value:a.strings.sd_no_delivery_times}),b.config({key:"retrieveError",value:a.strings.sd_delivery_retrieve_error}),
b.config({key:"noSlotsAddressBB",value:a.strings.sd_delivery_no_scheduled_error}));b.config({key:"inconsistentWithBuybox",value:a.strings.sd_previous_slot_not_available});b.config({key:"tryAgain",value:a.strings.sd_try_again});b.config({key:"sd_select_another_date_and_time",value:a.strings.sd_select_another_date_and_time})}}function b(a,b){a&&(a.config({data:{day:b.strings.day_33013,days:b.strings.days_30885,hour:b.strings.hour_33014,hours:b.strings.hours_30886,min:b.strings.minute_33015,mins:b.strings.minutes_30887,
str_missed:"The time to place this order has passed.",str_gen_before:"Order within the next "}}),f?a.config({key:"str_gen_after",value:"to guarantee installation date."}):a.config({key:"str_gen_after",value:"to guarantee delivery date."}))}function g(a,b){a&&a.config({data:{str_noRegions:b.strings.sd_no_regions,str_selectRegion:b.strings.sd_select_region_37475}})}function h(a,b){a&&("ATVPDKIKX0DER"==b.marketplaceID||"A1PA6795UKMFR9"==b.marketplaceID||"A13V1IB3VIYZZH"==b.marketplaceID?a.config({key:"postal_format",
value:/^\d{5}$/}):"A1F83G8C2ARO7P"==b.marketplaceID?a.config({key:"postal_format",value:/^[a-zA-Z]{1,2}[0-9rR][0-9a-zA-Z]? [0-9][abd-hjlnp-uw-zABD-HJLNP-UW-Z]{2}$/}):"A1VC38T7YXB528"==b.marketplaceID&&a.config({key:"postal_format",value:/^\d{3}-?\d{4}$/}),a.config({data:{str_length_error:b.strings.sd_zip_format_error,str_enter_error:b.strings.sd_postal_required_error,str_enter:b.strings.sd_enter_postal_code}}))}var f=a.merchantType&&-1!==a.merchantType.indexOf("Installation");if(a){var m=a.calendar,
n=a.checkout,e=a.buybox,n=a.shipoption||n||e,r=new B(a);m&&(m.dateDisplay=r,m.config({key:"dateDisplay",value:r}),m.popup.config({key:"months",value:r.months}),m.popup.config({key:"days",value:r.days}),r=a.strings.sd_popover_close,r&&""!==r||(r=a.strings.click_close_5690),m.popup.config({key:"closeText",value:r}));c(n).dateDisplay=new B(a);d(m);e&&(m=e.config,f?m({data:{str_select_date:a.strings.sd_select_install_date}}):m({data:{str_select_date:a.strings.sd_select_delivery_date}}),b(e.cutoff,a),
g(e.regions,a),h(e.zipcode,a))}}function K(a,c,d,b,g,h){c=c?c:{};this.UISettings=b=b?b:{};this.domSettings=g;this.dataField=h;this.UISettings.showDropdown=this.UISettings.showDropdown!==q&&0===this.UISettings.showDropdown?0:1;this.UISettings.orderDayAsFirstDay=this.UISettings.orderDayAsFirstDay!==q&&1===this.UISettings.orderDayAsFirstDay?1:0;this.UISettings.daySlotAsDefaultSlot=this.UISettings.daySlotAsDefaultSlot!==q&&1===this.UISettings.daySlotAsDefaultSlot?1:0;this.calendarRef=ba();this.widgetIndex=
a;this.calendarRef.orderDayAsFirstDay=this.UISettings.orderDayAsFirstDay;this.calendarRef.daySlotAsDefaultSlot=this.UISettings.daySlotAsDefaultSlot;this.calendarRef.showDropdown=this.UISettings.showDropdown;K.prototype.isTimeslot=function(a){if(!a||!a.hasOwnProperty("ids"))return!1;if("MFN2013"===b.sdUseCase)return!0;var c=0,d;for(d in a.ids)if(a.ids.hasOwnProperty(d)&&a.ids[d]){var e=a.ids[d];if(e.hasOwnProperty("e")&&e.hasOwnProperty("s")&&23>(e.e-e.s)/3600){c=1;break}}return c||a.timeslots};this.calendarRef.config({key:"dateDisplay",
value:this.dateDisplay});this.calendarRef.config({data:{id_merchant:"A1",id_marketplace:"M1",timeslotDeterminationFn:this.isTimeslot}});1===this.UISettings.showDropdown?this.calendarRef.dropdown.config({key:"element",value:"sduiDropdown"+a}):this.calendarRef.dropdown=null;this.calendarRef.popup.config({data:{element:"sdcal-popup"+a,current_month_id:"sdcal-curr-month",next_month_id:"sdcal-next-month",notaday:"sdcal-notaday",day:"sdcal-day",notavailable:"sdcal-noavail",available:"sdcal-avail",promotionavailable:"sdcal-promavail",
selected:"sdcal-select",today:"sdcal-today",prefix:"sdcal",closeText:"close",slotButton:"sd-timeslot-slot",daySpan:"1",dayLength:7,linkId:g?g.widgetRoot+" ."+g.calendarTrigger:"calendarLink"+a,rootWidgetId:g?g.widgetRoot:"sd_widgets_"+a,widgetIndex:a,leftNavEnabledClass:"sd-timeslot-scroll-title-left-enabled",leftNavEnabledInner:"&#8249;&#8249;",leftNavDisabledClass:"sd-timeslot-scroll-title-left-disabled",leftNavDisabledInner:"&#8249;&#8249;",rightNavEnabledClass:"sd-timeslot-scroll-title-right-enabled",
rightNavEnabledInner:"&#8250;&#8250;",rightNavDisabledClass:"sd-timeslot-scroll-title-right-disabled",rightNavDisabledInner:"&#8250;&#8250;"}},1);this.calendarRef.config({key:"selectedSlot",value:c.reservationId});this.calendarRef.config({key:"selectedStart",value:c.ultStart});this.calendarRef.config({key:"selectedEnd",value:c.ultEnd});this.calendarRef.config({key:"showDropdown",value:this.UISettings.showDropdown})}function ca(a,c,d,b){function g(a){function b(a){var c=["custom-value"];a=SDFramework.jq("input[value='"+
a+"']");0<a.length?(a=a.attr("name").match(/\.\d+\.\d+/),c.push(a[0])):c=[];return c.join("")}a&&a.setMappings({reservationId:[b("SD-ResID")||"custom-value.1.1"],mltStart:[b("SD-StartTime")||"custom-value.1.2"],mltEnd:[b("SD-EndTime")||"custom-value.1.3"],mltCutoff:[b("SD-CutoffTime")||"custom-value.1.5"],timeZone:[b("SD-WindowTZ")||"custom-value.1.4",b("SD-CutoffTZ")||"custom-value.1.6"],minShip:[b("SD-MinShipDtUTC")||"custom-value.1.11"],maxShip:[b("SD-MaxShipDtUTC")||"custom-value.1.10"],shipOffer:[b("SD-ShipOfferID")||
"custom-value.1.9"],fss:[b("SD-PromiseLFSS")||"custom-value.1.12"],data:[b("SD-Data")||"custom-value.1.13"],reservationType:[b("SD-ResType")],start:[b("SD-SlotStartLTZ")],end:[b("SD-SlotEndLTZ")],tz:[b("SD-SlotLongTZ")]})}function h(a,b,c){return a&&b&&c?(a.config({key:b,value:c}),!0):!1}function f(a){a.calendarRef.config({key:"clientCallbacks",value:{calendarDisabled:function(){if(a.bbSDUI)a.bbSDUI.onCalendarUnselected()}}})}function m(a){if(this.bbSDUI=T(a.dom)){if(a.zipcode){var b=a.dom,c=this.bbSDUI,
d=a.zipcode;c&&(c.zipcode=S({data:{dom_zipInput:"undefined"===typeof b?"sd_zipcode":b.widgetRoot+" ."+b.postalInput,dom_zipGo:"sd_zipcode_go",dom_zipEntError:"undefined"===typeof b?"sd_zipcode_enter_err":b.widgetRoot+" ."+b.ineligiblePostal,dom_zipValError:"undefined"===typeof b?"sd_zipcode_valid_err":b.widgetRoot+" ."+b.invalidPostal,dom_zipDefaultClass:"undefined"===typeof b?"":b.postalDefault,dom_zipOverdisplay:"undefined"===typeof b?"":b.widgetRoot+" ."+b.postalOverdisplay,dom_zipLabel:"undefined"===
typeof b?"":b.widgetRoot+" ."+b.postalLabel,dom_zipValue:"undefined"===typeof b?"":b.widgetRoot+" ."+b.postalValue,dom_zipEmpty:"undefined"===typeof b?"":b.widgetRoot+" ."+b.postalEmpty,dom_zipPrefix:"undefined"===typeof b?"":b.widgetRoot+" ."+b.postalPrefix}},d,1))}else(b=this.bbSDUI)&&(b.regions=R({data:{dom_regionList:"sd_region",dom_regionLoading:"sd_region_loading"}}));this.itemCache=new SDUtils.Cache(n);(b=this.bbSDUI)&&a&&(b.config({data:{dom_mainElement:a.dom?a.dom.widgetRoot+" ."+a.dom.content:
"sd_divUI",dom_notSureError:a.dom?a.dom.widgetRoot+" ."+a.dom.notSureError:"",dom_unknownError:a.dom?a.dom.widgetRoot+" ."+a.dom.unknownError:"",dom_zipInput:a.dom?a.dom.widgetRoot+" ."+a.dom.postalInput:null,dom_loading:"sd_region_loading"}}),h(b.checkbox,"dom_sdCheckbox",a.dom?a.dom.widgetRoot+" ."+a.dom.enabled:"sd_intent"),a.isAFN&&(h(b,"isAFN",a.isAFN),a.addressId&&0<a.addressId.length&&h(b,"id_address",a.addressId)),h(b,"id_merchant",a.merchantID),h(b,"id_marketplace",a.marketplaceID),h(b,"id_asin",
a.asinID),h(b,"id_sku",a.msku),h(b,"id_fmid",a.fmID),h(b,"id_quantity",a.quantity),h(b,"id_offerlist_id",a.offerListingID),a.shipoption&&h(b,"shipoption",a.shipoption));g(this.bbSDUI.inputs);b=this.bbSDUI.shoppingCart;h(b,"disabledHTML",a.cartDisabledHTML);h(b,"element","#addToCartSpan, #twisterAddToCartOrig");h(b,"cursorDisabled","not-allowed");h(this.bbSDUI.oneClick,"element","#oneClickSingleClick, .oneClickDiv b, #oneClickDivId");(b=this.bbSDUI.cutoff)&&b.config({data:{element:"sd_cutoff_div",
fail:"sd_cutoff_missed_div",dom_replace:"sd_cutoff"}});a=a.dom;if(!this.calendarRef.config({key:"showDropdown"})){b=this.bbSDUI;b.initMessage();var c="sd_widgets_BB .sdMessage_buybox p",d="sd_widgets_BB .sdMessage_buybox",e="sd_widgets_BB .sdMessage_service_buybox p";a&&(c=a.widgetRoot+" ."+a.slotDisplay,d=a.widgetRoot+" ."+a.slotDisplayContainer,e=a.widgetRoot+" ."+a.serviceDisplay);b.message&&b.message.config({data:{element:c,element_container:d,element_service:e,timeslotDeterminationFn:this.isTimeslot}})}f(this)}else u.warn("SD CFG BB noUI")}
var n=["asin","merchantID","sku","fmid"],e=["asin","merchantID","heavyBulky","sku","fmid"];d=1;b&&b.sdShowDropdown!==q&&(d=b.sdShowDropdown?1:0);m.prototype=new K("BB",null,c,{showDropdown:d},a.dom);m.prototype.injectDom=function(a,b,c,d,e){this.currentSD=a;c=this.calendarRef.config({key:"pickDateText"});this.calendarRef.config({key:"learnMoreText"});var f=this.calendarRef.config({key:"noSlotsAddressBB"}),h=this.calendarRef.config({key:"retrieveError"});this.calendarRef.config({key:"tryAgain"});var g=
this.calendarRef.config({key:"showDropdown"}),r=SDFramework.jq("#sd_widgets_"+a),n=[];n.push('<span class="sd_Loading" style="display: none;">');n.push("<p>");n.push(b);n.push("</p>");n.push("</span>");1===g?(n.push('<div class="sdMessage_buybox" style="display: none;"></div>'),n.push('<div class="sdMessage_buybox" style="display: none;"><span class="swSprite s_notifySm"></span><p></p></div>')):(n.push('<div class="sdMessage_buybox" style="display: none;"><p></p></div>'),n.push('<div class="sdMessage_service_buybox" style="display: none;"><p></p></div>'));
n.push('<span class="sd_widget" style="display: none">');1===g?(n.push('<span class="sd_Active">'),n.push('<select id="sduiDropdown',a,'" class="sdbuybox" name="sduiDate" disabled >'),n.push('<option value="" selected>',c,"</option>"),n.push("</select>"),n.push("</span>"),n.push('<span class="sd_calicon sd_calicon_disabled">'),n.push(d),n.push("</span>"),n.push('<a href="#" id="calendarLink',a,'" onclick="return false;">'),n.push('<span class="sd_calicon sd_calicon_enabled" style="display: none;">'),
n.push(e)):(n.push('<span class="sd_calicon sd_calicon_disabled">'),n.push(d),n.push("</span>"),n.push('<a href="#" id="calendarLink',a,'" onclick="return false;">'),n.push('<span class="sd_calicon sd_calicon_enabled" style="display: none;">'),n.push(e),n.push(this.calendarRef.config({key:"sd_select_another_date_and_time"})));n.push("</span>");n.push("</a>");n.push("</span>");n.push('<div class="sd_err_noslots" style="display: none;">');n.push('<span id="sd_bb_no_slots_message" style="color: #ff0000; font-weight: bold;">',
f,"</span>");n.push("</div>");n.push('<div class="sd_err_connect" style="display: none;">');n.push('<span id="sd_bb_retrieve_error" style="color: #ff0000; font-weight: bold;">',h,"</span>");n.push("</div>");n.push('<div id="sdcal-popup',a,'" class="sdCalendarPopover" style="display: none"></div>');r.prepend(n.join(""))};m.prototype.establishDomHooks=function(b){var c=this.currentSD;h(this.bbSDUI,"sd_calendar",this.calendarRef);var d=this.calendarRef;d.icon({key:"dom_disabled",value:".sd_calicon_disabled"});
d.icon({key:"dom_enabled",value:".sd_calicon_enabled"});h(d,"dom_bar","sd_widgets_"+c+" .sd_calendar");h(d,"dom_failbar","sd_widgets_"+c+" .sd_err_connect");h(d,"dom_noslots","sd_widgets_"+c+" .sd_err_noslots");h(d,"dom_loadbar","sd_widgets_"+c+" .sd_Loading");"undefined"!==typeof b&&(h(d,"dom_bar",b.widgetRoot+" ."+b.content),h(d,"dom_noslots",b.widgetRoot+" ."+b.notSureError),h(d,"dom_loadbar",b.widgetRoot+" ."+b.loading),h(d,"hideWidgetOnError",1),h(d,"dom_slotsContent",b.widgetRoot+" ."+b.content),
h(d,"dom_noslotsNotSure",b.widgetRoot+" ."+b.notSureError),h(d,"dom_noslotsUnknown",b.widgetRoot+" ."+b.unknownError),h(d,"dom_zipEntError",b.widgetRoot+" ."+b.ineligiblePostal),h(d,"dom_slotDisplay",b.widgetRoot+" ."+b.slotDisplayContainer),h(d,"dom_retry",b.widgetRoot+" ."+b.retry),h(d,"dom_slotTrigger",b.widgetRoot+" ."+b.calendarTrigger));h(d,"load_url",a.load_url);h(d.dropdown,"element","")};m.prototype.initializeSpecificDom=function(){this.bbSDUI.initializeDOM()};var r=[];m.prototype.getRequestItemIDForKey=
function(a){var b=this.itemCache.operate(a,{},SDUtils.Cache.IF_EXISTS.PRESERVE,SDUtils.Cache.IF_NEW.ADD),c=b.requestItemID;c===q&&(c=r.length,b.requestItemID=c,r[c]=a);return c};m.prototype.getKeyForRequestItemID=function(a){return r[a]};m.prototype.getIsSDAvailableParams=function(a,b){for(var c={marketplaceID:a},d=0,f=0;f<b.length;f++){var h=b[f];if(h.isSDAvailable===q){c["requestItemID"+d]=this.getRequestItemIDForKey(h);for(var g=0;g<e.length;g++){var r=e[g],n=h[r];null!==n&&n!==q&&(c[r+d]=n)}d++}}return c};
m.prototype.getKeyFromConfig=function(){return{asin:this.bbSDUI.config({key:"id_asin"}),merchantID:this.bbSDUI.config({key:"id_merchant"}),sku:this.bbSDUI.config({key:"id_sku"}),fmid:this.bbSDUI.config({key:"id_fmid"})}};m.prototype.setIsSDAvailable=function(a,b){this.itemCache.update(a,{isSDAvailable:b});this.itemCache.keysAreEqual(a,this.getKeyFromConfig())&&(this.bbSDUI.config({key:"isSDAvailable",value:b}),this.refreshAppearance())};m.prototype.onTwisterChildrenIsSDAvailableResponse=function(a){u.isDebugEnabled()&&
u.debug("isSDAvailable:",a);for(var b in a)a.hasOwnProperty(b)&&this.setIsSDAvailable(this.getKeyForRequestItemID(b),a[b])};m.prototype.onTwisterChildrenIsSDAvailableError=function(a,b,c){u.isWarnEnabled()&&(u.warn("SD isSDAvailable AJAX error: "+b),c&&u.warn("(HTTP error: "+c+")"))};m.prototype.cacheChildData=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.itemCache.update(c,c)}};m.prototype.batchIsSDAvailable=function(a){var b=this.bbSDUI.config({key:"id_marketplace"});a=this.getIsSDAvailableParams(b,
a);var c=this;SDFramework.jq.ajax({url:"/gp/product/features/scheduled-delivery/is-sd-available-json.html?powerbar=0",type:"POST",dataType:"json",data:a,success:function(a){c.onTwisterChildrenIsSDAvailableResponse(a)},error:function(a,b,d){c.onTwisterChildrenIsSDAvailableError(a,b,d)},timeout:2E4})};m.prototype.fetchTwisterData=function(a){this.cacheChildData(a);this.batchIsSDAvailable(a)};return new m(a)}t.ScheduledDelivery={};t.SDUtils={};var u=function(){function a(){}function c(){return!1}for(var d=
["log","info","debug","warn","error"],b={suppressDefaultConsole:a},g=0;g<d.length;g++){var h=d[g],f="is"+h.charAt(0).toUpperCase()+h.substr(1)+"Enabled";b[f]=c;b[h]=a}return b}();ScheduledDelivery.Debug={requiredArg:function(a){return a}};t.SDFramework={jq:y};(function(){SDFramework.Class=function(){function a(a){SDFramework.jq.extend(this.rep,a)}function c(a,b){return function(){return b.apply(a,arguments)}}function d(a){var b=this.rep,d;for(d in a)a.hasOwnProperty(d)&&(this.interfaceInstance[d]=
c(b,a[d]))}function b(a){SDFramework.jq.extend(this.interfaceInstance,a)}return function(c){function h(){}this.interfaceInstance=h.prototype=c;this.rep=new h;this.declarePrivate=a;this.declarePublic=d;this.declarePublicFinal=b}}();SDFramework.defineStruct=function(){var a=arguments;return function(){for(var c=0;c<a.length;c++)this[a[c]]=arguments[c]}};SDFramework.defineClass=function(a){var c=function(){var c=a.initBase?a.initBase.apply(null,arguments):this,b=new SDFramework.Class(c);a.privateFunctions&&
b.declarePrivate(a.privateFunctions);a.publicFunctions&&b.declarePublic(a.publicFunctions);a.publicFinal&&b.declarePublicFinal(a.publicFinal);if(a.events)for(var g=c,h=a.events,f=0;f<h.length;f++)g[h[f]]=new SDFramework.Event;a.init&&a.init.apply(b.rep,arguments);a.publicInit&&a.publicInit.apply(c,arguments);return c};a.publicStatic&&SDFramework.jq.extend(c,a.publicStatic);return c}})();(function(){SDUtils.isEmptyObject=function(a){for(var d in a)if(a.hasOwnProperty(d))return!1;return!0};var a=SDFramework.defineClass({init:function(a){this.i=
0;this.arr=a},publicFunctions:{hasNext:function(){return this.i<this.arr.length},next:function(){var a=this.arr[this.i];this.i++;return a}}});SDUtils.ArraySet=SDFramework.defineClass({init:function(){this.arr=[]},publicFunctions:{add:function(a){if(this.contains(a))return!1;this.arr.push(a);return!0},remove:function(a){a=SDFramework.jq.inArray(a,this.arr);if(-1==a)return!1;this.arr[a]=this.arr[this.arr.length-1];this.arr.pop();return!0},contains:function(a){return-1!=SDFramework.jq.inArray(a,this.arr)},
getCount:function(){return this.arr.length},isEmpty:function(){return 0===this.getCount()},iterator:function(){return new a(this.arr)},getAny:function(){return this.arr[0]},removeAny:function(){return this.arr.pop()}}});SDFramework.Event=function(){this.handlers=new SDUtils.ArraySet;this.dispatch=function(){for(var a=this.handlers.iterator();a.hasNext();)a.next().apply(null,arguments)}};SDUtils.Cache=function(){function a(b,c){return function(a,d){return this.operate(a,d,b,c)}}function d(a,b,c){for(var d in b)!b.hasOwnProperty(d)||
!c&&a.hasOwnProperty(d)||(a[d]=b[d])}var b={PRESERVE:q,REPLACE:1,MERGE_OVERWRITE:2,MERGE_NO_OVERWRITE:3},g={DO_NOT_ADD:q,ADD:!0};return SDFramework.defineClass({publicStatic:{IF_EXISTS:b,IF_NEW:g},init:function(a){a.length||u.error("Invalid keyspec:",a);this.spec=a;this.buckets={}},privateFunctions:{primaryKey:function(a){return a[this.spec[0]]},supplementaryKeysAreEqual:function(a,b){for(var c=this.spec,d=1;d<c.length;d++)if(a[c[d]]!==b[c[d]])return!1;return!0},operateOnBucket:function(a,b,c,g,e){for(var r=
0;r<a.length;r++){var k=a[r];if(this.supplementaryKeysAreEqual(k.key,b)){switch(g){case SDUtils.Cache.IF_EXISTS.REPLACE:k.value=c;break;case SDUtils.Cache.IF_EXISTS.MERGE_OVERWRITE:d(k.value,c,!0);break;case SDUtils.Cache.IF_EXISTS.MERGE_NO_OVERWRITE:d(k.value,c,!1)}return k.value}}e===SDUtils.Cache.IF_NEW.ADD&&a.push({key:b,value:c});return c}},publicFunctions:{keysAreEqual:function(a,b){return this.primaryKey(a)==this.primaryKey(b)&&this.supplementaryKeysAreEqual(a,b)},operate:function(a,b,c,d){var e=
this.primaryKey(a),r=this.buckets[e];return r===q?(d==g.ADD&&(this.buckets[e]=[{key:a,value:b}]),b):this.operateOnBucket(r,a,b,c,d)},set:a(b.REPLACE,g.ADD),update:a(b.MERGE_OVERWRITE,g.ADD),get:a(b.PRESERVE,g.DO_NOT_ADD),clear:function(){this.buckets={}},forEachSubkey:function(a){for(var b=0;b<this.spec.length;b++)a(this.spec[b])}}})}()})();ScheduledDelivery.Fsm=SDFramework.defineClass({init:function(a){this.initMatrix(a.graph);this.triggers=a.triggers?a.triggers:{};this.slaves=a.slaves?a.slaves:
[];a.options&&(this.state=a.options.initialState,this.defaultSearch=a.options.defaultSearch,this.context=a.options.context);this.state===q&&(this.state="init");this.defaultSearch===q&&(this.defaultSearch=!1)},privateFunctions:{initMatrix:function(a){this.matrix={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];this.matrix[c]={};for(var b in d)d.hasOwnProperty(b)&&(this.matrix[c][b]={fn:d[b],enabled:!0})}},incrementSearch:function(a,c,d){var b=this.matrix[a.state];if(b)for(var g in b)if(b.hasOwnProperty(g)&&
!d[g]&&b[g].enabled){var h={state:g,source:a};d[g]=!0;c.push(h)}return c.shift()},path:function(a){var c=[],d={state:this.state,source:null},b={};for(b[this.state]=!0;d.state!==a;)if(d=this.incrementSearch(d,c,b),d===q)return;for(a=[];null!==d.source;)a.unshift(d.state),d=d.source;return a},getTransitionMetadata:function(a,c){var d=this.matrix[a];if(d)return d[c]},driveSlaves:function(){for(var a=0;a<this.slaves.length;a++){var c=this.slaves[a],d=c.bindings[this.state];d!==q&&c.fsm.trySetState(d)}},
doSingleStepTransition:function(a,c){var d=this.getTransitionMetadata(this.state,a);if(d&&d.enabled)return!1!==d.fn.apply(this.context,c)?(this.state=a,this.driveSlaves(),!0):!1},doMultiStepTransition:function(a,c){var d=this.path(a);if(d===q)return q;for(var b=0;b<d.length;b++)if(!this.doSingleStepTransition(d[b],c))return!1;return!0},logTransitionFailed:function(a,c){u.error('State transition from "'+a+'" to "'+c+'" failed.')},logTransitionNotDefined:function(a,c){u.error('State transition from "'+
a+'" to "'+c+'" does not exist.')}},publicFunctions:{getState:function(){return this.state},setState:function(a,c){var d=this.state,b=this.trySetState(a,c);b||(!1===b?this.logTransitionFailed(d,a):this.logTransitionNotDefined(d,a))},trySetState:function(a,c){var d=this.defaultSearch,b=[];c&&(c.search!==q&&(d=c.search),c.args!==q&&(b=c.args));var g=this.doSingleStepTransition(a,b);if(g!==q)return g;if(this.state===a)return!0;if(d)return this.doMultiStepTransition(a,b)},setTransitionEnabled:function(a,
c,d){var b=this.getTransitionMetadata(a,c);b?b.enabled=d:this.logTransitionNotDefined(a,c)},enableTransition:function(a,c){this.setTransitionEnabled(a,c,!0)},disableTransition:function(a,c){this.setTransitionEnabled(a,c,!1)},setTrigger:function(a,c,d){var b=this.triggers[a];b||(b={},this.triggers[a]=b);b[c]=d},clearTrigger:function(a,c){var d=this.triggers[a];d&&delete d[c]},trigger:function(a){var c=this.triggers[a];c?(c=c[this.state])?this.setState(c):u.error('State "'+this.state+'" cannot consume trigger "'+
a+'".'):u.error('Trigger "'+a+'" is not defined.')},tryTrigger:function(a){if(a=this.triggers[a])if(a=a[this.state])return this.trySetState(a)}}});ScheduledDelivery.Data={};ScheduledDelivery.Data.ReservationIdParser=function(){return SDFramework.defineClass({init:function(a){this.parts=a?a.split(";"):[]},publicFunctions:{getSlotId:function(){return this.parts[0]},getEncodedCarriers:function(){return this.parts[1]},getEncodedCharges:function(){return this.parts[2]},getEncodedServices:function(){return this.parts[3]},
getCharges:function(){if(this.charges===q){var a=this.getEncodedCharges(),a=a?a.split("^"):[];this.charges={perItem:parseFloat(a[0]),perShipment:parseFloat(a[1]),currencyCode:a[2]}}return this.charges},getCarriers:function(){if(this.carriers===q){var a=this.getEncodedCarriers();this.carriers=a?a.split(","):[]}return this.carriers}}})}();ScheduledDelivery.Data.FulfillmentServiceSubclass=function(){function a(a){for(var b=0;b<c.length;b++)if(c[b]==a)return b;return q}var c=["FAST_TRACK_SAME_DAY","FAST_TRACK_FUTURE_DAY",
"NOT_FAST_TRACK",q];return{score:a,pickTightestSla:function(c){for(var b=c,g=1;g<arguments.length;g++){var h=arguments[g],f=a(h),m=a(b);if(m===q||f!==q&&f<m)b=h}return b}}}();ScheduledDelivery.Data.Json=function(){function a(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=f[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,d){var f,k,p,w,G=g,C,v=d[b];v&&"object"===typeof v&&"function"===typeof v.toJSON&&(v=v.toJSON(b));
"function"===typeof m&&(v=m.call(d,b,v));switch(typeof v){case "string":return a(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);case "object":if(!v)return"null";g+=h;C=[];if("[object Array]"===Object.prototype.toString.apply(v)){w=v.length;for(f=0;f<w;f+=1)C[f]=c(f,v)||"null";p=0===C.length?"[]":g?"[\n"+g+C.join(",\n"+g)+"\n"+G+"]":"["+C.join(",")+"]";g=G;return p}if(m&&"object"===typeof m)for(w=m.length,f=0;f<w;f+=1)"string"===typeof m[f]&&(k=m[f],
(p=c(k,v))&&C.push(a(k)+(g?": ":":")+p));else for(k in v)Object.prototype.hasOwnProperty.call(v,k)&&(p=c(k,v))&&C.push(a(k)+(g?": ":":")+p);p=0===C.length?"{}":g?"{\n"+g+C.join(",\n"+g)+"\n"+G+"}":"{"+C.join(",")+"}";g=G;return p}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,f={"\b":"\\b","\t":"\\t","\n":"\\n",
"\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;return{serialize:"object"===typeof JSON&&"function"===typeof JSON.stringify?function(a,b,c){return JSON.stringify(a,b,c)}:function(a,b,d){var k;h=g="";if("number"===typeof d)for(k=0;k<d;k+=1)h+=" ";else"string"===typeof d&&(h=d);if((m=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})},deserialize:"object"===typeof JSON&&"function"===typeof JSON.parse?function(a,b){return JSON.parse(a,
b)}:function(a,b){function c(a,d){var k,f,h=a[d];if(h&&"object"===typeof h)for(k in h)Object.prototype.hasOwnProperty.call(h,k)&&(f=c(h,k),f!==q?h[k]=f:delete h[k]);return b.call(a,d,h)}var k;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return k=eval("("+a+")"),"function"===typeof b?c({"":k},""):k;throw new SyntaxError("JSON.parse");}}}();(function(){function a(a){try{return encodeURIComponent(ScheduledDelivery.Data.Json.serialize(a)).replace(/[\\~]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}catch(b){return u.error("Could not serialize SD data to JSON.",b,a),q}}function c(a,b){if(a){if(b===q||null===b)b="";a.jquery?a.attr("value",b):d.each(a,function(a,c){c&&d("input[name='"+c+"']").attr("value",b)})}}var d=SDFramework.jq,
b={SPECIAL:-2,DATA_MEMBER:-1,SLOT:"slot"},g={data:b.SPECIAL,refdataVersion:b.DATA_MEMBER};ScheduledDelivery.Data.FormPersistence=SDFramework.defineClass({init:function(){this.data={}},privateFunctions:{updateFields:function(a,b){d.each(this.fields[a],function(a,d){c(d,b&&b[a])});this.data[a]=b},updateData:function(){var d=this.fields[b.SPECIAL].data;d&&c(d,a(this.data))}},publicFunctions:{setMappings:function(a){var c={};d.each(b,function(a,b){c[b]={}});d.each(a,function(a,d){c[g[a]||b.SLOT][a]=d});
this.fields=c},clearSlotFields:function(){this.updateSlotFields()},updateSlotFields:function(a){this.updateFields(b.SLOT,a);this.updateData()},updateDataMembers:function(a){var f=this.fields[b.DATA_MEMBER],g=this;d.each(a,function(a,b){g.data[a]=b;c(f[a],b)});this.updateData()}}})})();ScheduledDelivery.BuyBox={};var N={};ScheduledDelivery.BuyBox.HoverPopover=function(){return SDFramework.defineClass({init:function(a){this.container=SDFramework.jq(ScheduledDelivery.Debug.requiredArg(a.containerHtml));
a.contentHtml&&this.setContent(a.contentHtml)},publicFunctions:{setContentHtml:function(a){this.container.html(a)},bind:function(a){this.parent&&this.unbind();this.parent=a;a.amazonPopoverTrigger({location:["left","auto"],locationAlign:"middle",locationMargin:-10,width:null,skin:null,hoverHideDelay:0,hoverShowDelay:0,showOnHover:!0,showCloseButton:!1,literalContent:this.container})},unbind:function(){this.parent&&(this.parent.removeAmazonPopoverTrigger(),this.parent=null)}}})}();ScheduledDelivery.BuyBox.UIOverride=
function(){function a(a){b.wrap(a)}function c(a){b.unwrap(a)}var d=SDFramework.defineClass({init:function(a){this.cssClass=a;this.html='<span class="'+a+'" />';var b="span."+a;this.wrapperSelector=b;var c=function(){return SDFramework.jq(this).parent(b).length};this.contentFilter=c;this.nonContentFilter=function(){return!c.call(this)}},publicFunctions:{filterWrappedElements:function(a){return a.filter(this.contentFilter)},filterUnwrappedElements:function(a){return a.filter(this.nonContentFilter)},
selectWrappers:function(a){return a.parent(this.wrapperSelector)},wrap:function(a){this.filterUnwrappedElements(a).wrap(this.html)},unwrap:function(a){a=this.filterWrappedElements(a);a.unwrap?a.unwrap():a.each(function(){SDFramework.jq(this).parent().replaceWith(this)})}}}),b=new d("sdXuiVisibilityWrapper");return{WrapperTemplate:d,hide:a,show:c,setVisible:function(b,d){d?c(b):a(b)}}}();ScheduledDelivery.BuyBox.SDIntentCheckbox=SDFramework.defineClass({events:["onCheck","onClear"],privateFunctions:{dom:E("dom_sdCheckbox",
"check"),dispatchClick:function(){this.isChecked()?this.onCheck.dispatch():this.onClear.dispatch()}},publicFunctions:{config:z("checkbox"),bindDOM:function(){var a=this;this.dom().click(function(){a.dispatchClick()})},isChecked:function(){var a=this.dom();return a.prop?a.prop("checked"):a.is(":checked")},exists:function(){return 0<this.dom().size()},setChecked:function(a){if(this.isChecked()!==a){var c=this.dom();c.prop?this.dom().prop("checked",a):a?c.attr("checked","checked"):c.removeAttr("checked");
this.dispatchClick()}},setVisible:function(a){a?this.dom().show():this.dom().hide()}}});ScheduledDelivery.BuyBox.SlotStorage=SDFramework.defineClass({privateFunctions:{INPUT_VALUE_PREFIX:"custom-value",validSlotExists:function(a){a=this.slots[a];var c=!1,d;for(d in a)if(a.hasOwnProperty(d)){var b=a[d];0===d.indexOf(this.INPUT_VALUE_PREFIX)&&b&&(c=!0)}return c}},init:function(a,c){this.slotInputClass=a;this.rootElement=c;this.slots={}},publicFunctions:{config:z("slotstorage"),storeSlotInput:function(a){if(a){this.slots[a]=
{};var c=this;SDFramework.jq("#"+this.rootElement+" ."+this.slotInputClass).each(function(){var d=SDFramework.jq(this),b=d.attr("name"),d=d.attr("value");c.slots[a][b]=d})}},repopulateSlotInput:function(a){if(a){var c=this.slots[a],d;for(d in c)if(c.hasOwnProperty(d)){var b=c[d],g=null,g=SDFramework.jq("#"+this.rootElement+" input[name='"+d+"']."+this.slotInputClass);0<g.size()&&(g=SDFramework.jq(g[0]),g.attr("name",d),g.attr("value",b))}return this.validSlotExists(a)}},clearSlotInput:function(a){if(a){var c=
this;SDFramework.jq("#"+this.rootElement+" ."+this.slotInputClass).each(function(){var a=SDFramework.jq(this);0===a.attr("name").indexOf(c.INPUT_VALUE_PREFIX)&&a.attr("value","")})}}}});SDUtils.isBeacon=function(a){return 0<a.parents(".a-container").length};SDUtils.protectAgainstDoubleAction=function(){var a={};return function(c,d){if(!c)return t.console&&t.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(c))return!0;
a[c]=1;setTimeout(function(){delete a[c]},d||100);return!1}}();N.AddToCartWrapper=function(){return SDFramework.defineClass({init:function(){this.warningPopover=new ScheduledDelivery.BuyBox.HoverPopover({containerHtml:'<div class="sd_bb_warn_pop" />'});this.disabledDomFsm=new ScheduledDelivery.Fsm({graph:{hiddenNotLoaded:{shown:function(){this.disabledDOM=this.loadDisabledJQ()}},shown:{hidden:function(){this.disabledDOM.hide()}},hidden:{shown:function(){this.disabledDOM.show()}}},options:{context:this,
initialState:"hiddenNotLoaded"}});this.enabledDomFsm=new ScheduledDelivery.Fsm({graph:{shown:{hidden:function(){this.overriddenUI=this.getAddToCartSelector();this.overriddenUI.hide()}},hidden:{shown:function(){this.overriddenUI.show()}}},options:{context:this,initialState:"shown"}})},privateFunctions:{getAddToCartSelector:function(){var a=this.config({key:"element"});"undefined"==a&&(u.warn("shopping-cart: no element"),a=[]);return SDFramework.jq(a)},loadDisabledJQ:function(){var a=this.config({key:"disabledHTML"});
if("undefined"!=a){var c=this.getAddToCartSelector(),a=SDFramework.jq(a);c.after(a);c=a.is("img")?a:a.find("img");0===c.length?u.warn("Add to cart disabled image not found"):(this.warningPopover.bind(c),c.css("cursor",this.config({key:"cursorDisabled"})))}else u.warn("no disabledHTML"),a=SDFramework.jq(document.createElement("span"));return a}},publicFunctions:{config:z("shoppingCart"),enable:function(a){a?this.enableAddToCart():this.disableAddToCart()},enableAddToCart:function(){this.disabledDomFsm.trySetState("hidden");
this.enabledDomFsm.setState("shown")},disableAddToCart:function(){this.enabledDomFsm.setState("hidden");this.disabledDomFsm.setState("shown")},setWarningMessage:function(a){this.warningPopover.setContentHtml(a)}}})}();N.OneClickWrapper=function(){return SDFramework.defineClass({publicFunctions:{config:z("oneClick"),enable:function(a){var c=this.config({key:"element"});c?ScheduledDelivery.BuyBox.UIOverride.setVisible(SDFramework.jq(c),a):u.warn("one-click: no element")}}})}();ScheduledDelivery.BuyBox.DomStringUpdater=
function(){var a=ScheduledDelivery.Debug;return SDFramework.defineClass({init:function(c){this.merchantStringMappings=a.requiredArg(c.domMerchantStringMappings);this.afnLearnMoreNode=a.requiredArg(c.afnLearnMoreNode)},privateFunctions:{resolveMerchantString:function(a,d){return this.merchantStringMappings[a][d]},updateMerchantTextElements:function(a,d){for(var b in a)a.hasOwnProperty(b)&&SDFramework.jq(b).text(this.resolveMerchantString(a[b],d))},resolveLearnMoreNode:function(a,d){return a?this.afnLearnMoreNode:
this.resolveMerchantString("sd_mfn_learn_more_node",d)}},publicFunctions:{updateStrings:function(a,d){this.updateMerchantTextElements({"#sd_bb_intent_text":"schedule_delivery_34179","#sd_bb_select_delivery_date_text":"sd-select-delivery-date-buybox","#sd_bb_notify1":"notify1","#sd_bb_notify2":"notify2"},d);var b=a?this.afnLearnMoreNode:this.resolveMerchantString("sd_mfn_learn_more_node",d),g;g=a||"Installation"!=d&&"LocalInstallation"!=d?"/gp/help/customer/display.html?nodeId=":"/gp/feature.html?docId=";
SDFramework.jq("#sd_bb_learn_more").attr("href",g+b)}}})}();ScheduledDelivery.BuyBox.Widget=SDFramework.defineClass({initBase:function(a,c,d,b){return ca(a,c,d,b)},init:function(a,c,d,b){this.weblabs=b;this.domStringUpdater=a.domStringUpdater;this.jsMerchantStringMappings=a.jsMerchantStringMappings;this.marketplaceID=a.marketplaceID;this.strings=a.strings;this.initUI();c=function(){};this.visFsm=new ScheduledDelivery.Fsm({graph:{hidden:{hidden:c,visible:this.container.show},visible:{hidden:this.container.hide,
visible:c}},options:{context:this.container,initialState:"hidden"}});this.calCacheFsm=new ScheduledDelivery.Fsm({graph:{init:{needNew:this.invalidateCalendars},needNew:{needNew:this.invalidateCalendars}},options:{context:this}});this.fsm=new ScheduledDelivery.Fsm({graph:{notLoaded:{enabled:c,disabled:c,requiredEnabled:this.xToRequiredNt,requiredDisabled:c},enabled:{enabled:c,disabled:this.xToDisabledNt,requiredEnabled:this.xToRequiredNt,requiredDisabled:this.xToDisabledNt},disabled:{enabled:c,disabled:c,
requiredEnabled:this.xToRequiredNt,requiredDisabled:c},requiredEnabled:{enabled:this.xFromRequiredNt,disabled:function(){this.xFromRequiredNt();this.toDisabledNt()},requiredEnabled:c,requiredDisabled:function(){this.xFromRequiredNt();this.toDisabledNt()}},requiredDisabled:{enabled:c,disabled:c,requiredEnabled:this.xToRequiredNt,requiredDisabled:c}},slaves:[{fsm:this.visFsm,bindings:{enabled:"visible",disabled:"hidden",requiredEnabled:"visible",requiredDisabled:"hidden"}},{fsm:this.calCacheFsm,bindings:{enabled:"needNew",
requiredEnabled:"needNew"}}],triggers:{require:{enabled:"requiredEnabled",disabled:"requiredDisabled"},unrequire:{requiredEnabled:"enabled",requiredDisabled:"disabled"},enable:{enabled:"enabled",disabled:"enabled",requiredEnabled:"requiredEnabled",requiredDisabled:"requiredEnabled"},disable:{enabled:"disabled",requiredEnabled:"requiredDisabled"}},options:{context:this,initialState:"notLoaded"}});this.setEnabledTrigger(d);this.setMerchantType(a.merchantType)},publicInit:function(){},privateFunctions:{initUI:function(){this.container=
SDFramework.jq("#sd_div");this.chkSdIntent=this.bbSDUI.checkbox},setRequiredTrigger:function(a){this.required=a;this.fsm.tryTrigger(a?"require":"unrequire")},setEnabledTrigger:function(a){this.enabled=a;this.fsm.tryTrigger(a?"enable":"disable")},xToDisabledNt:function(){this.chkSdIntent.setChecked(!1)},xToRequiredNt:function(){this.bbSDUI.shoppingCart.setWarningMessage(this.strings.sd_required_buybox_disabled);this.chkSdIntent.setChecked(!0);this.chkSdIntent.setVisible(!1)},xFromRequiredNt:function(){this.chkSdIntent.setVisible(!0);
this.bbSDUI.shoppingCart.setWarningMessage(this.nonRequiredShoppingCartWarning)},setMerchantType:function(a){this.merchantType=a;Q({calendar:this.calendarRef,buybox:this.bbSDUI,merchantType:a,marketplaceID:this.marketplaceID,strings:this.strings});SDFramework.jq("#sd_bb_no_slots_message").text(this.calendarRef.config({key:"noSlotsAddressBB"}));SDFramework.jq("#sd_bb_retrieve_error").text(this.calendarRef.config({key:"retrieveError"}));this.nonRequiredShoppingCartWarning=this.jsMerchantStringMappings?
this.jsMerchantStringMappings.sd_buybox_disabled[a]:this.strings.sd_buybox_disabled;this.required||this.bbSDUI.shoppingCart.setWarningMessage(this.nonRequiredShoppingCartWarning)},invalidateCalendars:function(){this.bbSDUI.unselectCalendar();this.chkSdIntent.isChecked()&&this.bbSDUI.selectCalendar()},isCallbackWeblabConsistent:function(a){if(!a){if(!this.weblabs.sdTwisterOnChildSelect)return u.warn("Twister Ajax executed with inconsistent weblab state (T1)."),!1}else if(this.weblabs.sdTwisterOnChildSelect&&
a.sdInfo===q)return u.warn("Twister Ajax executed with inconsistent weblab state (non-T1)."),!1;return!0}},publicFunctions:{declareContainerReady:function(){this.fsm.setState(this.enabled?this.required?"requiredEnabled":"enabled":this.required?"requiredDisabled":"disabled")},updateBuyBoxObject:function(a){try{if(u.debug("Updating SD widget",a),this.isCallbackWeblabConsistent(a))if(this.weblabs.sdTwisterAjax){u.debug("SDTwister: T3");this.bbSDUI.config({key:"id_offerlist_id",value:a.offerListingID});
this.bbSDUI.config({key:"id_quantity",value:a.quantity});var c={asin:a.asin,merchantID:a.merchantID,sku:a.mSku,fmid:a.fmID,offerListingID:a.offerListingID,quantity:a.quantity},d=this.itemCache.update(c,c);d.isSDAvailable===q&&u.isWarnEnabled()&&u.warn("Cache miss on SD Availability for item:",a,"Cache state:",this.itemCache);this.bbSDUI.config({key:"id_merchant",value:d.merchantID});this.bbSDUI.config({key:"id_asin",value:d.asin});this.bbSDUI.config({key:"id_sku",value:d.sku});this.bbSDUI.config({key:"id_fmid",
value:d.fmid});this.bbSDUI.config({key:"shipoption",value:d.shipOption});this.bbSDUI.config({key:"isSDAvailable",value:d.isSDAvailable?!0:!1});this.domStringUpdater.updateStrings(d.isFBA,d.merchantType);this.setMerchantType(d.merchantType);this.setEnabledTrigger(this.bbSDUI.config({key:"isSDAvailable"}))}else this.weblabs.sdTwisterOnChildSelect?(u.debug("SDTwister: T1"),a?(this.bbSDUI.config({key:"id_merchant",value:a.merchantID}),this.bbSDUI.config({key:"id_asin",value:a.asin}),this.bbSDUI.config({key:"id_sku",
value:a.mSku}),this.bbSDUI.config({key:"id_fmid",value:a.fmID}),this.bbSDUI.config({key:"id_offerlist_id",value:a.offerListingID}),this.bbSDUI.config({key:"id_quantity",value:a.quantity}),this.bbSDUI.config({key:"shipoption",value:a.shipOption}),this.domStringUpdater.updateStrings(a.sdInfo.isFBA,a.sdInfo.merchantType),this.setMerchantType(a.sdInfo.merchantType),this.setEnabledTrigger(!0)):this.setEnabledTrigger(!1)):(u.debug("SDTwister: C"),SDFramework.jq("#sd_intent").removeAttr("disabled"),this.bbSDUI.config({key:"id_merchant",
value:a.merchantID}),this.bbSDUI.config({key:"id_asin",value:a.asin}),this.bbSDUI.config({key:"id_sku",value:a.mSku}),this.bbSDUI.config({key:"id_fmid",value:a.fmID}),this.bbSDUI.config({key:"id_offerlist_id",value:a.offerListingID}),this.bbSDUI.config({key:"id_quantity",value:a.quantity}),this.calendarRef.calData.clearCals(),0<SDFramework.jq("#sd_intent:checked").length&&SDFramework.jq("#sd_zipcode_go").click());else this.fsm.trigger("disable")}catch(b){u.error("Unable to update Scheduled Delivery widget.",
b.message,b.stack)}}}});K.prototype.initializeDom=function(){var a=this.domSettings?this.domSettings.widgetRoot:"sd_widgets_"+this.widgetIndex;SDFramework.jq("#"+a+" .sd_Loading").hide();SDFramework.jq("#"+a+" .sd_err_nojs").hide();SDFramework.jq("#"+a+" .sd_err_connect").hide()};K.prototype.establishDomHooks=function(a){a=this.domSettings?this.domSettings.widgetRoot:"sd_widgets_"+this.widgetIndex;this.calendarRef.icon({key:"dom_disabled",value:"#"+a+" .sd_calicon_disabled"});this.calendarRef.icon({key:"dom_enabled",
value:"#"+a+" .sd_calicon_enabled"});this.calendarRef.config({data:{dom_bar:a+" .sd_widget",dom_failbar:a+" .sd_err_connect",dom_noslots:a+" .sd_err_from_result",dom_inconsistent:a+" .sd_err_inconsistent",dom_reload:a+" .sd_reload",dom_loadbar:a+" .sd_Loading"}});1===this.UISettings.showDropdown&&this.calendarRef.dropdown.config({key:"element",value:"sduiDropdown"+this.widgetIndex})};K.prototype.injectDom=function(a,c,d,b,g,h,f){function m(a,b,c){l.push('<img class="sd_calicon ',a,'" src="',c,'" width="25" alt="Calendar" height="17" border="0"');
b||l.push(' style="display: none;"');l.push("/>")}function n(){m("sd_calicon_disabled",!0,g)}function e(a,b,c,d){var e;if(SDUtils.isBeacon(A)){l.push('<div class="',a," a-box ",c?"a-alert ":"","a-alert-",b,'" style="display: none;">');l.push('<div class="a-box-inner">');c&&l.push('<i class="a-icon a-icon-alert"></i>');for(e=3;e<arguments.length;e++)l.push(arguments[e]);l.push("</div>")}else for(l.push('<div class="',a,' sdWarn" style="display: none;">'),e=3;e<arguments.length;e++)l.push(arguments[e]);
l.push("</div>")}var r=this.calendarRef.config({key:"pickDateText"}),k=this.calendarRef.config({key:"learnMoreText"}),p=this.calendarRef.config({key:"reloadText"}),w=this.calendarRef.config({key:"noSlotsAddress"}),G=this.calendarRef.config({key:"inconsistentWithBuybox"}),C=this.calendarRef.config({key:"retrieveError"}),v=this.calendarRef.config({key:"tryAgain"}),q=this.calendarRef.config({key:"showDropdown"}),A=SDFramework.jq("#"+(this.domSettings?this.domSettings.widgetRoot:"sd_widgets_"+this.widgetIndex)),
l=[];l.push('<input type="hidden" name="SD-SlotID-',a,'" key="ScheduledDeliveryEntity.SlotId"                   value=""/>');l.push('<input type="hidden" name="SD-ResID-',a,'" key="ScheduledDeliveryEntity.ReservationId"            value=""/>');l.push('<input type="hidden" name="SD-ResType-',a,'" key="ScheduledDeliveryEntity.reservationType"          value=""/>');l.push('<input type="hidden" name="SD-StartTime-',a,'" key="ScheduledDeliveryEntity.startDeliveryDate"        value=""/>');l.push('<input type="hidden" name="SD-EndTime-',
a,'" key="ScheduledDeliveryEntity.endDeliveryDate"          value=""/>');l.push('<input type="hidden" name="SD-WindowTZ-',a,'" key="ScheduledDeliveryEntity.deliveryTimeZone"         value=""/>');l.push('<input type="hidden" name="SD-CutoffTime-',a,'" key="ScheduledDeliveryEntity.cutoffTime"               value=""/>');l.push('<input type="hidden" name="SD-CutoffTZ-',a,'" key="ScheduledDeliveryEntity.deliveryTimeZone"         value=""/>');l.push('<input type="hidden" name="SD-SlotStartLTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.startDate"  value=""/>');
l.push('<input type="hidden" name="SD-SlotEndLTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.endDate"    value=""/>');l.push('<input type="hidden" name="SD-SlotLongTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.timezone"   value=""/>');l.push('<input type="hidden" name="SD-Date-',a,'" value=""/>');l.push('<input type="hidden" name="SD-Cutoff-',a,'" value=""/>');c&&l.push('<input type="hidden" name="SD-OrderID-',a,'" value="',c,'"/>');d&&l.push('<input type="hidden" name="SD-ItemList-',
a,'" value="',d,'"/>');l.push('<input type="hidden" name="D_MinShipDtUTC-',a,'" key="ScheduledDeliveryEntity.promiseMinShipmentDate" value=""/>');l.push('<input type="hidden" name="D_MaxShipDtUTC-',a,'" key="ScheduledDeliveryEntity.promiseMaxShipmentDate" value=""/>');l.push('<input type="hidden" name="SD-PromiseLFSS-',a,'" key="ScheduledDeliveryEntity.promiseFulfillmentServiceSubclass" value=""/>');(c=this.dataField)&&(c.id||c.name)&&(l.push('<input type="hidden"'),c.id&&l.push(' id="',c.id,'"'),
c.name&&l.push(' name="',c.name,'"'),l.push("/>"));l.push('<span class="sd_Loading" style="display: none;">');l.push('<img src="',b,'" width="114" height="9" alt="Loading" border="0" />');l.push("</span>");1===q?(l.push('<div class="sdMessage" style="display: none;">'),l.push('<div class="sdMessage" style="display: none;"><span class="swSprite s_notifySm"></span><p></p></div>'),l.push("</div>")):(l.push('<div class="sdMessage" style="display: none;"><p></p></div>'),l.push('<div class="sdMessage_service" style="display: none;"><p></p></div>'));
l.push('<span class="sd_controls v1">');l.push('<span class="sd_widget" style="display: none">');1===q?(l.push('<span class="sd_Active">'),l.push('<select id="sduiDropdown',a,'" name="sduiDate" disabled >'),l.push('<option value="" selected>',r,"</option>"),l.push("</select>"),l.push("</span>"),n(),l.push('<a href="#" class="sd_calendar_link" id="calendarLink',a,'" onclick="return false;">')):(l.push('<a href="#" class="sd_calendar_link" id="calendarLink',a,'" onclick="return false;">'),l.push('<span class="sd_Active"> <u>'),
l.push(this.calendarRef.config({key:"sd_select_another_date_and_time"})),l.push("</u></span>"),n());m("sd_calicon_enabled",!1,h);l.push("</a>");l.push("</span>");l.push('<a class="learnmore" href="',f,'" target="_blank">',k,"</a>");l.push('<span class="sd_reload" id="sd_reload_',a,'" style="display: none;">');l.push(p);l.push("</span>");l.push("</span>");e("sd_err_noslots","info",!1,"<p>",w,"</p>");e("sd_err_inconsistent","info",!1,"<p>",G,"</p>");e("sd_err_connect","info",!1,"<p>",C,' <a class="sdReloadLink" href="#">',
v,"</a></p>");e("sd_err_from_result","info",!1,'<div class="sd_err_from_result_content"/>');l.push('<div id="sdcal-popup',a,'" class="sdCalendarPopover" style="display: none"></div>');A.prepend(l.join(""));A.find(".sdReloadLink").click(function(a){A.find(".sd_reload").click()})};sd_init_checkout_configure=function(a,c,d,b,g,h,f){function m(a){return a&&"false"!==a&&"0"!==a}function n(a,b,c,d,h){if(this.chkSDUI=V("sd_loaded_"+a.currentSD)){this.chkSDUI.config({key:"sd_calendar",value:this.calendarRef});
this.calendarRef.config({key:"load_url",value:c.load_url});this.calendarRef.config({key:"message_hook",value:a.messageHook});this.calendarRef.config({key:"dom_widget_root",value:"sd_widgets_"+a.currentSD});this.calendarRef.config({key:"dom_no_widget_root",value:"sd_no_widgets_"+a.currentSD});this.calendarRef.config({key:"dom_popup_trigger",value:"calendarLink"+a.currentSD});this.calendarRef.config({key:"id_enable_fn",value:a.onEnableFn});this.calendarRef.config({key:"id_select_fn",value:a.onSelectFn});
this.calendarRef.config({key:"id_is_selected",value:m(a.isSelected)});this.calendarRef.config({key:"weblabs",value:f});if(this.chkSDUI.inputs){var g=a.currentSD,n=e.id?SDFramework.jq("#"+e.id):[e.name];this.chkSDUI.inputs.setMappings({slotId:["SD-SlotID-"+g],reservationId:["SD-ResID-"+g],reservationType:["SD-ResType-"+g],ultStart:["SD-StartTime-"+g],ultEnd:["SD-EndTime-"+g],ultCutoff:["SD-CutoffTime-"+g],timeZone:["SD-CutoffTZ-"+g,"SD-WindowTZ-"+g],minShip:["D_MinShipDtUTC-"+g],maxShip:["D_MaxShipDtUTC-"+
g],fss:["SD-PromiseLFSS-"+g],start:["SD-SlotStartLTZ-"+g],end:["SD-SlotEndLTZ-"+g],tz:["SD-SlotLongTZ-"+g],data:n});this.chkSDUI.inputs.updateDataMembers({refdataVersion:h.sdUseCase})}this.chkSDUI.message&&(this.chkSDUI.message.config({data:{element:"sd_widgets_"+a.currentSD+" .sdMessage p",element_service:"sd_widgets_"+a.currentSD+" .sdMessage_service p",timeslotDeterminationFn:this.isTimeslot}}),this.chkSDUI.message.showDropdown=h.showDropdown!==q&&0===h.showDropdown?0:1)}this.chkSDUI.config({data:{dom_message_hook:a.messageHook,
dom_sdso:"sd-shipop",id_address:c.addressId,id_merchant:b.merchant,id_marketplace:c.marketplaceId,id_request:c.requestId,id_asin:b.asin,id_sku:b.msku,id_fmid:b.fmid,id_quantity:b.quantity,id_offerlist_id:b.olid,id_itemList_id:b.itemListId,id_shipoption:a.speedKey,id_enable_fn:a.onEnableFn,id_select_fn:a.onSelectFn,id_is_selected:a.isSelected,id_template_slot:d&&d.reservationId?d.reservationId:null}})}h=null===h?{}:h;var e=a.dataField;e&&(e.id||e.name)||(e={name:"SD-Data-"+a.currentSD});n.prototype=
new K(a.currentSD,b,g,h,null,e);n.prototype.initializeSpecificDom=function(){this.initializeDom()};a=new n(a,c,d,b,h);Q({calendar:a.calendarRef,checkout:a.chkSDUI,merchantType:d.merchantType,marketplaceID:d.marketplaceID,strings:d.strings,sdUseCase:h.sdUseCase});return a};H.declare("scheduledDeliveryWidget")})});
/* ******** */
(function(a,b,c){a.guardFatal(function(){})()})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("CashOnDeliveryAssets"):a}(),window);
/* ******** */
(function(a,d,k){a.execute(function(){a.when("A","a-popover","tellMeMoreLinkData","ready").execute(function(a,h){function e(b){if(b!==k){var a=b.title,f=encodeURI("&originalURI="+d.location.pathname),f=b.url+f;b=b.trigger;b="#"+b;var e=g(b),l={url:f,header:a,width:450,activate:"onclick",position:"triggerLeft",closeButton:"true",popoverLabel:a,closeButtonLabel:"Dismiss"};null!==a&&null!==f&&null!==b&&(null!==c&&h.remove(c),c=h.create(e,l).lock())}}var g=a.$,c=null;e(a.state("lowerPricePopoverData"));
a.state.bind("lowerPricePopoverData",function(b,a){e(b)});g(document).delegate("button#pfw_close_close-announce","click",function(a){a.preventDefault();c.unlock().hide();c.lock()});g(document).delegate("button#pfw_cancel_close-announce","click",function(a){a.preventDefault();c.unlock().hide();c.lock()})})})})(function(){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors;return d?d("RetailPricingFeedbackAsset"):a}(),window);
/* ******** */
(function(g){var m=window.AmazonUIPageJS||window.P,p=m._namespace||m.attributeErrors,e=p?p("DetailPagePrimeNowDesktopOffersAssets"):m;e.guardFatal?e.guardFatal(g)(e,window):e.execute(function(){g(e,window)})})(function(g,m,p){g.when("A","jQuery","dp-client-counter").execute(function(e,c,d){function g(){setTimeout(function(){c("#primenow-atc-spinner").addClass("aok-hidden");c("#primenow-atc-button").show()},2E3)}function b(a,b,c){g();m.ueLogError&&m.ueLogError(a,{logLevel:"ERROR",attribution:b,message:c})}
function a(a){var m=c("#variableWeightPricingStrategy").attr("value"),p=m?"pn_dp_bb_atc_vw":"pn_dp_bb_atc",N=c("#primenowQuantity").val();a=[{name:"itemAsin",value:a.inputs.asin},{name:"offerId",value:a.inputs.offerListingID},{name:"qid",value:a.inputs.qid},{name:"sr",value:a.inputs.sr}];try{if("PRODUCE_BY_UOM"===m)N=f();else if(m){var J=l();a.push({name:"amountInUom",value:J?J:null})}}catch(L){b(L,"primenow_vw_error","Bad VW dropdown data")}a.push({name:"quantity",value:N?N:1});e.ajax("/cart/ajax/additem/ref="+
p,{method:"GET",params:a,timeout:4E3,withCredentials:!0,success:function(a,b,d){g();c.isEmptyObject(a.cartErrors)?(c("#primenow-button-stack").append(n),c("#primenow-atc-changeover").show()):c.isEmptyObject(a.cartErrors.actionErrorMessage)||(b=a.cartErrors.actionErrorMessage,c("#primenow-atc-warning-text").text(b),c("#primenow-atc-warning-alert").show());e.trigger("navCartTotalQuantityEvent",a.cartSummary.totalQuantity)},error:function(a,b,f){g();c("#primenow-atc-error").show();e.trigger("dpLogFatalsEvent",
"[Prime now browser add to cart failed with status: "+b+"]","FATAL","primenow_addtocart_failure");d.inc("houdiniAddToCartFail")}})}function f(){return c("#primeNowVariableWeightWhole").length?c("#primeNowVariableWeightWhole").val():""}function l(){var a=f()+".",b;b=c("#primeNowVariableWeightFraction").length?c("#primeNowVariableWeightFraction").val():"";a=parseFloat(a+b);if(isNaN(a))throw"Not a Number in amountInUoM";return a}var n;e.declarative("primenow-atc",["click"],function(b){b=b.data;d.inc("houdiniAddToCartAction");
n=c("#primenow-atc-changeover");c("#primenow-atc-changeover").detach();c("#primenow-atc-warning-alert").hide();c("#primenow-atc-error").hide();c("#primenow-atc-button").hide();c("#primenow-atc-spinner").removeClass("aok-hidden");a(b)})});g.when("A","jQuery").execute(function(e,c){function d(d){c("span[data-primenow-atc]").each(function(){var b=c(this).attr("data-primenow-atc"),b=JSON.parse(b);b.hasOwnProperty("inputs")&&b.inputs.hasOwnProperty("quantity")&&(b.inputs.quantity=d,c(this).attr("data-primenow-atc",
JSON.stringify(b)))})}e.on("a:dropdown:primenowQuantity:select",function(c){d(c.value)})})});
/* ******** */
(function(k){var e=window.AmazonUIPageJS||window.P,q=e._namespace||e.attributeErrors,g=q?q("OneClickDesktopAssets",""):e;g.guardFatal?g.guardFatal(k)(g,window):g.execute(function(){k(g,window)})})(function(k,e,q){k.when("A","jQuery").execute("one-click-detection-js",function(g,c){function K(){var a=null;try{a=e.sessionStorage.getItem("1click-tsdelta")}catch(b){c("#1click-tsdelta").length&&""!==c("#1click-tsdelta").val()&&(a=c("#1click-tsdelta").val())}return a}function L(a){try{e.sessionStorage.setItem("1click-tsdelta",
a)}catch(b){c("#1click-tsdelta").length&&c("#1click-tsdelta").val(a)}}function v(){var a=c(f);if(a.length){var b=F,d=a.offset();a.width()&&a.height()&&(d.left+=a.width()/2,d.top+=a.height()/2);l=d;a=b.left-(l.left+x.x);b=b.top-(l.top+x.y);if(0<a&&a<=y.x&&0<b&&b<=y.y){M||c(r).find("option:selected").val()===t||(b=new Date,20>b.getTime()-N||(u&&(clearTimeout(u),u=null),O<G&&(N=b.getTime(),O++,Q(),u=g.delay(q,H))));return}}0<A&&g.delay(v,A)}function q(){v()}function I(a){if(void 0!==n){var b=new Date;
a.parents("form").append('\x3cinput type\x3d"hidden" id\x3d"1click-timestamp" name\x3d"1click-timestamp" value\x3d"'+(b.getTime()/1E3-n)+'" /\x3e');b=0;B&&(b=B/1E3);b&&a.parents("form").append('\x3cinput type\x3d"hidden" id\x3d"1click-prefetch-timestamp" name\x3d"1click-prefetch-timestamp" value\x3d"'+(b-n)+'" /\x3e')}}function S(a,b){void 0===n&&(b=new Date(b.getResponseHeader("Date")),n=(new Date).getTime()/1E3-b.getTime()/1E3,c(m).click(function(){I(c(this))}),L(n));a.error&&J()}function J(){M=
!0;u&&(clearTimeout(u),u=null)}function T(){B=0}function U(){c("#octiframe").remove();var a=document.createElement("iframe");c(a).attr("id","octiframe");c(a).css("display","none");c(a).attr("src","https://"+e.location.host+"/gp/oneclickprefetch/prime.txt");var b=document.getElementsByTagName("body");c(b[0]).append(a)}function Q(){c(d).children("#1click-trial-configuration").length||P();c("#oneClickSwatchContainer .BBOneClickInput").each(function(){var a=c(this),b=a.attr("oci_key"),a=a.attr("oci_val");
0<c("#"+b).length?c("#"+b).val(a):c(d).append('\x3cinput type\x3d"hidden" id\x3d"'+b+'" name\x3d"'+b+'" value\x3d"'+a+'" /\x3e')});var a=c(d).serialize(),b=c(f).attr("name"),b=".x"===b.substr(b.length-2,2)?b+"\x3d1":b+".x\x3d1";a&&(a+="\x26");var a=a+b,a=a+"\x26one-click-trial\x3d1",w=e.location.protocol,w="https"===c(d).attr("action").substr(0,5)?w+c(d).attr("action").substr(6):"http"===c(d).attr("action").substr(0,4)?w+c(d).attr("action").substr(5):w+("//"+e.location.host+c(d).attr("action"));U();
B=(new Date).getTime();k.now("oneclick-prefetcher").execute(function(b){b&&b.triggerPrefetch(w,a,S,J,T)})}function P(){var a=x.x+"x"+x.y,b=y.x+"x"+y.y;z="D";"cart"===p?z="C":"olp"===p&&(z="O");z+=b+"O"+a+"V0I"+H+"p"+A+"P"+G;c(d).append('\x3cinput type\x3d"hidden" id\x3d"1click-trial-configuration" name\x3d"trial-configuration" value\x3d"'+z+'" /\x3e')}var n,B=0,A=0,H=0,G=0,x={x:0,y:0},y={x:0,y:0},p=null,f=null,d=null,m=null,r=null,t=null,F={left:0,top:0},l={x:0,y:0},O=0,N=0,z,C=[{interval:5E3,prefetches:9,
left:-140,top:-30,width:880,height:200,pollInterval:100}],D=[{interval:5E3,prefetches:9,left:-120,top:-30,width:270,height:230,pollInterval:500}],E=[{interval:5E3,prefetches:9,left:-160,top:-25,width:240,height:220,pollInterval:500}],u,M=!1;k.when("jQuery","cf").execute("ocd-critical-feature-event",function(a){function b(b,c){k.now("oneclick-cheetah-handler").execute(function(d){var f=a(b),e=a(c);d&&f.length&&e.length&&d.appendAttributeOnSubmit(f,e)})}a(document).mousemove(function(a){F={left:a.pageX,
top:a.pageY}});a(document).mouseout(function(){F={left:Number.NaN,top:Number.NaN}});var c="";"undefined"!==typeof e.ocPrecacheAmznMerchant&&(c=e.ocPrecacheAmznMerchant);var g='form input[name\x3d"merchant-id"][value\x3d"'+c+'"] ~ div.oneclick input',c='form input[name\x3d"merchantID"][value\x3d"'+c+'"] ~ div.oneclick input[name\x3d"submit.one-click-2-day"]',h;if(a("#oneClickBuyButton").length)h=C[Math.floor(Math.random()*(C.length-1E-4))],p="detail",m=f="#oneClickBuyButton",d=a("form#handleBuy").length?
"form#handleBuy":"form#addToCart",r=a("#buyboxAddressSelectionDropDown").length?"#buyboxAddressSelectionDropDown":"select#shipTo",t="add-new",b(d,f);else if(a("#one-click-button").length)h=C[Math.floor(Math.random()*(C.length-1E-4))],p="detail",m=f="#one-click-button",d="form#addToCart",r="select#shipTo",t="add-new",b(d,f);else if(a("#oneClickCartButton").length)h=D[Math.floor(Math.random()*(D.length-1E-4))],p="cart",m=f="#oneClickCartButton",d="form#gutterCartViewForm",r="#cartAddresSelectionDropDown",
t="new";else if(a("input#oneClick").length)h=D[Math.floor(Math.random()*(D.length-1E-4))],p="cart",m=f="input#oneClick",d="form#gutterCartViewForm",r="select#addressID",t="new";else if(a(g).length)h=E[Math.floor(Math.random()*(E.length-1E-4))],p="olp",f=a(g),m='form input[name\x3d"merchant-id"] ~ div.oneclick input',d=f.parent().parent(),r=d.children('select[name\x3d"dropdown-selection"]'),t="add-new";else if(a(c).length)h=E[Math.floor(Math.random()*(E.length-1E-4))],p="olp",f=a(c),m='form input[name\x3d"merchantID"] ~ div.oneclick input',
d=f.parent().parent().parent(),r=d.children('select[name\x3d"dropdown-selection"]'),t="add-new";else return;x={x:h.left,y:h.top};y={x:h.width,y:h.height};H=h.interval;G=h.prefetches;A=h.pollInterval;"undefined"!==typeof e.ocInitTimestamp&&(K()?n=K():(n=(new Date).getTime()/1E3-e.ocInitTimestamp,L(n)));"olp"===p?a(m).click(function(){var b=a(this.form).attr("action"),b="http"===b.substr(0,4)?b.replace("http:","https:"):"https://"+e.location.host+b;a(this.form).attr("action",b);I(a(this));return!0}):
"undefined"!==typeof e.ocInitTimestamp&&a(m).click(function(){I(a(this))});a(d).attr("action")&&(a(m).click(J),P(),(l=a(f).offset())&&l.left&&l.top&&(a(f).width()&&a(f).height()&&(l.left+=a(f).width()/2,l.top+=a(f).height()/2),v()))})});"use strict";k.when("jQuery").register("oneclick-prefetcher",function(e){return{triggerPrefetch:function(c,k,q,v,R){e.ajax({type:"GET",url:c,data:k,contentType:"text/plain; charset\x3dUTF-8;",dataType:"json",success:function(c,e,g){q(c,g)},error:v,complete:R})}}})});
/* ******** */
(function(a,b,c){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("MomDetailPageAssets"):a}(),window);
/* ******** */
(function(k){var t=window.AmazonUIPageJS||window.P,w=t._namespace||t.attributeErrors,a=w?w("GCUIBaseJS"):t;a.guardFatal?a.guardFatal(k)(a,window):a.execute(function(){k(a,window)})})(function(k,t,w){k.when("a-util","gc-util","gc-formatter","gc-validator","gc-string").register("GC",function(a){var f={},h=[].slice.call(arguments,1);a.each(h,function(c){a.extend(f,c)});return f});k.when("A","gc-util","ready").register("gc-formatter",function(a,f){function h(a,b){if(-1===a.indexOf(b))return a;
var c=a.split(b);return c.slice(0,-1).join("")+b+c.slice(-1)}function c(c,e,g){var m=b.CURRENCY_SIGN,n=b.GROUPING_SEPARATOR,p=b.DECIMAL_SEPARATOR,u=b.DIGIT_OPTIONAL,k=b.DIGIT_REQUIRED,q=e.split(b.SUBPATTERN_SEPARATOR);e=q[0];q=q[1]||"-"+e;e=0>c?q:e;var q=-1!==e.indexOf(m),r=/([,\.#0]+)/.exec(e)[1],r=h(r,n),r=h(r,p),p=r.split(p),r=p[0],p=p[1]||"",v=r.lastIndexOf(n),t=Infinity;-1!==v&&(t=r.length-1-v);r=r.replace(n,"");c=Math.abs(c);d.performRounding&&(c=f.round(c,p.length,"half_even"));c=(c+"").split(".");
var w=c[0];c=c[1]||"";c=f.toFixedLength(c,p.length,"0","right");v=Math.max(r.length,w.length);w=f.toFixedLength(w,v," ","left");r=f.toFixedLength(r,v,"#","left");n="";for(--v;0<=v;v--){var B=w.charAt(v),A=r.charAt(v);A===u?" "!==B&&(n=B+n):A===k&&(n=" "===B?"0"+n:B+n)}if(Infinity!==t&&0<t){r=n;n=d.groupingSeperator;v=[];for(A=t;r.length;){v.length&&v.unshift(n);if(r.length<=A){v.unshift(r);break}v.unshift(r.substr(r.length-A,A));r=r.substr(0,r.length-A);-1<x.indexOf("_IN")&&(A=t-1)}n=v.join("")}if(""!==
c&&""!==p){r="";t=!1;for(v=p.length-1;0<=v;v--)if(w=c.charAt(v),A=p.charAt(v),A===u){if(t||"0"!==w)t=!0,r=w+r}else A===k&&(r=w+r);""!==r&&(n=n+(q?d.currencyDecimalSeparator:d.decimalSeparator)+r)}u=e.replace(/[,\.#0]+/,n);u=u.replace(m,g?"":d.currencySymbol);return a.trim(u)}function g(a,b){if("number"===typeof a)return!1;var c=b?d.currencyDecimalSeparator:d.decimalSeparator,e=""+a;if(-1!==e.indexOf(d.currencySymbol)||-1!==e.indexOf(c)&&-1!==e.indexOf(d.groupingSeperator))return!0;if(-1!==e.indexOf(d.groupingSeperator)){if(c=
e.split(d.groupingSeperator),2<c.length||2<c[1].length)return!0}else if(-1!==e.indexOf(c)&&(c=e.split(c),1===c.length))return!0;return!1}function e(a,b){var c=b?d.currencyDecimalSeparator:d.decimalSeparator;return""!==c&&(c=c.replace(/\./g,"\\."),c=a.match(new RegExp("^(.*)"+c+"([^"+c+"]*)$")),null!==c)?c.slice(1):[a,""]}function m(a,b){if(g(a)||isNaN(a)){var c=e(""+a,b),d=c[0],c=c[1]||"00",d=f.filterNumeric(d),c=f.filterNumeric(c);return f.toDecimal(d+"."+c)}return Number(a)}function r(a){n.hasOwnProperty(a)||
k.error('No formatter with the name: "'+a+'" for locale: '+x,"gc-formatter","getLocalizedFormatter");return n[a]}var q=a.state("gc-formatter-config"),d={locale:"en_US",currencySymbol:"$",currencyDecimalSeparator:".",decimalSeparator:".",groupingSeperator:",",dateShortPattern:"M/d/yy",currencyPattern:"¤#,##0.00;(¤#,##0.00)",decimalPattern:"#,##0.###",performRounding:!0},b={CURRENCY_SIGN:"¤",GROUPING_SEPARATOR:",",DECIMAL_SEPARATOR:".",DIGIT_OPTIONAL:"#",DIGIT_REQUIRED:"0",SUBPATTERN_SEPARATOR:";",
MONTH_REPLACE_SEPARATOR:"¤"},p=a.$;"object"===typeof q&&p.extend(d,q);var x=d.locale,u=function(){var b=function(){function b(c){return a.trim(""+c)}return{interpret:b,format:function(a){return b(a)}}}(),c=function(){function a(b){return f.toInteger(f.filterNumeric(""+b))}return{interpret:a,format:function(b){return""+a(b)}}}();return{message:b,integer:c}}(),n=function(){var a=function(){function a(b){return m(b,!1)}return{interpret:a,format:function(b){b=a(b);return c(b,d.decimalPattern)}}}(),g=
function(){function a(b){b=b.trim();if(!(new RegExp("^((\\d{1,3})(\\"+d.groupingSeperator+"\\d{3})+|\\d+)?(\\"+d.decimalSeparator+"\\d{0,2})?$")).test(b))throw"gcui-strict-amount-input-errors";b=b.split(d.groupingSeperator).join("");b=e(""+b,!1);return Number(b[0]+"."+(b[1]||"00"))}return{interpret:a,format:function(b){b=a(b);return c(b,d.currencyPattern,!0)}}}(),n=function(){function a(b){return m(b,!1)}return{interpret:a,format:function(b){b=a(b);return c(b,d.currencyPattern,!0)}}}(),p=function(){function a(b){return m(b,
!0)}return{interpret:a,format:function(b){b=a(b);return c(b,d.currencyPattern)}}}(),h=function(){function a(b,c){var e=null;if(b&&"function"===typeof b.getMonth)e=b;else if(b===f.toInteger(b))e=new Date(f.toInteger(b));else if("string"===typeof b){var e=c||d.dateShortPattern,e=e.split(/[^A-Za-z]+/),l=b.split(/[^0-9]+/);if(3!==l.length)e=null;else{for(var g,m,n,B=0;3>B;B++)switch(e[B]){case "yy":g=f.toInteger(l[B]);g=(60>=g?2E3:1900)+g;break;case "yyyy":g=f.toInteger(l[B]);break;case "MONTH":case "M":case "MM":m=
f.toInteger(l[B])-1;break;case "d":case "dd":n=f.toInteger(l[B])}e=new Date(g,m,n,0,0,0)}}return e}return{interpret:a,format:function(c,e,l){c=a(c,e);e="";if(c){e=c.getFullYear();var g=c.getMonth()+1;c=c.getDate();e=(l?l:d.dateShortPattern).replace("yyyy",e).replace("yy",(""+e).substr(2,2)).replace("MONTH",b.MONTH_REPLACE_SEPARATOR+g+b.MONTH_REPLACE_SEPARATOR).replace("MM",f.toFixedLength(g,2,"0")).replace("M",g).replace("dd",f.toFixedLength(c,2,"0")).replace("d",c)}return e},monthSeparator:b.MONTH_REPLACE_SEPARATOR}}();
return{decimal:a,amount:n,currency:p,date:h,strictAmount:g}}();return{interpolateMessage:function(a,b){return a.replace(/\{([^{}]+)\}/g,function(a,c){var d=c.split(","),e=d[0],l=d[1],d=d[2],e="object"===typeof b?b[e]:b;if("number"===l)switch(d){case "integer":e=u.integer.format(e);break;case "currency":e=n.currency.format(e);break;case "percent":break;default:e=n.decimal.format(e)}else"date"===l&&(e="short"===d?n.date.format(e,c.dateShortPattern):n.date.format(e,d));return e})},getLocalizedFormatter:r,
getFormatter:function(b){if(a.contains(b,"locale:"))return r(b.split(":")[1]);u.hasOwnProperty(b)||k.error("No formatter with the name: "+b,"gc-formatter","getFormatter");return u[b]},getLocale:function(){return d.locale},prettifyClaimCode:function(a){return 14>a.length?a:a.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3")}}});k.when("A","gc-util").register("gc-html",function(a,f){var h=a.$;return{scaleHtml:function(a,g,e){a=a.replace(/([0-9|.]+)px/g,function(a,b){return f.round(f.multiply(b,
g),0,"up")+"px"});for(var m=["width","height","cellpadding","cellspacing"],k=0;k<m.length;k++){var q=m[k];a=a.replace(new RegExp(" "+q+"=(['\"]?)([0-9]+)(['\"]?)","g"),function(a,b,c,e){return" "+q+"="+b+f.round(f.multiply(c,g),0,"up")+e})}a=a.replace(/ src=/g," data-src=");a=h("<div />").html(a);a.find("img").each(function(){var a=h(this);e?a.attr("data-src",f.clearImageStyleCode(a.attr("data-src"))):f.addImageStyleDimensions(a)});return a=a.html().replace(/ data-src=/g," src=")},makeHtml5:function(a){a=
a.replace(/ src=/g," data-src=");a=h("<div />").html(a);a.find("table, th, td").each(function(){var a=h(this),c=a.attr("cellpadding"),m=a.attr("cellspacing"),k=a.attr("valign"),q=a.attr("align"),d=a.attr("width"),b=a.attr("height");if(a.is("table")){var p=a.find("td, th");"undefined"!==typeof c&&(c=f.toInteger(c),p.css("padding",c),a.removeAttr("cellpadding"));"undefined"!==typeof m&&(m=f.toInteger(m),a.css("border-collapse",0<m?"separate":"collapse"),a.css("border-spacing",m),a.removeAttr("cellspacing"));
"undefined"!==typeof k&&(p.css("vertical-align",k),a.removeAttr("valign"))}"undefined"!==typeof q&&(a.is("table")&&"center"===q?a.css("margin","0 auto"):a.is("td")&&a.css("text-align",q),a.removeAttr("align"));"undefined"!==typeof d&&(a.css("width",d),a.removeAttr("width"));"undefined"!==typeof b&&(a.css("height",b),a.removeAttr("height"))});return a=a.html().replace(/ data-src=/g," src=")},escapeHtml:function(a){return"string"!==typeof a?"":a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,
"&quot;").replace(/'/g,"&#39;").replace(/>/g,"&gt;")},nl2br:function(a){return"string"!==typeof a?"":a.replace(/(\r\n)|(\n\r)|(\n)|(\r)/g,"<br />")}}});k.when("A","ready").execute(function(a){var f=a.$;if(a=a.state("gc-device-info")){var f=f("html"),h="";a.type&&(h+="gc-"+a.type);a.os&&a.os.name&&(h+=" gc-"+a.os.name);h+=a.isApp?" gc-app":" gc-no-app";f.addClass(h)}});k.when("A","ready").register("gc-metrics",function(a){function f(){return"function"===typeof t.uet}function h(a){f()&&
!g.hasOwnProperty(a)&&(g[a]=1,t.uet("bb",a,{wb:1}))}function c(a){f()&&g.hasOwnProperty(a)&&(delete g[a],t.uet("be",a,{wb:1}),t.uex("ld",a,{wb:1}))}var g={};return{trackSecondaryView:function(e){f()&&(a.on("a:popover:beforeShow:"+e,function(){h(e)}),a.on("a:popover:afterShow:"+e,function(){c(e)}))},incrementCounter:function(a){t.ue&&"function"===typeof t.ue.count&&t.ue.count(a,(t.ue.count(a)||0)+1)},stopWidgetTimer:c,startWidgetTimer:h}});k.when("A","gc-util","ready").register("gc-reftag",
function(a,f){function h(c,g,h){0!==g.length&&(g=g.hasClass("gc-indexed")?g:g.closest(".gc-indexed"),0!==g.length&&(g=g.index(),g++,h=f.toInteger(h),0<h&&(g+=h),a.get("/gc/reftag?ref_="+(c+"_"+g))))}function c(a,c){g.hasOwnProperty(a)||k.error("No reftag actions exist for feature: "+a,"gc-reftag");g[a].hasOwnProperty(c)||k.error("No reftag action exists: "+c+" for feature: "+a,"gc-reftag");var f=g[a][c];f.hasOwnProperty("reftag")||k.error("No reftag exists for feature: "+a+" and action: "+c,"gc-reftag");
return f.reftag}var g=a.state("gc-reftags")||{};a.declarative("gc-record-reftag","click",function(c){c.data&&c.data.reftag&&a.get("/gc/reftag?ref_="+c.data.reftag)});a.declarative("gc-record-indexed-reftag","click",function(a){a.data&&a.data.reftag&&h(a.data.reftag,a.$target)});return{getReftag:c,getFeatureReftags:function(c){g.hasOwnProperty(c)||k.error("No reftag actions exist for feature: "+c,"gc-reftag");var f={};a.each(g[c],function(a,g){a.hasOwnProperty("reftag")||k.error("No reftag exists for feature: "+
c+" and action: "+g,"gc-reftag");f[g]=a.reftag});return f},recordIndexedReftag:h,recordReftag:function(e,f){var g=c(e,f);a.get("/gc/reftag?ref_="+g)}}});k.when("A").register("gc-storage",function(a){function f(a){if(a)return"gc-storage-"+a}a=function(){this.storage={}};a.prototype.get=function(a){if(this.storage.hasOwnProperty(a))return this.storage[a]};a.prototype.set=function(a,f){this.storage[a]=f};a.prototype.remove=function(a){this.storage.hasOwnProperty(a)&&delete this.storage[a]};
a.prototype.clear=function(){this.storage={}};var h=new a;return{get:function(a){if(a=f(a))return h.get(a)},set:function(a,g){(a=f(a))&&h.set(a,g)},remove:function(a){(a=f(a))&&h.remove(a)},clear:function(){h.clear()}}});k.when("A","gc-formatter").register("gc-string",function(a,f){function h(c){var f=a.state("gc-strings")||{};f.hasOwnProperty(c)||k.error("String does not exist: "+c,"gc-string","getString");return f[c]}return{getStrings:function(c){for(var f=a.state("gc-strings")||{},
e={},m=0;m<c.length;m++){var h=c[m];f.hasOwnProperty(h)||k.error("String does not exist: "+h,"gc-string","getStrings");e[h]=f[h]}return e},getString:h,addStrings:function(c){var f={};a.each(c,function(a,c){""===c&&k.error("String cannot be blank: "+a,"gc-string","addStrings");f[a]=c});a.state("gc-strings",f)},addString:function(c,f){var e={};""===f&&k.error("String cannot be blank: "+f,"gc-string","addString");e[c]=f;a.state("gc-strings",e)},getInterpolatedString:function(a,g){return f.interpolateMessage(h(a),
g)}}});k.when("A").register("gc-util",function(a){var f=a.$,h={keyCodes:{alt:18,backspace:8,ctrl:17,del:46,end:35,enter:13,escape:27,home:36,shift:16,tab:9,num_zero:48,num_nine:57,numpad_zero:96,numpad_nine:105,A:65,Z:90,arrow_left:37,arrow_up:38,arrow_right:39,arrow_down:40}},c=function(){function a(b){return isNaN(b)?0:Number(b)}function c(a,b){var d=((a+"").split(".")[1]||"").length,e=((b+"").split(".")[1]||"").length;return d>e?d:e}function d(a,b,c){b="number"!==typeof b?2:b;b=0>
b?0:b;if(((a+"").split(".")[1]||"").length<b)return a;"string"===typeof c&&(c=c.toLowerCase());b=Math.pow(10,b);a*=b;switch(c){case "down":a=Math.floor(a);break;case "up":a=Math.ceil(a);break;case "half_even":var e=(a+"").split(".");c=e[0];e=e[1];a=5===(e?parseInt(e.charAt(0),10):0)?0===parseInt(c,10)%10%2?Math.floor(a):Math.ceil(a):Math.round(a);break;default:case "half_up":a=Math.round(a)}return a/b}return{add:function(d,e){d=a(d);e=a(e);var l=Math.pow(10,c(d,e));return(Math.round(d*l)+Math.round(e*
l))/l},subtract:function(d,e){d=a(d);e=a(e);var l=Math.pow(10,c(d,e));return(Math.round(d*l)-Math.round(e*l))/l},multiply:function(d,e){d=a(d);e=a(e);var l=Math.pow(10,c(d,e));return Math.round(d*l)*Math.round(e*l)/(l*l)},divide:function(d,e){d=a(d);e=a(e);var l=Math.pow(10,c(d,e));return Math.round(d*l)*(1/Math.round(e*l))},round:d,toDecimal:function(c){c=a(c);return d(100*c,0)/100},toInteger:function(a){return parseInt(a,10)||0}}}(),g=function(){return{arrayMove:function(a,c,d){var e=a.length;e&&
0<=c&&0<=d&&c<e&&d<e&&a.splice(d,0,a.splice(c,1)[0])},arrayIntersection:function(b,c){return!f.isArray(b)||!f.isArray(c)||a.objectIsEmpty(b)||a.objectIsEmpty(c)?[]:f.grep(b,function(a){return null===a?!1:-1<f.inArray(a,c)})}}}(),e=function(){return{parseTemplate:function(a,c){return a.replace(/\{([\w\.]*)\}/g,function(a,b){var d=b.split("."),e=c[d.shift()];if("undefined"===typeof e)return"";for(var f=0;f<d.length;f++)if(e=e[d[f]],"undefined"===typeof e||null===e)return"";return e})},filterNumeric:function(a){a=
a.replace(/[^0-9\-]/g,"").replace(/(?!^)\-/g,"");return"-"===a?"":a},interpretString:function(b){return"boolean"===typeof b||"number"===typeof b||""===a.trim(b)?b:isNaN(b)?"true"===b||"false"===b?"true"===b:b:Number(b)},parseQueryArguments:function(a,c){var d={};if("string"!==typeof a)return d;var e=a.split("?"),f=/&?([^=]+?)=([^&#]*)/g;if(2!==e.length)return d;for(var e=e[1],l,g;null!==(l=f.exec(e));)g=l[2],d[l[1]]=c?decodeURIComponent(g):g;return d},toFixedLength:function(a,c,d,e){a+="";if(a.length>
c)return a.substr(0,c);a.length<c&&(c=Array(c-a.length+1).join(d),a="right"===e?a+c:c+a);return a},extractFileNameFromFilePath:function(a){return a&&"string"===typeof a?a.replace(/^.*[\\\/]/,""):""}}}(),m=function(){return{renameProperty:function(a,c,d){if(!a.hasOwnProperty(c)||null===a[c])return!1;if(c===d)return!0;a[d]=a[c];delete a[c];return!0}}}(),k=function(){function a(b){return b.replace(c,".")}var c=/\._(.+)_\./g,d=/(.+?)\._(.+)_\.(.+)/,e=/(.+?)\.(jpg|png|gif|jpeg|bmp|ugc)(\?.*)?$/;return{clearStyleCode:a,
addStyleCode:function(c,l,f){if(!c)return"";if(!l)return c;f&&!d.test(c)&&(f=!1);f?"_"===l.charAt(0)&&(l=l.substr(1)):(c=a(c),l="."+l);return c.replace(e,"$1"+l+".$2$3")}}}(),q=function(){return{moveElToFront:function(a){0<a.index()&&a.parent().prepend(a)},toggleElements:function(a,c){return a&&a.length&&c&&c.length?(c.hide(),a.show(),!0):!1},scrollToElement:function(a,d,e){if(a.length){var g=f("html, body");a=a.offset().top-c.toInteger(e);d?g.animate({scrollTop:a},400):g.scrollTop(a)}},pruneChildElements:function(a,
d,e){d=c.toInteger(d);a=a.children(e?e:"");a.length<=d||a.slice(d).remove()},addImageStyleDimensions:function(b){var d=b.attr("data-src");if(d&&0===d.indexOf("http")){var e=c.toInteger(b.attr("width")),f=c.toInteger(b.attr("height")),g;a.capabilities.hires&&(e*=2,f*=2);0<e?g="_SX"+e+"_":0<f&&(g="_SY"+f+"_");g&&b.attr("data-src",k.addStyleCode(d,g))}},bindEventAndSuppressKey:function(a,c,d,e,f){if(!a||!c||!d)return!1;a.bind(c,function(a){(a.keyCode||a.which)===d&&(a.preventDefault(),e&&e(a));f&&f(a)})}}}(),
d=function(){return{isNumber:function(a){var c=a.keyCode||(a.$event?a.$event.keyCode:!1)||a;return!(a.shiftKey||a.$event&&a.$event.shiftKey)&&c>=h.keyCodes.num_zero&&c<=h.keyCodes.num_nine||c>=h.keyCodes.numpad_zero&&c<=h.keyCodes.numpad_nine?!0:!1},isArrowKey:function(a){a=a.keyCode||(a.$event?a.$event.keyCode:!1)||a;return a>=h.keyCodes.arrow_left&&a<=h.keyCodes.arrow_down?!0:!1}}}();return{constants:h,add:c.add,subtract:c.subtract,multiply:c.multiply,divide:c.divide,round:c.round,toDecimal:c.toDecimal,
toInteger:c.toInteger,arrayMove:g.arrayMove,arrayIntersection:g.arrayIntersection,parseTemplate:e.parseTemplate,filterNumeric:e.filterNumeric,interpretString:e.interpretString,extractFileNameFromFilePath:e.extractFileNameFromFilePath,renameProperty:m.renameProperty,parseQueryArguments:e.parseQueryArguments,toFixedLength:e.toFixedLength,moveElToFront:q.moveElToFront,toggleElements:q.toggleElements,scrollToElement:q.scrollToElement,pruneChildElements:q.pruneChildElements,addImageStyleDimensions:q.addImageStyleDimensions,
bindEventAndSuppressKey:q.bindEventAndSuppressKey,addImageStyleCode:k.addStyleCode,clearImageStyleCode:k.clearStyleCode,keyCodeIsNumber:d.isNumber,keyCodeIsArrowKey:d.isArrowKey}});k.when("A","gc-util").register("gc-validations",function(a,f){function h(c,b){return a.contains(c,b)}function c(a){return new RegExp("^"+a+"$","i")}var g=c("[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+(\\.[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+)*"),e=c("(([a-z0-9\\-]+\\.)+([a-z]{2,63}))"),m=c("[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+(\\.[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+)*@(([a-z0-9\\-]+\\.)+([a-z]{2,63}))"),
k=c("[\\s,]*[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+(\\.[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+)*@(([a-z0-9\\-]+\\.)+([a-z]{2,63}))((\\s*,\\s*)+[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+(\\.[\\w!#$%&'*+\\/=?\\^_`{|}~\\-]+)*@(([a-z0-9\\-]+\\.)+([a-z]{2,63})))*[\\s,]*"),q=c("([2-9][0-8][0-9])[-. ]?([2-9][0-9]{2})[-. ]?([0-9]{4})");return{notNull:function(a,b){return null!==a&&a!==w},notEmpty:function(a,b){return 0<(""+a).length},lengthAtMost:function(a,b){return(""+a).length<=b},lengthAtLeast:function(a,b){return(""+a).length>=
b},linesAtMost:function(c,b){for(var e=c.split("\n"),f=e.length,g=a.state("gc-validator-fields")["AmazonDownloadLineItem.message"][1].constraint,m=0;m<e.length;m++)f+=Math.max(Math.ceil(e[m].length/g),1)-1;return f<=b},linesLengthAtMost:function(a,b){return!0},atLeast:function(a,b){return a>=b},atMost:function(a,b){return a<=b},equal:function(a,b){return a===b},notEqual:function(a,b){return a!==b},contains:h,containsOne:function(a,b){return 2===(""+a).split(b).length},excludes:function(a,b){return!h(a,
b)},isNumeric:function(a,b){return!isNaN(a)},isInteger:function(a,b){return!isNaN(a)&&0===Number(a)%1},isBoolean:function(a,b){return"boolean"===typeof a||"string"===typeof a&&("true"===a||"false"===a)},isOneEmail:function(a,b){return 1===(""+a).split(/[\s,;]+/).length},isPositive:function(a,b){return 0<a},hasEmailLocal:function(a,b){var c=(""+a).split("@");return 1>c.length?!1:g.test(c[0])},hasEmailDomain:function(a,b){var c=(""+a).split("@");return 2>c.length?!1:e.test(c[1])},isValidEmail:function(a,
b){return m.test(""+a)},isCommaSeparatedEmailList:function(a,b){return k.test(""+a)},dateAtLeast:function(a,b){return a&&b&&a.getTime()>=b.getTime()},dateAtMost:function(a,b){return a&&b&&a.getTime()<=b.getTime()},isValidPhoneNumber:function(a,b){return q.test(""+a)}}});k.when("A","gc-util","gc-formatter","gc-string","gc-validations").register("gc-validator",function(a,f,h,c,g){function e(b){var c=a.state("gc-validator-fields");c.hasOwnProperty(b)||k.error("No validator field exists with the name: "+
b,"gc-validator","getFieldValidations");return c[b]}function m(a){switch(a){case "DateToday":return a=new Date,a=new Date(a.getFullYear(),a.getMonth(),a.getDate());case "DateNextYear":return a=new Date,a=new Date(a.getFullYear()+1,a.getMonth(),a.getDate())}}function r(b){return a.contains(b,"dynamic:")?(b=b.split(":")[1],m(b)):f.interpretString(b)}function q(a){var b=[];z.each(t,function(c,d){if(a.is(c))return b=d,!1});return b}function d(a){var b={};z.each(G,function(c,d){a.is(c)&&z.extend(b,d)});
return b}function b(a,b){var c=a.parent("div.a-input-text-wrapper");(c.length?c:a).toggleClass("a-form-error",!b)}function p(d,e,l,g,m,n){var p=z.extend({formatter:w,field:w,optional:!1,events:"change",formatEvents:w,addClass:!0,listField:!1},e),u="*"!==l,q=p.formatEvents||p.events;if("undefined"===typeof l||!u||a.contains(p.events,l)){"string"!==typeof p.field&&k.error("Field is required for validation","gc-validator","validateElement");e=d.val();var r=p.field,D=p.optional,C=p.addClass,y=p.formatter;
l=!u||a.contains(q,l);p=p.listField;d.is(":checkbox")&&(e=d.is(":checked"));if((q=""===a.trim(""+e))&&u||q&&D&&!g||m)return a.trigger("gc:validate:ignored",d,r),a.trigger("gc:validate:"+r+":ignored",d,n),C&&b(d,!0),-1;if("string"===typeof y){g=h.getFormatter(y);try{l&&d.val(g.format(e)),e=g.interpret(e)}catch(v){return C=c.getString(v),a.trigger("gc:validate:failure",d,r,e,[C]),a.trigger("gc:validate:"+r+":failure",d,e,[C],n),-1}}else e=f.interpretString(e);p&&(e=e.split(/[ ,\n;]+/));n=x(d,r,e,n,
p);C&&b(d,n);return n?1:0}}function x(b,c,d,l,g){a.trigger("gc:validate:before",b,c,d);a.trigger("gc:validate:"+c+":before",b,d);var m=[],n=e(c);if(y.length&&!f.arrayIntersection(n[0].validationGroups,y).length)return a.trigger("gc:validate:skipped",b,c,d),a.trigger("gc:validate:"+c+":skipped",b,d,l),!0;if(g)for(g=0;g<d.length;g++)u(d[g],n,m);else u(d,n,m);(n=0===m.length)?(a.trigger("gc:validate:success",b,c,d),a.trigger("gc:validate:"+c+":success",b,d,l)):(a.trigger("gc:validate:failure",b,c,d,
m),a.trigger("gc:validate:"+c+":failure",b,d,m,l));return n}function u(a,b,d){for(var e=0;e<b.length;e++){var l=b[e],f=a,m=d,n,p=l.validation;g.hasOwnProperty(p)||k.error("No validation method exists with the name: "+p,"gc-validator","getValidationMethod");n=g[p];p=r(l.constraint);n.call({},f,p)||(l=c.getString(l.errorId),l=h.interpolateMessage(l,p),m.push(l))}}function n(a,b){return l(a,b)}function l(b,c,d,e){var l=b.attr("data-gc-validate");if("string"===typeof l)return l=a.parseJSON(l),p(b,l,"*",
!!c,!!d,e)}function D(a){var b=!0;a.find("[data-gc-validate]").each(function(){b=0!==n(z(this))&&b});return b}function C(b,c){var d={};b.find("[data-gc-validate]").each(function(){var b=z(this),c;c=b.attr("data-gc-validate");"string"!==typeof c?c=null:(c=a.parseJSON(c),c=c.field);d.hasOwnProperty(c)||(d[c]=[]);d[c].push(b)});var e=!0,f=a.parseJSON(b.attr("data-gc-validate-form")||"{}").requireOne||[];z.each(d,function(a,d){var g=-1!==z.inArray(a,f),m;a:{m=q(b);for(var n=0;n<m.length;n++)if(-1!==a.indexOf(m[n])){m=
!0;break a}m=!1}for(var n=!1,p=d.length-1;0<=p;p--){var h=d[p];g?(h=l(h,0===p&&!n,m,c),n=n||1===h,e=0!==h&&e):e=0!==l(h,!1,m,c)&&e}});return e}function F(a,b){return a.is("form")?C(a,b):D(a)}function J(a){a=d(a);var b=!0;z.each(a,function(a,c){var d=c.call({});b=x(null,a,d)&&b});return b}function H(a){return function(){if(I)return a.apply(null,arguments);a.apply(null,arguments)}}var z=a.$,t={},G={},y=[],v=!1,I=!1,E=!0;a.declarative("gc-validate-form","submit",function(b){var c=b.$target,d=b.$event,
c=c.is("form")?c:c.closest("form"),e=!0;v&&d.preventDefault();if(E){c.removeAttr("gc-invalid");a.trigger("gc:validate:form:before",c);try{e=(e=F(c)&&e)&&J(c)}catch(l){throw d.preventDefault(),l;}e?a.trigger("gc:validate:form:success",c,d):(c.attr("gc-invalid",""),d.preventDefault(),a.trigger("gc:validate:form:failure",c));a.trigger("gc:validate:form:after",c)}else a.trigger("gc:validate:form:disabled",b)});a.on("gc:validate:form:upload",function(b){var c=!1;b.removeAttr("gc-invalid");a.trigger("gc:validate:form:before",
b);try{c=(c=F(b,!0))&&J(b)}catch(d){throw d;}c?a.trigger("gc:validate:form:success",b):(b.attr("gc-invalid",""),a.trigger("gc:validate:form:failure",b))});a.declarative("gc-validate","click change keydown keyup keypress",function(a){"object"===typeof a.data&&p(a.$target,a.data,a.type,!1,!1)});return{validate:H(n),validateWithin:H(F),validateVirtualField:function(a,b){d(a)[b]||k.error("No virtual field exists: "+b,"gc-validator","validateVirtualField");var c=d(a)[b].call({});x(null,b,c)},validateVirtualFields:H(J),
addVirtualField:function(a,b,c){G.hasOwnProperty(a)||(G[a]={});G[a][b]=c},setIgnoredFields:function(a,b){"string"===typeof b&&(b=[b]);t[a]=b},getValidationConstraint:function(a,b){for(var c=e(a),d=0;d<c.length;d++){var l=c[d];if(l.validation===b)return r(l.constraint)}k.error("Field "+a+" has no "+b+" validation","gc-validator","getValidationConstraint")},getDynamicConstraint:m,setEnabled:function(a){"boolean"===typeof a&&(E=a)},setValidationGroups:function(a){y=a},clearValidationGroups:function(){y=
[]},addValidationGroup:function(a){-1===z.inArray(a,y)&&y.push(a)},removeValidationGroup:function(a){a=z.inArray(a,y);-1<a&&y.splice(a,1)},getValidationGroups:function(){return y},getAlwaysPreventDefault:function(){return v},setAlwaysPreventDefault:function(a){v=a},getAlwaysReturnResult:function(){return I},setAlwaysReturnResult:function(a){I=a}}});k.register("gc-promise",function(){return function(a){function f(){m?setTimeout(function(){g(k)},0):q&&"function"===typeof e&&setTimeout(function(){e(d)},
0)}function h(a){m||q||(m=!0,k=a,f())}function c(a){m||q||(q=!0,d=a,f())}var g,e,m=!1,k,q=!1,d;setTimeout(function(){try{a(h,c)}catch(b){if("function"===typeof c)return c(b)}},0);return{then:function(a,c){if("function"!==typeof a)throw Error("callback is expected to be a function");g=a;e=c;f()}}}})});
(function(k){var t=window.AmazonUIPageJS||window.P,w=t._namespace||t.attributeErrors,a=w?w("PhysicalGiftCardsDetailPageAssets"):t;a.guardFatal?a.guardFatal(k)(a,window):a.execute(function(){k(a,window)})})(function(k,t,w){k.when("A","gc-execute","twister-view-registry","detailPage:RefreshHandler","gc-formatter").execute(function(a,f,h,c,g){function e(a){var c=p.currentDimCombID;if(typeof c!==w&&c.length){var d=x.inArray(b.currentAmount.toString(),b.dimensionValues[0]),c=c.split("_")[0];a=m(d,a);var e=
b.dimensionToAsinMap[a];b.getControllerInterface().handleClick(1,a.split("_")[1],"SWATCH");d!==c&&b.getControllerInterface().handleClick(0,a.split("_")[0],"DROPDOWN");"0"===q(e,0)&&k(b.currentAmount)}}function m(a,c){var d=a+"_"+c;if(b.dimensionToAsinMap[d])return d;if(a)return"0_"+c}function k(a){var b=[],d=c.getHandlerInstance("GiftCardCustomTwister");a=d.getURLParamObject("gpo",a,0);b.push(a);d.doPageRefresh(b)}function q(a,c){var d=b.dimensionAsinToValuesMap[a];return 0<d.length?d[c]:""}function d(a){a=
l.format(a);u.text(a);n.text(a)}var b,p,x=a.$,u=x("#gc-amount-dimension"),n=x("#gc-twister-swatch-button-list .gc-twister-swatch-button .twisterSlotDiv .a-size-mini"),l=g.getLocalizedFormatter("currency");b=h.createAndRegisterExternalView("GiftCardCustomTwister");p=b.twisterControllerHandle.twisterModel.twisterState;p.currentDimCombID.charAt(0);b.currentAmount=x("#gc-initial-vgc-amount").val();d(b.currentAmount);a.declarative("gc-select-design-swatch","click",function(a){a=a.$currentTarget.find("li").attr("id");
var b=a.lastIndexOf("_");a=a.substr(b+1);e(a)});a.declarative("gc-select-design-swatch-tablet","click",function(a){e(a.data.dimValueIndex)});a.on("a:dropdown:selected:gc_dropdown_selected_design_name",function(a){typeof a!==w&&typeof a.value!==w&&a.value.length&&(a=a.value.split(",")[0],e(a))});a.on("gc:validate:amount:success",function(a){var c=p.currentDimCombID;if(typeof c!==w&&c.length){var c=c.split("_")[1],e=x.inArray(a.toString(),b.dimensionValues[0]),c=m(e,c),e=b.dimensionToAsinMap[c];b.currentAmount=
a;b.getControllerInterface().handleClick(0,c.split("_")[0],"DROPDOWN");"0"===q(e,0)&&k(a);d(a)}})});k.when("A","ready").register("gc-amount-currency-symbol-utils",function(a){a=a.$;var f=a("#gc-order-form-custom-amount"),h=a("#gc-custom-amout-currency-symbol"),c=f.attr("placeholder");return{addCurrencySymbolToCustomValue:function(){f.addClass("gc-amount-padding");f.removeAttr("placeholder");h.removeClass("aok-hidden");h.addClass("gc-currency-symbol")},removeCurrencySymbolFromCustomValue:function(){f.removeClass("gc-amount-padding");
f.attr("placeholder",c);h.removeClass("gc-currency-symbol");h.addClass("aok-hidden")}}});k.when("A","gc-execute","ready").register("gc-validation-utils",function(a,f){var h=a.$,c=h("#gc-order-form-custom-amount");return{KEYDOWN_TIMEOUT:500,disableBuyBoxOptions:{triggerPopoverOnId:"gc-disable-atc",triggerPosition:"triggerLeft"},showPopover:!0,addInputErrorHighlighting:function(){c.addClass("gc-input-error")},removeInputErrorHighlighting:function(){c.removeClass("gc-input-error")}}});
k.when("A").execute(function(a){var f=a.$("#giftcardcustomtwister_feature_div");a=a.$("#gc-order-form-custom-amount");f.length&&a.length&&k.declare("gc-execute")});k.when("A","gc-execute","vgc-validation","gc-validation-utils","gc-amount-currency-symbol-utils","ready").execute(function(a,f,h,c,g){var e=a.$,m,k=c.KEYDOWN_TIMEOUT,q=e("#gc-amount-picker"),d=e("#gc-order-form-custom-amount"),b=e("#gc-order-form-amount");e("#gc-custom-amout-currency-symbol");d.focus(function(){q.find(".a-button-selected").removeClass("a-button-selected a-button-focus");
g.addCurrencySymbolToCustomValue()});d.keydown(function(a){var c=this;clearTimeout(m);m=setTimeout(function(){var a=e(c).val(),a=h.parseCustomInputAmount(a);""!==a&&b.val(a).trigger("change")},k)});d.blur(function(){var a=e(this).val(),a=h.parseCustomInputAmount(a);""===a&&(g.removeCurrencySymbolFromCustomValue(),b.val(a).trigger("change"))});a.declarative("gc-select-amount-swatch","click",function(a){b.val(a.$target.val()).trigger("change");g.removeCurrencySymbolFromCustomValue();d.val("")})});
k.when("A","gc-execute","gc-util","gc-validation-utils","gc-string","a-popover","ready").register("vgc-validation",function(a,f,h,c,g,e){function m(a,b){x.$amountWrapper.find(".gc-inline-error").remove();c.removeInputErrorHighlighting()}function k(){var a=d("#buybox");a.addClass("gc-buybox");a.append('<div id="gc-disable-atc"></div>');a.delegate("#gc-disable-atc","click mouseover",function(a){a.preventDefault();c.showPopover?(a=d("#"+c.disableBuyBoxOptions.triggerPopoverOnId),b=e.create(a,{inlineContent:'Select or input a valid <strong style="color:#e8281e">Amount</strong> to add to Shopping Cart',
width:200,position:c.disableBuyBoxOptions.triggerPosition,closeButton:!1})):(h.scrollToElement(x.$customAmount,!0,50),x.$customAmount.trigger("click"))})}function q(a){var b=p&&p.decimalSeparator||".",c=(a+"").split(b),d=c[0]||"",c=c[1]||"";2<c.length&&(a=d+b+c.substring(0,2));return a}var d=a.$,b,p=a.state("gc-formatter-config"),x={$customAmount:d("#gc-order-form-custom-amount"),$amountField:d("#gc-order-form-amount"),$amountWrapper:d("#gc-amount-wrapper"),$amountDimensionText:d("#gc-amount-dimension")},
u=d("#gc-tmpl-inline-error").html();d("#gc-tmpl-atc-error").html();a.on("gc:validate:success",function(c,l,f){if(null!==c){var g=x.$customAmount.val(),g=q(g);""!==x.$customAmount.val()&&x.$customAmount.val(g);"AmazonRetailLineItem.amount"===l&&a.trigger("gc:validate:amount:success",f);m(c,l);d("#buybox").removeClass("gc-buybox");d("#gc-disable-atc").remove();e.remove(b)}});a.on("gc:validate:failure",function(a,b,e,f){null!==a&&(m(a,b),a=d(h.parseTemplate(u,{message:f[0]})),b&&a.attr("gc-field",b),
c.addInputErrorHighlighting(),x.$amountWrapper.append(a),x.$amountDimensionText.text(""),k())});return{parseCustomInputAmount:q}});k.when("A","gc-execute").execute(function(a){a=a.$;a("#twister").delegate("input","keyup keypress",function(a){if(13===a.keyCode)return a.preventDefault(),!1})})});
/* ******** */
(function(e){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors,b=l?l("DetailPageOffersDPv2Assets"):g;b.guardFatal?b.guardFatal(e)(b,window):b.execute(function(){e(b,window)})})(function(e,g,l){e.when("A","jQuery","a-popover","cf").register("actionpanel-modified-popover",function(b,d,c){return function(f,e){function l(){b.on.scroll(function(){var a=c.get(f);if(a&&a.isActive()){var b=a.$container.get(0).getBoundingClientRect();if(0>b.bottom||0>b.right)a.attrs("originalFocus",null),
a.hide()}})}function p(){var a=d(e);m.popoverHandle=c.create(a,{closeButton:!1,closeButtonLabel:a.attr("data-close-button-label")||"close",position:"triggerBottom",name:f,popoverLabel:a.attr("data-popover-label")||f,width:"400",activate:b.capabilities.touch?"onmouseover":"onclick"});b.capabilities.touch&&a.bind("touchend",function(b){m.popoverHandle.isActive()||a.trigger("mouseenter")});b.on("a:popover:afterShow:"+f,q);b.on("a:popover:afterHide:"+f,r);b.on("a:popover:afterUpdatePosition:"+f,t)}function u(){k=
d("#actionPanelOverlay");if(!k.length){var a=document.createElement("div");h.length&&(a.id="actionPanelOverlay",k=d(a).addClass("action-panel-overlay").css({width:h.outerWidth(),top:h.position().top}).bind("touchend click",function(a){return!1}),h.append(a))}}function t(a){var b,c=a.popover.$trigger.get(0).getBoundingClientRect();b=g.pageYOffset?g.pageYOffset:"CSS1Compat"===(document.compatMode||"")?document.documentElement.scrollTop:document.body.scrollTop;var d=h.get(0).getBoundingClientRect().left+
8;a.popover.$container.css({top:c.top+b+"px",left:d+"px"})}function n(){var a=h.get(0).getBoundingClientRect();k.css("height",a.bottom-a.top+"px")}function q(a){n();k.show();a.popover.$container.hasClass("burj-action-panel-modified-popover")||a.popover.$container.addClass("burj-action-panel-modified-popover");a.popover.$trigger.trigger("ActionPanelModifiedPopover.showPopover",a)}function r(a){k.hide();a.popover.$trigger.trigger("ActionPanelModifiedPopover.hidePopover",a)}var h=d("#actionPanel"),k,
m=this;h.length&&(p(),u(),l(),d(g).resize(n))}});e.when("jQuery").register("action-panel",function(b){var d="ap-onetime ap-sns ap-deal ap-pospromo ap-mom ap-fresh ap-oos ap-b2brd ap-used ap-sampling".split(" ");return{setPanelState:function(c){if(c.mode){for(var f=b("#actionPanel"),e=0;e<d.length;e++)f.removeClass(d[e]);c="ap-"+c.mode;0<=b.inArray(c,d)&&f.addClass(c)}}}});e.when("jQuery","action-panel").register("toggleBB",function(b,d){return{init:function(){b('input[name="toggleBuyBox"]:radio').change(function(){var c=
b(this).attr("value");d.setPanelState({mode:c});"onetime"===c||"used"===c?b("#csffsFeaturecontainer").removeClass("a-hidden"):b("#csffsFeaturecontainer").addClass("a-hidden")})}}})});
/* ******** */
(function(f){var b=window.AmazonUIPageJS||window.P,c=b._namespace||b.attributeErrors,a=c?c("DetailPageBTFDPv2Assets"):b;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,b,c){f.when("jQuery","ready").register("btf-headings-burj",function(a){var b,c,g,h,n,k,l,p,m,q,e,d;f.when("page-refresh:page").execute(function(a){d=a});var t=function(){if(d&&d.config){var b=!1,c;for(c in d.config)if(d.config[c].affectedFeatures&&(a(d.config[c].affectedFeatures).each(function(c,
e){var d=a(e);"none"!==d.css("display")&&"1"!==d.css("opacity")&&(b=!0)}),b))return!0}return!1},r=function(){if(t())setTimeout(function(){r()},200);else{b=a(".prestige_beauty.burj-body #session-sims-feature");b.length&&(c=b.find("h2.a-carousel-heading").parent(),g=b.find(".a-column.a-span4.a-span-last.a-text-right"),c.length&&g.length&&(c.addClass("a-push2"),g.removeClass("a-span4"),g.addClass("a-span2")));h=a(".prestige_beauty.burj-body #purchase-sims-feature");h.length&&(n=h.find("h2.a-carousel-heading").parent(),
k=h.find(".a-column.a-span4.a-span-last.a-text-right"),n.length&&k.length&&(n.addClass("a-push2"),k.removeClass("a-span4"),k.addClass("a-span2")));l=a(".prestige_beauty.burj-body #cm_cr_dpwidget");p=l.find("h2");if(l.length&&p.length){var d=p.first();d.remove();l.prepend(d)}m=a(".burj-body #product-description-iframe");m.length&&m[0].contentDocument&&(q=a(m[0].contentDocument.documentElement),q.length&&(e=q.find("h2"),e.length&&(e.css("color","#333"),e.css("font-size","21px"),e.css("font-weight",
"normal"),e.css("font-family","arial, verdana, helvetica, sans-serif"))))}};return{styleBTFHeadings:r}})});
/* ******** */
(function(e){var h=window.AmazonUIPageJS||window.P,n=h._namespace||h.attributeErrors,a=n?n("DetailPagePInfoDPv2Assets"):h;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,h,n){e.when("jQuery","ready").register("burj-featurebullets",function(a){var f=!1,b,c,d=function(){c.fadeTo(200,.75,null,function(){f?(c.find(".closeFB").addClass("aok-hidden"),a("#featureBulletsPlaceholder").removeClass("FBplaceholder"),b.find(".a-vertical").addClass("collapsedFeatureBullets"),
a("#fbExpandableSection").removeClass("expanded"),c.removeClass("expandedFeatureBullets"),c.find("h1").removeClass("expandedFBHeader"),a(".fadeTextTopforFB").hide(),a(".fadeTextBottomforFB").hide(),b.find("#fbExpanderMoreButtonSection").show(),f=!1):(b.find(".a-vertical").removeClass("collapsedFeatureBullets"),c.addClass("expandedFeatureBullets"),a("#fbExpandableSection").addClass("expanded"),c.find("h1").addClass("expandedFBHeader"),a("#featureBulletsPlaceholder").addClass("FBplaceholder"),b.find("#fbExpanderMoreButtonSection").hide(),
a("#feature-bullets")[0].offsetHeight<a("#feature-bullets")[0].scrollHeight&&(a(".fadeTextTopforFB").show(),a(".fadeTextBottomforFB").show()),c.find(".closeFB").removeClass("aok-hidden"),f=!0);c.fadeTo(200,1)})};return{init:function(){b=a("#feature-bullets");c=a("#fbSection");a(".fadeTextTopforFB").hide();a(".fadeTextBottomforFB").hide();var k=a("#fbExpandableSection"),g=a("#fbExpandableSectionContent");g.height()>k.height()&&(g.addClass("expandableSection"),g.click(function(){d()}),a("#fbExpanderMoreButtonSection").removeClass("aok-hidden"),
b.find(".moreFB").click(function(){d()}),c.find(".closeFB").click(function(){d()}),c.hover(null,function(){f&&d()}))}}});e.when("jQuery","atf").register("title-burj",function(a){var f,b,c,d,k,g,q,n,r,l,m,p,u,v=function(){k.text(g);if(m&&f.height()<b.height()){l.removeClass("aok-hidden");if(r){n=g;for(var a=0,d=g.length-1;a<d;){k.text(g);var e=g,h=a+Math.floor((d-a)/2),p=e.indexOf(" ",h),e=e.substring(0,-1!==p?p:e.length-1);k.text(e+"...");f.height()<b.height()?d=h-1:(a=h+1,n=k.text())}r=!1}k.text(n);
c.addClass("showPointerOnHover");q=!0}else m&&(l.addClass("aok-hidden"),c.removeClass("showPointerOnHover"),q=!1)},t=function(){if(q){var a=f.position().top;b.fadeTo(200,.75,function(){m?(u(),l.removeClass("expand").addClass("collapse titleToggleClickedState"),f.addClass("expandedTitle"),b.css("top",a),d.css("top",a-8)):(p(),l.removeClass("collapse").addClass("expand titleToggleClickedState"),f.removeClass("expandedTitle"),b.css("top",""),d.css("top",""));m=!m;v();d.height(b.height()+16);b.fadeTo(200,
1,function(){l.removeClass("titleToggleClickedState")})})}},x=function(){m||t()},w=function(){r=!0;v()};return{init:function(){f=a("#title_feature_div");b=a("#titleSection");c=a("#title");d=a("#titleOverlay");k=a("#productTitle");g=k.text();q=!1;m=!0;l=a("#expandTitleToggle");e.when("A","a-tooltip","atf").execute(function(a,b){p=function(){b.create(l,{content:a.state("titleExpanderTooltipState").content,position:"triggerTop"})};u=function(){b.remove(l)};m&&p()});a("#socialFabric").append(a('<hr class="a-spacing-medium a-divider-normal">'));
w();a(h).resize(w);c.click(t);l.click(t);b.hover(null,x)}}})});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,g=c._namespace||c.attributeErrors,a=g?g("DetailPageTwisterDPv2Assets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,g){e.when("A","jQuery","a-popover","cf").register("burj-twister-utils",function(a,d,e){var b;return{getActivePopover:function(){b||(b=d("#twister").find("[id^=vodd-button-]"));var a=null;b.length&&b.each(function(d,c){var b=c.id.split("vodd-button-");if((b=e.get("vodd-popover-"+b[b.length-
1]))&&b.isActive())return a=b,!1});return a},getPageOffset:function(){var b,a;c.pageYOffset?(b=c.pageYOffset,a=c.pageXOffset):"CSS1Compat"===(document.compatMode||"")?(b=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):(b=document.body.scrollTop,a=document.body.scrollLeft);return{top:b,left:a}}}});e.when("A","jQuery","a-popover","burj-twister-utils","cf").execute(function(a,d,e,b){function g(){a.on.scroll(function(){var a=b.getActivePopover();if(a){var c=h.get(0).getBoundingClientRect(),
d=a.$container.get(0).getBoundingClientRect();0>c.bottom&&0>d.bottom&&(a.attrs("originalFocus",null),a.hide())}})}function l(){var a=m.offset().top+m.height()-f.offset().top,b=f.height()-a;d("#twisterOverlay").css({height:b+"px",top:a+"px"})}function n(){var a=document.createElement("div");a.id="twisterOverlay";d(a).addClass("twister-overlay").css({width:f.outerWidth()}).bind("touchend click",function(a){return!1});f.append(a)}function p(a,b){l();f.addClass("twister-popover-visible");d("#twisterOverlay").show()}
function q(a,b){f.removeClass("twister-popover-visible");d("#twisterOverlay").hide()}var f=d("#actionPanel"),m=f.find("#twister_feature_div"),h=d(".burj #twister"),k;(function(){if(h.length&&(k=h.find("[id^=vodd-button-]"),k.length)){n();var e=function(){b.getActivePopover()&&l()};a.on("a:pageUpdate",e);d(c).resize(e);k.bind("TwisterVODD.showPopup",p).bind("TwisterVODD.hidePopup",q);g()}})()})});
/* ******** */
(function(e){var d=window.AmazonUIPageJS||window.P,g=d._namespace||d.attributeErrors,a=g?g("BadgingMessagingAssets"):d;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,d,g){e.when("A").register("PromiseBasedBadgeCutoff",function(a){function e(b,a,f,d){a=Math.floor(f-a);if(0>=a||!d())return null;var c={hours:Math.floor(a/3600),minutes:Math.floor(a%3600/60),seconds:a%60};d="";d=1<c.hours?1<c.minutes?b.hoursMinutes:1===c.minutes?b.hoursMinute:b.hours:1===c.hours?
1<c.minutes?b.hourMinutes:1===c.minutes?b.hourMinute:b.hour:1<c.minutes?b.minutes:0<c.minutes?b.minute:1<c.seconds?b.seconds:b.second;return d.replace(/{{hours}}|{{minutes}}|{{seconds}}/gi,function(a){return c[a.substring(2,a.length-2)]})}function d(a,e,f){null===a?e():f(a)}return{_calculateNewMessage:e,_messageUpdater:d,run:function(b,g,f,h){var c=0,k=a.state(f);k&&k.timerId&&clearTimeout(k.timerId);var p=function(){return 0!==a.$(f).length},m=function(b){a.$(h).html("");clearTimeout(c)},l=function(b){a.$(f).html(b)},
k=function(){var a=Math.floor((new Date).getTime()/1E3),a=e(b,a,g,p);d(a,m,l)},c=setInterval(k,1E3);k();a.state(f,{timerId:c})}}});e.when("PromiseBasedBadgeCutoff","A","ready").execute(function(a,d){d.$(".promiseBasedBadgeWrapper").each(function(e,b){var g=d.$(this).data("template"),f=d.$(this).data("cutoff"),h=d.$(this).data("willBeHidden");a.run(g,f,this,h)})})});
/* ******** */
(function(p){var q=window.AmazonUIPageJS||window.P,t=q._namespace||q.attributeErrors,e=t?t("ReplacementPartsAssets"):q;e.guardFatal?e.guardFatal(p)(e,window):e.execute(function(){p(e,window)})})(function(p,q,t){p.now("jQuery-ReplacementPartsAutocomplete").execute(function(e){"undefined"===typeof e&&p.when("jQuery").register("jQuery-ReplacementPartsAutocomplete",function(b){b.rppAutocomplete=function(e,f){function l(){K={data:{},length:0}}function d(a,b){b&&a&&f.cacheLength&&(!K.length||K.length>f.cacheLength?
(l(),K.length++):K[a]||K.length++,K.data[a]=b)}function c(){if(!T){T=!0;I&&clearTimeout(I);var a=A.removeClass(f.loadingClass).val();L.is(":visible")&&h();f.mustMatch&&(e.lastSelected&&e.lastSelected===a||k(null));T=!1}}function m(a){var c=b("li",E);c&&(F+=a,0>F?F=0:F>=c.size()&&(F=c.size()-1),c.removeClass("hsx-rpp-ac-over"),b(c[F]).addClass("hsx-rpp-ac-over"))}function a(){var a=b("li.hsx-rpp-ac-over",E)[0];if(!a){var c=b("li",E);f.selectOnly?1===c.length&&(a=c[0]):f.selectFirst&&(a=c[0])}return a&&
"fuzzyMatchMessage"!==b.trim(a.selectValue?a.selectValue:a.innerHTML)?(k(a),!0):!1}function k(a){a||(a=document.createElement("li"),a.extra=[],a.selectValue="");var k=b.trim(a.selectValue?a.selectValue:a.innerHTML),h=A.val();Q=e.lastSelected=k;L.html("");A.val(k);c();f.onItemSelect&&setTimeout(function(){f.onItemSelect(a,h,k,S,U[k])},1)}function h(){L.hide();if("function"===typeof f.onResultsHide)f.onResultsHide(L[0]);f.resultsId&&L.removeAttr("id")}function r(a){var c=document.createElement("span");
c.innerHTML="undefined"!==typeof a?a+"<br>":Z+"<br>";a=document.createElement("div");b(a).addClass("hsx-rpp-ac-summary");a.appendChild(c);return a}function g(a,k,h,g,d){if(k){A.removeClass(f.loadingClass);if("undefined"===typeof d||!1===d)if(V&&0!==k.length)E.innerHTML="";else return c();else if(0===k.length)return;f.showCountOfResults&&E.appendChild(r(g));b.browser.msie&&L.append(document.createElement("iframe"));E.appendChild(x(a,k,h));f.autoFill&&A.val().toLowerCase()===a.toLowerCase()?(k=k[0][0],
8!==N&&(A.val(A.val()+k.substring(Q.length)),a=Q.length,k=k.length,h=A.get(0),h.createTextRange?(g=h.createTextRange(),g.collapse(!0),g.moveStart("character",a),g.moveEnd("character",k),g.select()):h.setSelectionRange?h.setSelectionRange(a,k):h.selectionStart&&(h.selectionStart=a,h.selectionEnd=k),h.focus())):f.selectFirst&&b("li:first",E).addClass("hsx-rpp-ac-over");f.fuzzyMatchHasResultCallBack&&f.fuzzyMatchHasResultCallBack(A.val());a=f.popupParent||A;h=a.offset();for(k=0;a.length&&!a.is("body");){g=
a.css("z-index");if((g=parseInt(g,99))||!isNaN(g))k=Math.max(g,k);a=a.offsetParent()}a=Math.ceil(h.left);h=Math.ceil(h.top);k+=10;g=0<f.width?f.width:f.popupParent?f.popupParent.innerWidth():A.innerWidth();d=f.popupParent?f.popupParent.innerHeight():A.outerHeight();L.css({width:parseInt(g,50)+"px",top:h+d+"px",left:a+"px","z-index":k});f.resultsId&&L.attr("id",f.resultsId);L.show();if("function"===typeof f.onResultsShow)f.onResultsShow(L[0])}else c()}function y(a){if(!a)return null;if(a&&a.hits&&
a.hits.hits)return M(a.hits.hits,!1);if(a&&a.hits&&a.hits.hit){for(var b=[],c=[],k=0;k<a.hits.hit.length;k++){var h;if(f.displayValueFields){h="";for(var g=0;g<f.displayValueFields.length;g++){var d=f.displayValueFields[g];"undefined"!==typeof a.hits.hit[k].fields[d]&&(h+=a.hits.hit[k].fields[d]+" ")}h=h.trim()}else h=a.hits.hit[k].fields.modelnumber;c[h]===t&&(c[h]=h,U[h]=a.hits.hit[k].fields,W.push(h),b[b.length]=[h])}return b}}function u(a,b){var c="";a.hasOwnProperty(b)&&(c=a[b]);return c}function B(a,
b){var c;"undefined"!==typeof a._source[b]&&(c=a._source[b]+" ");return c}function M(a,b){for(var c={series:"normalized_series",modelnumber:"normalized_model"},k=[],h=[],g=0;g<a.length;g++){var d,r;if(f.displayValueFields){d="";for(r=0;r<f.displayValueFields.length;r++){var e=c[f.displayValueFields[r]];d=!0===b?d+" "+u(a[g],e):d+B(a[g],e)}d=d.trim()}else d=!0===b?d+u(a[g],"normalized_model"):d+B(a[g],"normalized_model");r=!0===b?a[g]:a[g]._source;h[d]===t&&(h[d]=d,U[d]=r,W.push(d),k[k.length]=[d])}return k}
function x(a,c,h){var g=document.createElement("ul"),d=c.length;0<f.maxItemsToShow&&f.maxItemsToShow<d&&(d=f.maxItemsToShow);if(S=h)h=document.createElement("li"),h.innerHTML="<div class='a-size-base' style='margin-top:5px;margin-bottom:5px;cursor:normal'>'"+a.toUpperCase()+"' not found.<br>Did you mean:<div>",h.selectValue="fuzzyMatchMessage",h.extra=null,g.appendChild(h);for(var r=0;r<d;r++){var e=c[r];if(e){h=document.createElement("li");h.innerHTML=f.formatItem?f.formatItem(e,r,d):e[0];h.selectValue=
e[0];a=null;if(1<e.length){a=[];for(var m=1;m<e.length;m++)a[a.length]=e[m]}h.extra=a;g.appendChild(h);b(h).hover(function(){b("li",g).removeClass("hsx-rpp-ac-over");b(this).addClass("hsx-rpp-ac-over");F=b("li",g).indexOf(b(this).get(0))},function(){b(this).removeClass("hsx-rpp-ac-over")}).click(function(a){a.preventDefault();a.stopPropagation();k(this)})}}b(g).mousedown(function(){Y=!0}).mouseup(function(){Y=!1});return g}function R(a){f.matchCase||(a=a.toLowerCase());if("string"===typeof f.url&&
0<f.url.length){G+=1;65E3<=G&&(G=0);if(f.onRequestData)f.onRequestData(a);var c=G;f.recordCSMCounterMetric("LookForWholegoodsAttempt");f.recordCSMCounterMetric("DataQueryAjaxCall");b.get(J(a),function(b,k){"success"===k?(f.recordCSMCounterMetric("DataQueryAjaxCallSuccess"),z(a,b,c)):f.recordCSMCounterMetric("DataQueryAjaxCallFail")})}else A.removeClass(f.loadingClass)}function z(a,b,c){var k=!1,g=[],d=[];if("undefined"!==typeof b&&"undefined"!==typeof b.myModels&&"undefined"!==typeof b.myModels.data&&
0<b.myModels.data.length){var r=M(b.myModels.data,!0),g=p(a,r);v(a,g,g.length,c,ca);0<g.length&&(k=!0)}"undefined"!==typeof b&&"undefined"!==typeof b.popularModels&&"undefined"!==typeof b.popularModels.data&&0<b.popularModels.data.length&&(r=M(b.popularModels.data,!0),d=p(a,r),d=w(d,g),d.sort(),v(a,d,d.length,c,"Popular Models",k),0<d.length&&(k=!0));r=y(b);if("undefined"!==typeof r&&0<r.length){r=w(r,g.concat(d));da=b=b.hits&&"undefined"!==typeof b.hits.found?b.hits.found:b.hits.total;var e;f.showCountOfResults&&
(e=r.length,g=b,e=parseInt(e,10),g=parseInt(g,10),d=parseInt(f.maxItemsToShow,10),e=Z=g<d?ea.replace("{count}",e).replace("{total}",e):0<d&&d<e?ea.replace("{count}",d).replace("{total}",g):ea.replace("{count}",e).replace("{total}",g));v(a,r,b,c,e,k);f.recordCSMCounterMetric("LookForWholegoodsAttemptSucceed")}else k||h(),a&&f.recordCSMCounterMetric("LookForWholegoodsAttemptFail"),da=0}function w(a,b){var c,k=[];for(c=0;c<a.length;c++){var h;a:{h=void 0;for(h=0;h<b.length;h++)if(b[h][0]===a[c][0]){h=
!0;break a}h=!1}h||(k[k.length]=a[c])}return k}function p(a,b){var c=[];if("undefined"!==typeof b&&0<b.length)for(var k=0;k<b.length;k++){var h=b[k],g=!1;"undefined"!==typeof h&&0<h.length&&h[0].match(new RegExp(a,"gi"))&&(g=!0);g&&(c[c.length]=b[k])}return c}function v(a,b,c,k,h,d){k===G&&(b&&null!==b&&0<b.length?g(a,b,!1,h,d):f.doFuzzyMatch&&f.fuzzyMatchUrl&&null!==f.fuzzyMatchUrl?q(a,k):g(a,b,!1,h,d))}function q(a,c){f.recordCSMCounterMetric("LookForWholegoodsAttempt");f.recordCSMCounterMetric("DataQueryAjaxCall");
b.get(H(a),function(b,k){if("success"===k){f.recordCSMCounterMetric("DataQueryAjaxCallSuccess");var h;if(h=b){var d=[];if(h&&h.suggest&&h.suggest.suggestions)for(var r=[],e=0;e<h.suggest.suggestions.length;e++)r[h.suggest.suggestions[e].suggestion]===t&&(r[h.suggest.suggestions[e].suggestion]=h.suggest.suggestions[e].suggestion,d[d.length]=[h.suggest.suggestions[e].suggestion]);h=d}else h=null;c===G&&(h&&null!==h&&0<h.length?(f.recordCSMCounterMetric("LookForWholegoodsAttemptSucceed"),g(a,h,!0)):
f.fuzzyMatchNoResultCallBack&&f.fuzzyMatchNoResultCallBack(A.val()))}else f.recordCSMCounterMetric("DataQueryAjaxCallFail")})}function H(a){var b=-1===f.fuzzyMatchUrl.indexOf("?")?"?":"&";a=f.fuzzyMatchUrl+b+f.queryParam+"="+encodeURI(a);if(f&&f.extraParams)for(var c in f.extraParams)f.extraParams.hasOwnProperty(c)&&(a+="&"+c+"="+encodeURI(f.extraParams[c]));return a}function J(a){var b=-1===f.url.indexOf("?")?"?":"&";a=f.url+b+f.queryParam+"="+encodeURI(a);if(f&&f.extraParams)for(var c in f.extraParams)f.extraParams.hasOwnProperty(c)&&
(a+="&"+c+"="+encodeURI(f.extraParams[c]));return a}function C(a,b){b&&A.removeClass(f.loadingClass);for(var c=b?b.length:0,k=null,h=0;h<c;h++){var g=b[h];if(g[0].toLowerCase()===a.toLowerCase()){k=document.createElement("li");k.innerHTML=f.formatItem?f.formatItem(g,h,c):g[0];k.selectValue=g[0];var d=null;if(1<g.length)for(var d=[],r=1;r<g.length;r++)d[d.length]=g[r];k.extra=d}}f.onFindValue&&setTimeout(function(){f.onFindValue(k)},1)}var A=b(e).attr("autocomplete","off"),G=1;f.inputClass&&A.addClass(f.inputClass);
var E=document.createElement("div"),L=b(E).hide().addClass(f.resultsClass).css("position","absolute");0<f.width&&L.css("width",f.width);b("body").append(E);e.autocompleter=this;var I=null,Q="",F=-1,K={},V=!1,N=null,Y=!1,T=!1,S=!1,U={},W=[],Z="",ea=b("#summaryMessageString").text().trim(),ca=b("#myModelsHeaderString").text().trim();ca||(ca="Recently Searched Models");var da=0;l();if(null!==f.data){var aa="",P={},ba=[];"string"!==typeof f.url&&(f.cacheLength=1);for(var X=0;X<f.data.length;X++)ba="string"===
typeof f.data[X]?[f.data[X]]:f.data[X],0<ba[0].length&&(aa=ba[0].substring(0,1).toLowerCase(),P[aa]||(P[aa]=[]),P[aa].push(ba));if(P)for(var fa in P)P.hasOwnProperty(fa)&&(f.cacheLength++,d(fa,P[fa]))}A.keydown(function(b){N=b.keyCode;switch(b.keyCode){case 38:b.preventDefault();m(-1);break;case 40:b.preventDefault();m(1);break;case 9:case 13:a()&&(A.get(0).blur(),b.preventDefault());break;case 16:case 17:case 18:break;default:F=-1,I&&clearTimeout(I),I=setTimeout(function(){(46===N||8<N&&32>N)&&h();
var a=A.val();a!==Q&&(Q=a,a.length>=f.minChars?(A.addClass(f.loadingClass),R(a)):(A.removeClass(f.loadingClass),h()))},f.delay)}}).focus(function(){V=!0}).blur(function(){V=!1;Y||(I&&clearTimeout(I),I=setTimeout(c,200))});c();f.focus&&A.focus();this.triggerFuzzyMatch=function(){A.focus();q(A.val(),G)};this.flushCache=function(){l()};this.setExtraParams=function(a){f.extraParams=a};this.handleReceiveData=function(a,b){V=!0;z(a,b,G)};this.getResultCount=function(){return da};this.findValue=function(){var a=
A.val();f.matchCase||(a=a.toLowerCase());"string"===typeof f.url&&0<f.url.length?b.get(J(a),function(b){b=y(b);C(a,b)}):C(a,null)};return this};b.fn.rppAutocomplete=function(e,f,l){f=f||{};f.url=e;f.data="object"===typeof l&&l.constructor===Array?l:null;f=b.extend({autoFill:!1,cacheLength:1,cellSeparator:"|",delay:400,extraParams:{},focus:!1,inputClass:"hsx-rpp-ac-input",lineSeparator:"\n",loadingClass:"",matchCase:0,matchSubset:1,matchContains:0,maxItemsToShow:-1,minChars:1,mustMatch:0,onResultsShow:null,
onResultsHide:null,popupParent:null,queryParam:"q",doFuzzyMatch:!1,fuzzyMatchUrl:null,fuzzyMatchHasResultCallBack:null,fuzzyMatchNoResultCallBack:null,resultsClass:"hsx-rpp-ac-results",resultsId:null,selectFirst:!1,selectOnly:!1,showCountOfResults:!1,width:0},f);f.width=parseInt(f.width,10);f.popupParent&&(f.popupParent=b(f.popupParent),0===f.popupParent.length&&(f.popupParent=null));var d=[];this.each(function(c){d[c]=new b.rppAutocomplete(this,f)});return d};b.fn.rppAutocompleteArray=function(b,
e){return this.rppAutocomplete(null,e,b)};b.fn.indexOf=function(b){for(var e=0;e<this.length;e++)if(this[e]===b)return e;return-1};return b.rppAutocomplete})});p.now("HSXMetricsLogger").execute(function(e){"undefined"===typeof e&&p.when("A","HSXSushiLogger","HSXCSMLogger").register("HSXMetricsLogger",function(b,e,f){var l=e.createLogger(),d=function(a,c,h){var d=b.state("rpp"),g=q.ue;if(!b.objectIsEmpty(g)){var e=q.ue_mid,m=q.ue_sid,g=g.rid;h||(h={});if(d){d.finderName&&(h.finderName=
d.finderName);d.pageType&&(h.pageType=d.pageType);d.browseNode&&(h.browseNode=d.browseNode);d.ptd&&(h.ptd=d.ptd);d.category&&(h.category=d.category);d.weblabName&&(h.weblabName=d.weblabName);d.weblabTreatment&&(h.weblabTreatment=d.weblabTreatment);if(d.stripeParams){var f=h,M=d.stripeParams.scope,x="default";-1!==["inkandtoner","personalcomputers","camera","tools"].indexOf(M)&&(x=M);f.scope=x}d.asin&&!h.asin&&(h.asin=d.asin);d.modelBrand&&!h.modelBrand&&(h.modelBrand=d.modelBrand);d.modelSeries&&
!h.modelSeries&&(h.modelSeries=d.modelSeries);d.modelNumber&&!h.modelNumber&&(h.modelNumber=d.modelNumber)}h.marketplaceId=e;h.requestId=g;h.session=m;h.deviceType="desktop";h.featureName=a;h.action=c;l.recordMetrics(h)}},c=function(a,b){f.incrementCounterMetrics(a+b)},m=function(a,b){f.recordErrorMetrics(a,b)};return{createLogger:function(){return{emitMetrics:d,emitCSMCounterMetrics:c,emitCSMJSErrorMetrics:m}}}})});p.now("HSXSushiLogger").execute(function(e){"undefined"===typeof e&&
p.when("A").register("HSXSushiLogger",function(b){var e,f=function(f){if(!b.objectIsEmpty(f)&&f.marketplaceId){var d={};switch(f.marketplaceId){case "A1F83G8C2ARO7P":case "A13V1IB3VIYZZH":case "APJ6JRA9NG5V4":case "A1RKKUPIHCS9HS":case "A1PA6795UKMFR9":case "A21TJRUUN4KGV":d.endpoint="unagi-eu.amazon.com";d.sourceGroup="com.amazon.hsx.eel.eu";break;case "A1VC38T7YXB528":d.endpoint="unagi-fe.amazon.com";d.sourceGroup="com.amazon.hsx.eel.fe";break;case "AAHKV2X7AFYLW":d.endpoint="unagi-cn.amazon.com";
d.sourceGroup="com.amazon.hsx.eel.cn";break;default:d.endpoint="unagi-na.amazon.com",d.sourceGroup="com.amazon.hsx.eel.na"}b.$.post("https://"+d.endpoint+"/1/events/"+(e?e:d.sourceGroup),JSON.stringify({events:[{data:f}]}),null,"application/json")}};return{createLogger:function(b){b&&(e=b);return{recordMetrics:f}}}})});p.when("ready").register("HSXCSMLogger",function(){var e={};e.ue=q.ue;e.ueLogError=q.ueLogError;e.errorLogLevel={ERROR:"ERROR",FATAL:"FATAL",WARN:"WARN"};e.incrementCounterMetrics=
function(b){e.ue&&e.ue.count&&e.ue.count(b,(e.ue.count(b)||0)+1)};e.recordErrorMetrics=function(b,n){e.ueLogError&&b&&(n?e.ueLogError(b,n):e.ueLogError(b))};return e});p.now("ReplacementPartsStripeModelHelpModule").execute(function(e){"undefined"===typeof e&&p.when("A","a-popover","a-dropdown","jQuery","ready").register("ReplacementPartsStripeModelHelpModule",function(b,e,f,l){var d={config:{imageCdn:"https://images-na.ssl-images-amazon.com/images/G/01/replacement-parts/",videoConfigUrl:"/gp/replacement-parts/ajax/modelnumber-help-videos.html",
videoCdn:"https://images-na.ssl-images-amazon.com/images/I/",videoImageUrl:"https://images-na.ssl-images-amazon.com/images/I/518MvDgpM3L.jpg",videoPlayerSwf:"https://images-na.ssl-images-amazon.com/images/G/01/vap/video/airy2/prod/2.0.1102.0/flash/AiryBasicRenderer._V304902271_.swf",modelHelpContentUrl:"/gp/replacement-parts/ajax/modelnumber-help-content.html"}};d.helpMeFindModelNumber=d.helpMeFindModelNumber||{};d.helpMeFindModelNumber.videoPlayer=null;d.helpMeFindModelNumber.videosInfo={};d.helpMeFindModelNumber.data=
{major_appliance:{modelHelpVersion:"v1",displayText:"Major Appliance",subCategoryDisplayName:"Sub Category",subcategory:{refrigerator:{displayText:"Refrigerator",filter:{side_by_side:{displayText:"Side by Side",videoId:"B1BHS+SwL3S.mp4|B1t17BkYLqS.mp4|C1ckoC44s8S.mp4"},freezer_on_top:{displayText:"Freezer on Top",videoId:"B1BHS+SwL3S.mp4|B1t17BkYLqS.mp4|C1ckoC44s8S.mp4"}}},washer_dryer_combo:{displayText:"Washer/Dryer Combo",filter:{top_load:{displayText:"Top Load",videoId:"B1NV84bJRZS.mp4|B1O9OfJcquS.mp4|C1FgSig7xtS.mp4"},
front_load:{displayText:"Front Load",videoId:"B1NV84bJRZS.mp4|B1O9OfJcquS.mp4|C1FgSig7xtS.mp4"}}},washing_machine:{displayText:"Washing Machine",filter:{top_load:{displayText:"Top Load",videoId:"B1KN9u9AyXS.mp4|B12qf+slWKS.mp4|C1PtbxowzTS.mp4"},front_load:{displayText:"Front Load",videoId:"B1KN9u9AyXS.mp4|B12qf+slWKS.mp4|C1PtbxowzTS.mp4"}}},freezer_chest:{displayText:"Freezer Chest",videoId:"B1bpnTS3nmS.mp4|B1lISbDh0RS.mp4|C122snPACDS.mp4"},freezer_upright:{displayText:"Freezer Upright",videoId:"B1bpnTS3nmS.mp4|B1lISbDh0RS.mp4|C122snPACDS.mp4"},
dishwasher:{displayText:"Dishwasher",videoId:"B1Yimrnp+FS.mp4|B1yfKJE2PIS.mp4|C14jp+jQllS.mp4"},dryer_old_style_old_style:{displayText:"Dryer(Old Style)",videoId:"B1q5XSVe3FS.mp4|B1fpb0srS-S.mp4|C1GO2PIkcmS.mp4"},dryer_new_style:{displayText:"Dryer(New Style)",videoId:"B1q5XSVe3FS.mp4|B1fpb0srS-S.mp4|C1GO2PIkcmS.mp4"},ice_machine:{displayText:"Ice Machine",videoId:"B1A6XweWNyS.mp4|B1fEU5bQZhS.mp4|C1EiQCtRb-S.mp4"},microwave_counter:{displayText:"Microwave(Counter Top)",videoId:"B1Z8AxKsTvS.mp4|B18Vd0H4zpS.mp4|C1S4YpC6dyS.mp4"},
oven_micro_combo:{displayText:"Oven/Micro. Combo",videoId:"B1EwTA+7JWS.mp4|B1xvsCZdlLS.mp4|C102gmDSmwS.mp4"},range_vent_hood:{displayText:"Range Vent Hood",videoId:"B1USJPSddQS.mp4|B1Bx1yFOZiS.mp4|C100PtfQCUS.mp4"},range_stove_oven:{displayText:"Range/Stove/Oven",videoId:"B1EwTA+7JWS.mp4|B1xvsCZdlLS.mp4|C102gmDSmwS.mp4"},trash_compactor:{displayText:"Trash Compactor",videoId:"B129JbJSLxS.mp4|B1CKZ1d3chS.mp4|C1GYzQsBbYS.mp4"},water_filter:{displayText:"Water Filter",videoId:"B1zEJ9x9DfS.mp4|B1AK+9PxKvS.mp4|C1KdPxNR3rS.mp4"},
hot_water_dispenser:{displayText:"Hot Water Dispenser",videoId:"B13gGvGg6eS.mp4|B1e8R-P5LeS.mp4|C17ZviPXJTS.mp4"},garbage_disposer:{displayText:"Garbage Disposer",videoId:"B18MdNOMMoS.mp4|B1Hhbgw9TwS.mp4|C1fVN5e-hgS.mp4"},water_heater:{displayText:"Water Heater"}}},outdoor_power:{modelHelpVersion:"v1",displayText:"Outdoor Power",subCategoryDisplayName:"Sub Category",subcategory:{chainsaw:{displayText:"Chainsaw"},edger:{displayText:"Edger"},hedge_trimmer:{displayText:"Hedge Trimmer"},lawn_mower:{displayText:"Lawn Mower",
filter:{push:{displayText:"Push"},tractor:{displayText:"Tractor"},zero_turn:{displayText:"Zero Turn"}}},leaf_blower:{displayText:"Leaf Blower"},pole_pruner:{displayText:"Pole Pruner"},pressure_washer:{displayText:"Pressure Washer"},small_engine:{displayText:"Small Engine"},snow_blower:{displayText:"Snow Blower"},string_trimmer:{displayText:"String Trimmer"},tiller:{displayText:"Tiller",filter:{large:{displayText:"Large"},small:{displayText:"Small"}}}}},PowerTools:{modelHelpVersion:"v2",hasLeftPanelContent:!0,
displayText:"Power Tools",subCategoryDisplayName:"Brand",subcategory:{BlackandDecker:{displayText:"Black and Decker"},Bosch:{displayText:"Bosh"},Bostich:{displayText:"Bostich"},Dewalt:{displayText:"Dewalt"},RoyalDirtDevil:{displayText:"Dirt Devil / Royal"},Echo:{displayText:"Echo"},Eureka:{displayText:"Eureka"},Hitachi:{displayText:"Hitachi"},Hoover:{displayText:"Hoover"},Karcher:{displayText:"Karcher"},Makita:{displayText:"Makita"},Metabo:{displayText:"Metabo"},Milwaukee:{displayText:"Milwaukee"},
PorterCable:{displayText:"Porter Cable"},Rigid:{displayText:"Rigid"},RotoZip:{displayText:"RotoZip"},Ryobi:{displayText:"Ryobi"},Skil:{displayText:"Skil"},Worx:{displayText:"Worx"}}},hvac:{modelHelpVersion:"v1",displayText:"HVAC",subCategoryDisplayName:"Sub Category",subcategory:{furnace:{displayText:"Furnace",videoId:"B1DFldRSP2S.mp4|B1DR4alaHiS.mp4|C18Sc5f6w5S.mp4"},air_conditioner:{displayText:"Air Conditioner",videoId:"B14NdYTrYtS.mp4|B1lHVihWATS.mp4|C1pl-DHFB2S.mp4"},central_air:{displayText:"Central Air",
videoId:"B1j10Tg3MtS.mp4|B1c8CFPJ2xS.mp4|C1jAwRebZVS.mp4"},dehumidifier:{displayText:"Dehumidifier"},humidifier:{displayText:"Humidifier"}}},vacuum:{modelHelpVersion:"v1",displayText:"Vacuums",subCategoryDisplayName:"Sub Category",subcategory:{vacuum_cleaner:{displayText:"Vacuum Cleaner",filter:{upright:{displayText:"Upright"},central:{displayText:"Central"},canister:{displayText:"Canister"}}}}},Grills:{modelHelpVersion:"v2",hasLeftPanelContent:!1,displayText:"Grills",subCategoryDisplayName:"Brand",
subcategory:{CharBroil:{displayText:"Char-Broil"},Kenmore:{displayText:"Kenmore"},Weber:{displayText:"Weber"},Charmglow:{displayText:"Charmglow"},Solaire:{displayText:"Solaire"},Other:{displayText:"Other"}}},Sports:{modelHelpVersion:"v2",hasLeftPanelContent:!0,displayText:"Sports",subCategoryDisplayName:"Sub Category",subcategory:{Treadmills:{displayText:"Treadmills"},EllipticalEquipment:{displayText:"Elliptical Equipment"},StationaryBike:{displayText:"Stationary Bike"},StepMachine:{displayText:"Step Machine"},
Trampoline:{displayText:"Trampoline"}}},Plumbing:{modelHelpVersion:"v2",hasLeftPanelContent:!0,displayText:"Plumbing",subCategoryDisplayName:"Sub Category",subcategory:{Toilets:{displayText:"Toilets"}}}};d.clearSelect=function(b){for(var d=f.getSelect(b).getOptions().size(),a=[],k=0;k<d;k++)a[k]=k;f.getSelect(b).removeOption(a)};d.helpMeFindModelNumber.initialize=function(){d.helpMeFindModelNumber.loadVideoPlayerConfig();d.helpMeFindModelNumber.populateCategory()};d.helpMeFindModelNumber.populateCategory=
function(){var b=0,e;for(e in d.helpMeFindModelNumber.data)d.helpMeFindModelNumber.data.hasOwnProperty(e)&&(f.getSelect("hsx-rpp-modelNumberMarkerCategory").addOption({text:d.helpMeFindModelNumber.data[e].displayText,value:e},b),b++);f.getSelect("hsx-rpp-modelNumberMarkerCategory").removeOption(b);0<f.getSelect("hsx-rpp-modelNumberMarkerCategory").getOptions().size()&&(b=f.getSelect("hsx-rpp-modelNumberMarkerCategory").getOption(0),f.getSelect("hsx-rpp-modelNumberMarkerCategory").setValue(b.info()[0].value),
d.helpMeFindModelNumber.populateSubcategory(b.info()[0].value))};d.helpMeFindModelNumber.populateSubcategory=function(b){d.clearSelect("hsx-rpp-modelNumberMarkerSubcategory");var e=d.helpMeFindModelNumber.data[b],a=0;d.videosList=d.videosList||{};for(var k in e.subcategory)if(e.subcategory.hasOwnProperty(k)){var h=d.helpMeFindModelNumber.data[b].subcategory[k];if(h.filter)for(var r in h.filter){if(h.filter.hasOwnProperty(r)){var g=h.filter[r];d.videosList[b+"_"+k+"_"+r]=g.videoId!==t?g.videoId:"";
f.getSelect("hsx-rpp-modelNumberMarkerSubcategory").addOption({text:h.displayText+" "+g.displayText,value:b+"|"+k+"|"+r},a);a++}}else d.videosList[b+"_"+k]=h.videoId!==t?h.videoId:"",f.getSelect("hsx-rpp-modelNumberMarkerSubcategory").addOption({text:h.displayText,value:b+"|"+k},a),a++}0<f.getSelect("hsx-rpp-modelNumberMarkerSubcategory").getOptions().size()&&(b=f.getSelect("hsx-rpp-modelNumberMarkerSubcategory").getOption(0),f.getSelect("hsx-rpp-modelNumberMarkerSubcategory").setValue(b.info()[0].value),
d.loadModelHelpContentForKey(b.info()[0].value))};d.helpMeFindModelNumber.loadVideoPlayerConfig=function(){b.ajax(d.config.videoConfigUrl,{method:"get",success:function(b){b.swf&&(d.config.videoPlayerSwf=b.swf);b.css&&p.load.css(b.css);b.js&&p.load.js(b.js);b.videosInfo&&l.each(b.videosInfo,function(b,a){var c=a.videoUrl.substring(a.videoUrl.lastIndexOf("/")+1);d.helpMeFindModelNumber.videosInfo[c]=a})}})};d.bindEvents=function(c,e){var a=b.$("#hsx-rpp-modelnumberBadgeBig").attr("src");a&&(a=a.substring(0,
a.lastIndexOf("/")+1))&&(d.config.imageCdn=a);b.on("a:dropdown:hsx-rpp-modelNumberMarkerCategory:select",function(a){"-1"!==a.value&&(c.emitMetrics(e,"ModelNumberHelpSwitchCategory",{categoryName:a.value}),d.helpMeFindModelNumber.populateSubcategory(a.value))});b.on("a:dropdown:hsx-rpp-modelNumberMarkerSubcategory:select",function(a){"-1"!==a.value&&d.loadModelHelpContentForKey(a.value)})};d.loadModelHelpContentForKey=function(b){b=b.split("|");if(2<=b.length){var e=d.helpMeFindModelNumber.data[b[0]];
e&&("v2"===e.modelHelpVersion?d.v2.load(b[0],b[1]):(d.switchModelHelpLayout("v1"),d.setModelNumberMarkerImage(b.join("_")),d.loadModelHelpVideo(b.join("_"))))}};d.switchModelHelpLayout=function(b,d){"v2"===b?(l("#hsx-rpp-modelNumberMarkerVideoContainer").hide(),l("#hsx-rpp-modelNumberMarkerImageContainer").hide(),l(".hsx-rpp-modelHelpRightPanel").show(),d?(l("#hsx-rpp-modelNumberMarkersContainer").hide(),l(".hsx-rpp-modelHelpLeftPanel").show()):(l("#hsx-rpp-modelNumberMarkersContainer").show(),l(".hsx-rpp-modelHelpLeftPanel").hide())):
(l(".hsx-rpp-modelHelpLeftPanel").hide(),l(".hsx-rpp-modelHelpRightPanel").hide(),l("#hsx-rpp-modelNumberMarkersContainer").show(),l("#hsx-rpp-modelNumberMarkerVideoContainer").show(),l("#hsx-rpp-modelNumberMarkerImageContainer").show())};d.v2={};d.v2.load=function(c,e){var a=d.helpMeFindModelNumber.data[c].hasLeftPanelContent;b.ajax(d.config.modelHelpContentUrl+"?category="+encodeURIComponent(c)+"&subCategory="+encodeURIComponent(e)+"&hasLeftPanelContent="+(a?"1":"0"),{method:"get",data:{},success:function(b){l(".hsx-rpp-modelHelpLeftPanel").length||
l('<div class="a-section hsx-rpp-modelHelpLeftPanel hsx-rpp-stack-horizontal"></div>').insertBefore("#hsx-rpp-modelNumberMarkersContainer");l(".hsx-rpp-modelHelpRightPanel").length||l('<div class="hsx-rpp-modelHelpRightPanel"></div>').insertBefore("#hsx-rpp-modelNumberMarkerVideoContainer");a&&l(".hsx-rpp-modelHelpLeftPanel").html(b.leftPanelHTML);l(".hsx-rpp-modelHelpRightPanel").html(b.rightPanelHTML);d.switchModelHelpLayout("v2",a)}})};d.setModelNumberMarkerImage=function(c){b.$("#hsx-rpp-modelNumberMarkerImage").attr("src",
d.config.imageCdn+c+".jpg")};d.loadModelHelpVideo=function(b){if(d.videosList&&""!==d.videosList[b]){b=d.videosList[b].split("|");for(var e={videoImageUrl:d.config.videoImageUrl,videoUrl:d.config.videoCdn+b[0]},a=0;a<b.length;a++)if(d.helpMeFindModelNumber.videosInfo[b[a]]){e=d.helpMeFindModelNumber.videosInfo[b[a]];break}""===l("#hsx-rpp-modelNumberMarkerVideoContainer").html()||null===d.helpMeFindModelNumber.videoPlayer?p.when("Airy").execute(function(a){d.helpMeFindModelNumber.videoPlayer=a.embed({parentId:"hsx-rpp-modelNumberMarkerVideoContainer",
streamingUrls:[e.videoUrl],swfUrl:d.config.videoPlayerSwf,slateImages:{preloadSlate:e.videoImageUrl,postMediaSlate:e.videoImageUrl},bindings:{videounsupported:function(a,b){l("#hsx-rpp-modelNumberMarkerVideoContainer").hide()}}})}):d.helpMeFindModelNumber.videoPlayer.loadMedia({mediaSourceInfo:e.videoUrl,slateImages:{preloadSlate:e.videoImageUrl,postMediaSlate:e.videoImageUrl}});l("#hsx-rpp-modelNumberMarkerVideoContainer").show()}else l("#hsx-rpp-modelNumberMarkerVideoContainer").hide()};return d})});
p.now("ReplacementPartsStripeFeedbackWidgetModule").execute(function(e){"undefined"===typeof e&&(p.when("A","a-modal","a-dropdown","jQuery").register("ReplacementPartsStripeFeedbackWidgetModule",function(b,e,f,l){var d={contentLoaded:!1,config:{widgetUrl:"/gp/replacement-parts/ajax/feedback-widget.html"},loadWidget:function(c,e,a){if(!d.contentLoaded){var k=b.$(location).attr("href"),k=encodeURI(k),h={};"undefined"!==typeof e&&(h.feedbackButtonId=e);h.previousUrl=k;"undefined"!==typeof a&&
("undefined"!==typeof a.modelSeries&&0<a.modelSeries.length&&"undefined"!==typeof a.modelNumber&&0<a.modelNumber.length?h.modelSeries=a.modelSeries+" "+a.modelNumber:"undefined"!==typeof a.modelSeries&&0<a.modelSeries.length?h.modelSeries=a.modelSeries:"undefined"!==typeof a.modelNumber&&0<a.modelNumber.length&&(h.modelSeries=a.modelNumber),"undefined"!==typeof a.modelBrand&&(h.brand=a.modelBrand),"undefined"!==typeof a.asin&&(h.asin=a.asin),"undefined"!==typeof a.ptd&&(h.ptd=a.ptd));b.ajax(d.config.widgetUrl,
{method:"get",params:h,success:function(a){b.$("#"+c).append(a);d.content=a}})}}};return d}),p.when("A","ReplacementPartsStripeFeedbackWidgetModule").execute(function(b){b.on("a:dropdown:selected:hsx-rpp-feedback-reason",function(e){"feedback_question_about_order"===e.value?(b.$("#hsx-feedback-help").removeClass("a-hidden"),b.$("#hsx-feedback-comment-div").addClass("a-hidden"),b.$("#hsx-feedback-slot2-row").addClass("a-hidden"),b.$("div.a-popover-footer > .a-button-primary").addClass("a-hidden")):
(b.$("#hsx-feedback-help").addClass("a-hidden"),b.$("#hsx-feedback-comment-div").removeClass("a-hidden"),b.$("#hsx-feedback-slot2-row").removeClass("a-hidden"),b.$("div.a-popover-footer > .a-button-primary").removeClass("a-hidden"))})}))});p.now("ReplacementPartsStripeUtility").execute(function(e){"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});"function"!==typeof String.prototype.endsWith&&(String.prototype.endsWith=
function(b){return-1!==this.indexOf(b,this.length-b.length)});"undefined"===typeof e&&p.when("A","a-dropdown","a-popover","ready").register("ReplacementPartsStripeUtility",function(b,e,f){var l={searchParameterConfig:{prefix:"bsm://",delimeter:"|",stripeOverrideDelimeter:"~",parameter:"rpp"},autocompleteMaxItemsToShow:20,bulletTextCache:"",clearSelect:function(b){for(var c=e.getSelect(b).getOptions().size(),f=[],a=0;a<c;a++)f[a]=a;e.getSelect(b).removeOption(f)},getQueryParameterByName:function(b){b=
b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(location.search);return null===b?"":decodeURIComponent(b[1].replace(/\+/g," "))},getFormField:function(d,c){if(0<b.$(d).find("input[name="+c+"]").length)return b.$(d).find("input[name="+c+"]").val()},getEncodedParameter:function(d,c,e){var a=l.searchParameterConfig.delimeter,k=l.searchParameterConfig.prefix,k=k+d+a;"undefined"!==typeof c&&0<c.length&&(k+=c);k+=a;k+=e;b.state("rpp")&&b.state("rpp").overriddenStripeId&&
(k=k+l.searchParameterConfig.stripeOverrideDelimeter+b.state("rpp").overriddenStripeId);return encodeURIComponent(k)},getEncodedParameterForSmartbox:function(b,c){var e=l.searchParameterConfig.prefix,a=l.searchParameterConfig.delimeter;return b?e+(b.brand?b.brand.text+"^"+b.brand.value:"")+a+(b.series?b.series.text+"^"+b.series.value:"")+a+(b.model?b.model.text+"^"+b.model.value:"")+a+c:null},getKeys:function(d){var c=[];d&&b.$.each(d,function(b,a){c.push(b)});return c},hideElement:function(b){b.addClass("aok-hidden");
b.hide()},htmlDecode:function(b){var c=document.createElement("div");c.innerHTML=b;return 0===c.childNodes.length?"":c.childNodes[0].nodeValue},setFormField:function(d,c,e){""===e?0<b.$(d).find("input[name="+c+"]").length&&b.$(d).find("input[name="+c+"]").remove():0<b.$(d).find("input[name="+c+"]").length?b.$(d).find("input[name="+c+"]").val(e):b.$('<input type="hidden" />').attr({name:c,value:e}).addClass("asFormInput").appendTo(d)},showElement:function(b){b.removeClass("aok-hidden");b.show()},normalizeModelField:function(b){if("undefined"===
typeof b)return"";b=b.toUpperCase().trim();return b.replace(/\s+/g," ")},normalizeValue:function(b){if("undefined"===typeof b)return"";b=b.toUpperCase();return b.replace(/[^A-Z0-9]+/g,"")},getButtonText:function(d){return b.$(d)[0].innerHTML.toString().trim()},getClickedValue:function(d){return b.$(d).attr("value")},getSeeAllPartsLink:function(){return""},getRhWithoutKeyword:function(d){d=d.split(",");var c=[];b.$(d).each(function(b,a){var k=a.split(":");0<k.length&&"k"!==k[0]&&c.push(a)});return c.join(",")},
isInNode:function(b){var c=q.location.href,e=l.getQueryParameterByName("rh");return e.endsWith("n:"+b)||-1<e.indexOf("n:"+b+",k")||-1<c.indexOf("node="+b)?!0:!1},showEnterModelPopover:function(d){var c=b.$("#"+d);c&&null!==f.get(c)&&(f.get(c).show(),setTimeout(function(){f.remove(c)},1E3))},showBullet:function(){l.showElement(b.$("#replacementPartsFitmentBullet"))},setBulletText:function(d){var c=b.state("rpp");if(!c||"dropdown"!==c.finderName&&"smartbox"!==c.finderName)b.$("#replacementPartsFitmentBulletInner").html(d);
else if("enter-model"!==c.stripeState)if("smartbox"===c.finderName&&""===l.bulletTextCache&&(l.bulletTextCache=b.$("#replacementPartsFitmentBulletInner").contents()),"result-found"===c.stripeState){var e="",e="smartbox"===c.finderName?b.$("#hsx-rpp-bullet-fits-message").clone():b.$("#hsx-rpp-bullet-fits-message");e.find(".hsx-rpp-bullet-model-info").html(d);b.$("#replacementPartsFitmentBulletInner").html(e);l.showElement(e)}else b.$("#replacementPartsFitmentBulletInner").html(d);else""!==l.bulletTextCache&&
b.$("#replacementPartsFitmentBulletInner").html(l.bulletTextCache)},enableInputById:function(d){b.$("#"+d).removeAttr("disabled").removeClass("a-form-disabled")},prepareBulletText:function(d,c,e){var a=b.state("rpp");if("dropdown"===a.finderName)switch(d){case "result-found":return c;case "no-result":l.hideElement(b.$("#replacementPartsFitmentBullet"))}else switch(d){case "result-found":return"smartbox"===a.finderName?c:b.$("#replacementPartsFitmentBullet").data("fitsmessage")+c+".";case "no-result":if(0===
e)l.hideElement(b.$("#replacementPartsFitmentBullet"));else return b.$("#replacementPartsFitmentBullet").data("doesntfitmessage")+c+"."}},toHalfWidth:function(b){var c=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/g;c.test(b)&&(b=b.replace(c,function(b){return String.fromCharCode(b.charCodeAt(0)-65248)}));return b},config:{brandListUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=brandList",checkFitmentUrl:"/gp/replacement-parts/ajax/hsx-rpp-dp-ajax-handler.html?ie=UTF8",
modelListUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelList",modelFuzzyMatchUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelSearch",modelQueryUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelInfo",modelSearchUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelSearch",modelSuggestUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelSuggest",combinedModelSuggestUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=combinedModelSuggest&ie=UTF8&getMyModels=1&isDropdownStripe=1",
modelnumberSeriesQueryUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=modelnumberSeriesInfo",partFuzzyMatchUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=partSearch",partQueryUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=partInfo",partSuggestUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=partSuggest",seriesListUrl:"/gp/replacement-parts/ajax/query-index.html?qtype=seriesList",getMyModelUrl:"/gp/replacement-parts/ajax/my-model.html?getMyModel=1",putMyModelUrl:"/gp/replacement-parts/ajax/my-model.html",
noFitmentDataPopoverUrl:"/gp/replacement-parts/ajax/no-fitment-data-popover.html"}};return l})});p.now("ReplacementPartsSearchStripe").execute(function(e){"undefined"===typeof e&&p.when("A","a-popover","a-dropdown","HSXMetricsLogger","ReplacementPartsStripeModelHelpModule","ReplacementPartsStripeFeedbackWidgetModule","ReplacementPartsStripeUtility","jQuery-ReplacementPartsAutocomplete","ready").register("ReplacementPartsSearchStripe",function(b,e,f,l,d,c,m){var a={stripeData:{},category:"default"};
a.config=b.$.extend({},m.config,{searchAlias:"replacement-parts",showAllPartsForModelReftag:"sx_rpp_stripe_showallparts",metricsPrefix:"hsxRPPSearchStripeV1"});a.initialize=function(){a.metricsLogger=l.createLogger();b.state("rpp")&&(a.stripeData=b.state("rpp"),a.category=a.stripeData.category);b.state("rpp")||b.state.parse();b.$("#hsx-rpp-stripeAction").attr("action",b.state("rpp").widgetRedirectURL);b.$(".hsx-rpp-btnCheckAnother").click(function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,
"ClearModel");a.submitForm("","")});b.$("#hsx-rpp-lnkHelpFindModelNumber").click(function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"HelpMeFindModelNumberClicked")});b.$(".hsx-rpp-btnClearSelectSeries").click(function(){a.hideSelectModelSeriesFitmentContainer()});b.$(".hsx-rpp-btnShowAllPartsForModel").click(function(){a.searchAllPartsForModel()});b.$("#hsx-rpp-btnSearchPart").click(function(){var c=b.$("#hsx-rpp-txtPartSearch").val();a.searchPart(c)});b.$("#hsx-rpp-txtPartSearch").keyup(function(c){13===
c.keyCode&&(c=b.$("#hsx-rpp-txtPartSearch").val(),a.searchPart(c))});a.modelNumberAutocomplete=b.$("#hsx-rpp-txtModelNumber").rppAutocomplete(a.config.modelSuggestUrl,{doFuzzyMatch:!1,maxItemsToShow:m.autocompleteMaxItemsToShow,fuzzyMatchUrl:a.config.modelFuzzyMatchUrl,fuzzyMatchHasResultCallBack:function(b){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"FuzzyMatchShown",{modelNumber:b})},fuzzyMatchNoResultCallBack:function(){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"LookForWholegoodsAttempt");
a.checkForPartNumber(b.$("#hsx-rpp-txtModelNumber").val())},onItemSelect:function(b,c,k,h){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"AutocompleteUsed",{typedModelNumber:c,modelNumber:k,isFuzzyMatch:h});a.checkModelNumber()},recordCSMCounterMetric:function(b){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,b)}})[0];"enter-model"===b.state("rpp").stripeState&&(d.helpMeFindModelNumber.initialize(),d.bindEvents(a.metricsLogger,a.config.metricsPrefix),""!==b.$("#hsx-rpp-txtModelNumber").val()||
b.$("#hsx-rpp-txtModelNumber").is(":focus")||a.showEnterModelPopover(),b.$("#hsx-rpp-lnkModelNumberPrompt").click(a.triggerEnterModelPopover),b.$("#hsx-rpp-txtModelNumber").click(a.removeEnterModelPopover),b.on("a:dropdown:hsx-rpp-selectModelSeries:select",function(b){a.removeSelectSeriesPopover();a.pickModelSeries(b.value)}),b.$("#hsx-rpp-partNumberSearchLink").click(function(a){a=b.$("#hsx-rpp-stripeAction");m.setFormField(a,"keywords",b.$("#hsx-rpp-partNumberSearchLink").text());b.$(a).submit();
return!1}));b.$("#hsx-rpp-btnCheckFitment").click(a.checkModelNumber);b.$("#hsx-rpp-txtModelNumber").bind("paste",function(b){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"PasteModelNumber")});b.$("#hsx-rpp-txtModelNumber").keyup(function(b){a.clearModelNumberWarnings();13===b.keyCode&&a.checkModelNumber()});if("enter-model"===b.state("rpp").stripeState)a.metricsLogger.emitMetrics(a.config.metricsPrefix,"Loaded",{stripeState:b.state("rpp").stripeState}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,
"Loaded");else{var k=b.state("rpp").modelNumber,h=b.state("rpp").modelBrand;b.state("rpp",{modelNumber:m.htmlDecode(k),modelBrand:m.htmlDecode(h)});a.metricsLogger.emitMetrics(a.config.metricsPrefix,"Loaded",{stripeState:b.state("rpp").stripeState,modelNumber:k,modelBrand:h,resultCount:b.state("rpp").resultCount,browseNodes:b.state("rpp").browseNode})}m.enableInputById("hsx-rpp-txtModelNumber");c.loadWidget("hsx-rpp-feedbackContainer","hsx-rpp-feedbackButton",b.state("rpp"))};a.clearModelNumberWarnings=
function(){b.$("#hsx-rpp-modelNumberErrorMessage").hide();b.$("#hsx-rpp-PartnumberDetectedMessage").hide();b.$("#hsx-rpp-modelNumberNotFoundMessage").hide()};a.checkModelNumber=function(){a.clearModelNumberWarnings();var c=b.$("#hsx-rpp-txtModelNumber").val().replace(/ /g,"");""!==c&&(50<=c.length?b.$("#hsx-rpp-modelNumberNotFoundMessage").show():(a.metricsLogger.emitMetrics(a.config.metricsPrefix,"LookupModel",{modelNumber:c}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCall"),
b.$("#hsx-rpp-feedback-model-series").attr("value",c),b.$("#hsx-rpp-feedback-brand").attr("value",""),b.ajax(a.config.modelQueryUrl,{method:"get",params:{q:c},success:function(b){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallSuccess");a.processCheckModelNumberResult(c,b)},error:function(){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallFail");b.$("#hsx-rpp-modelNumberErrorMessage").show()}})))};a.triggerEnterModelPopover=function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,
"EnterModelPopover");a.showEnterModelPopover()};a.showEnterModelPopover=function(){var c='<div class="hsx-rpp-modelnumber-popover-content">'+b.$(".hsx-rpp-modelnumber-popover-content").html()+"</div>",h=b.$(".hsx-rpp-enterModelPopupPlaceHolder");h.css({width:b.$("#hsx-rpp-txtModelNumber").width()+"px"});a.enterModelPopoverInstance=e.create(h,{content:c,name:"hsx-rpp-enterModelNumberPrompt",position:"triggerBottom",popoverLabel:"Enter your model number to make sure this fits"});a.enterModelPopoverInstance.show();
setTimeout(function(){a.enterModelPopoverInstance&&null!==a.enterModelPopoverInstance&&a.enterModelPopoverInstance.hide()},1E3)};a.removeEnterModelPopover=function(c){a.enterModelPopoverInstance&&null!==a.enterModelPopoverInstance&&(e.remove(b.$("#hsx-rpp-checkFitmentContainerEnterModelNumber")),a.enterModelPopoverInstance=null);c&&c.preventDefault()};a.showSelectSeriesPopover=function(c){var h=b.$(".hsx-rpp-modelseries-popover-content").html();c&&"brand"===c?(h=h.replace(/series/g,"brand"),f.getSelect("hsx-rpp-selectModelSeries").update({option_prompt:"Select Brand"})):
f.getSelect("hsx-rpp-selectModelSeries").update({option_prompt:"Select Series"});c='<div class="hsx-rpp-modelseries-popover-content">'+h+"</div>";h=b.$(".hsx-rpp-selectSeriesPopoverHolder");h.css({width:b.$("#hsx-rpp-selectModelSeriesSpan").width()+"px"});h.css({marginLeft:b.$("#hsx-rpp-moreInfoModelNumber").width()+7+"px"});a.selectSeriesPopoverInstance=e.create(h,{content:c,name:"hsx-rpp-selectModelSeriesPrompt",position:"triggerBottom"});b.$("#hsx-rpp-selectModelSeriesSpan").click(function(){a.removeSelectSeriesPopover()});
a.selectSeriesPopoverInstance.show()};a.removeSelectSeriesPopover=function(c){a.selectSeriesPopoverInstance&&null!==a.selectSeriesPopoverInstance&&(e.remove(b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries")),a.selectSeriesPopoverInstance=null);c&&c.preventDefault()};a.searchAllPartsForModel=function(){var c=b.$("#hsx-rpp-stripeAction");c.attr("action","/s/ref="+a.config.showAllPartsForModelReftag);m.setFormField(c,"keywords","");m.setFormField(c,"rh","");m.setFormField(c,"node",b.state("rpp").rootBrowseNode);
var c=b.state("rpp").modelNumber,h=b.state("rpp").modelBrand;a.metricsLogger.emitMetrics(a.config.metricsPrefix,"SearchAllPartsForModel",{modelNumber:c,modelBrand:h});a.submitForm(c,h)};a.searchPart=function(c){var h=b.state("rpp").modelNumber,d=b.state("rpp").modelBrand,g=b.$("#hsx-rpp-stripeAction"),e=m.getFormField(g,"keywords"),f=m.getFormField(g,"rh"),e=f.replace(e,c);m.setFormField(g,"keywords",c);m.setFormField(g,"rh",e);b.$("#twotabsearchtextbox").val(c);a.metricsLogger.emitMetrics(a.config.metricsPrefix,
"SearchPart",{keyword:c,prevRH:f,reformedRH:e});a.submitForm(h,d)};a.submitForm=function(a,c){var d=b.$("#hsx-rpp-stripeAction");m.setFormField(d,"rppModelNumber",a);m.setFormField(d,"rppModelBrand",c);if("enter-model"===b.state("rpp").stripeState){var g=b.$('#hsx-rpp-stripeAction input[name="rh"]').val();m.setFormField(d,"rh",m.getRhWithoutKeyword(g));m.setFormField(d,"keywords","")}else b.objectIsEmpty(a)&&b.objectIsEmpty(c)&&m.setFormField(d,"rd","1");b.$(d).submit()};a.showSelectModelSeriesFitmentContainer=
function(c){b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").removeClass("hsx-rpp-hidden");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").addClass("hsx-rpp-stack-horizontal");b.$("#hsx-rpp-checkFitmentContainerEnterModelNumber").removeClass("hsx-rpp-stack-horizontal");b.$("#hsx-rpp-checkFitmentContainerEnterModelNumber").addClass("hsx-rpp-hidden");b.$("#hsx-rpp-resultContainer").hide();b.$("#hsx-rpp-checkFitmentContainer").show();a.showSelectSeriesPopover(c)};a.hideSelectModelSeriesFitmentContainer=
function(){a.removeSelectSeriesPopover();b.$("#hsx-rpp-txtModelNumber").val("");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").removeClass("hsx-rpp-stack-horizontal");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").addClass("hsx-rpp-hidden");b.$("#hsx-rpp-checkFitmentContainerEnterModelNumber").removeClass("hsx-rpp-hidden");b.$("#hsx-rpp-checkFitmentContainerEnterModelNumber").addClass("hsx-rpp-stack-horizontal");b.$("#hsx-rpp-resultContainer").hide();b.$("#hsx-rpp-checkFitmentContainer").show();
b.$("#hsx-rpp-txtModelNumber").focus();a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ClearModel")};a.populateModelSeries=function(b,c){m.clearSelect("hsx-rpp-selectModelSeries");for(var d=!1,g=0;g<c.length;g++)0<g&&c[g-1].fields.brand!==c[g].fields.brand&&(d=!0);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ModelCollision",{modelNumber:b,hasBrandCollision:d});for(g=0;g<c.length;g++){var e=c[g].fields.modelnumber;c[g].fields.series&&(e+=c[g].fields.series);d&&(e=c[g].fields.brand+" "+e);
f.getSelect("hsx-rpp-selectModelSeries").addOption({text:e,value:""+g},g)}return d?"brand":"series"};a.pickModelSeries=function(c){c=a.modelSearchResult.hits.hit[c];var h=c.fields.modelnumber;c.fields.series&&(h+=c.fields.series);b.$("#hsx-rpp-feedback-model-series").attr("value",c.fields.modelnumber);b.$("#hsx-rpp-feedback-brand").attr("value",c.fields.brand);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"SelectModel",{modelNumber:h});a.putMyModel(c.fields.modelnumber,c.fields.series,c.fields.brand,
a.stripeData.category);a.submitForm(h,c.fields.brand)};a.checkForPartNumber=function(c){a.clearModelNumberWarnings();""!==c&&(a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCall"),b.ajax(a.config.partQueryUrl,{method:"get",params:{q:c},success:function(b){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallSuccess");a.processPartNumberResult(c,b)},error:function(){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallFail");
b.$("#hsx-rpp-modelNumberErrorMessage").show()}}))};a.processPartNumberResult=function(c,h){a.modelSearchResult=h;0<h.hits.found?(b.$("#hsx-rpp-partNumberSearchLink").text(h.hits.hit[0].fields.partnumber),a.metricsLogger.emitMetrics(a.config.metricsPrefix,"PartNumberFound",{partNumber:h.hits.hit[0].fields.partnumber}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"LookForWholegoodsAttemptSucceed"),b.$("#hsx-rpp-PartnumberDetectedMessage").show()):(b.$("#hsx-rpp-enteredModelNumberLink").text(c),
a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ModelNumberNotFound",{modelNumber:c}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"LookForWholegoodsAttemptFail"),b.$("#hsx-rpp-modelNumberNotFoundMessage").show())};a.processCheckModelNumberResult=function(c,h){a.modelSearchResult=h;if(1<h.hits.found){b.$("#hsx-rpp-moreInfoModelNumber").html(c);var d=a.populateModelSeries(c,h.hits.hit);a.showSelectModelSeriesFitmentContainer(d)}else 0<h.hits.hit.length?a.pickModelSeries(0):a.modelNumberAutocomplete&&
a.modelNumberAutocomplete.triggerFuzzyMatch?a.modelNumberAutocomplete.triggerFuzzyMatch():a.checkForPartNumber(c)};a.putMyModel=function(c,h,d,g){b.ajax(a.config.putMyModelUrl,{method:"GET",tryCount:0,retryLimit:2,params:{brand:d,model:c,series:h,scope:g},error:function(c,k,h){"timeout"===k?(this.tryCount++,this.tryCount<=this.retryLimit&&b.ajax(this)):400<=c.status&&500>=c.status?a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"PutMyModelAjaxFailed"):a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,
"DataQueryAjaxCallFail")}})};return a})});p.now("ReplacementPartsDetailPageStripe").execute(function(e){"undefined"===typeof e&&p.when("A","a-popover","a-dropdown","HSXMetricsLogger","ReplacementPartsStripeModelHelpModule","ReplacementPartsStripeFeedbackWidgetModule","ReplacementPartsStripeUtility","jQuery-ReplacementPartsAutocomplete","ready").register("ReplacementPartsDetailPageStripe",function(b,e,f,l,d,c,m){var a={stripeData:{},category:"default",categoryMap:{grills:"grill",hvac:"homehvac"}};
a.config=b.$.extend({},m.config,{showAllPartsForModelReftag:"dp_rpp_stripe_showallparts",metricsPrefix:"hsxRPPDetailPageStripeV1"});a.initialize=function(){q.uet instanceof Function&&q.uet("bb","replacement-generic",{wb:1});b.state("rpp")&&(a.stripeData=b.state("rpp"),a.category=a.stripeData.category);b.$("#replacementPartsFitmentBullet .hsx-rpp-fitment-focus").click(function(c){c.preventDefault();b.$("html,body").animate({scrollTop:b.$("#hsx-rpp-stripeContainer").offset().top},"fast");b.$("#hsx-rpp-txtModelNumber").focus();
a.showEnterModelPopover();a.metricsLogger.emitMetrics(a.config.metricsPrefix,"FitmentBulletClicked")});a.metricsLogger=l.createLogger();m.showElement(b.$("#hsx-rpp-stripeContainer"));d.helpMeFindModelNumber.initialize();d.bindEvents(a.metricsLogger,a.config.metricsPrefix);b.$("#hsx-rpp-lnkHelpFindModelNumber").click(function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"HelpMeFindModelNumberClicked")});b.$("#hsx-rpp-btnCheckFitment").click(a.checkModelNumber);b.$("#hsx-rpp-txtModelNumber").bind("paste",
function(b){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"PasteModelNumber")});b.$("#hsx-rpp-txtModelNumber").keyup(function(b){a.clearModelNumberWarnings();13===b.keyCode&&a.checkModelNumber()});b.$(".hsx-rpp-btnCheckAnother").click(function(){a.hideSelectModelSeriesFitmentContainer()});a.config.product_type=a.getProductTypeFromCategory(b.state("rpp").category);a.modelNumberAutocomplete=b.$("#hsx-rpp-txtModelNumber").rppAutocomplete(a.config.modelSuggestUrl.concat("&isDetail=1&qCategory="+
a.config.product_type),{doFuzzyMatch:!1,maxItemsToShow:m.autocompleteMaxItemsToShow,fuzzyMatchUrl:a.config.modelFuzzyMatchUrl,fuzzyMatchHasResultCallBack:function(b){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"FuzzyMatchShown",{modelNumber:b})},fuzzyMatchNoResultCallBack:function(c){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ModelNumberNotFound",{modelNumber:c});a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"LookForWholegoodsAttemptFail");b.$("#hsx-rpp-enteredModelNumberLink").html(c);
b.$("#hsx-rpp-modelNumberErrorMessage").show()},onItemSelect:function(b,c,k,d){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"AutocompleteUsed",{typedModelNumber:c,modelNumber:k,isFuzzyMatch:d});a.checkModelNumber()},recordCSMCounterMetric:function(b){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,b)}})[0];b.$(document).delegate("#hsx-rpp-txtModelNumber","focusin",a.removeEnterModelPopover);b.on("a:dropdown:hsx-rpp-selectModelSeries:select",function(b){a.removeSelectSeriesPopover();
a.pickModelSeries(b.value)});a.metricsLogger.emitMetrics(a.config.metricsPrefix,"Loaded",{asin:b.state("rpp").asin,stripeState:b.state("rpp").stripeState,modelBrand:b.state("rpp").modelBrand,modelNumber:b.state("rpp").modelNumber});a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"Loaded");var k=b.state("rpp").modelBrand+" "+b.state("rpp").modelNumber;"enter-model"===b.state("rpp").stripeState&&(m.showElement(b.$("#hsx-rpp-checkFitmentContainer")),""!==b.$("#hsx-rpp-txtModelNumber").val()||
b.$("#hsx-rpp-txtModelNumber").is(":focus")||a.showEnterModelPopover(),b.$("#hsx-rpp-lnkModelNumberPrompt").click(a.triggerEnterModelPopover));m.setBulletText(m.prepareBulletText(b.state("rpp").stripeState,k,b.state("rpp").showBullet));"no-result"===b.state("rpp").stripeState&&0===b.state("rpp").showBullet||m.showBullet();b.$("#replacementPartsFitmentBullet").is(":visible")&&a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"BulletVisible");b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){a.showAllPartsThatFit(b.state("rpp").modelNumber,
b.state("rpp").modelBrand)});m.enableInputById("hsx-rpp-txtModelNumber");c.loadWidget("hsx-rpp-feedbackContainer","hsx-rpp-feedbackButton",b.state("rpp"));q.uex instanceof Function&&q.uex("ld","replacement-generic",{wb:1})};a.triggerEnterModelPopover=function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"EnterModelPopover");a.showEnterModelPopover()};a.showEnterModelPopover=function(){var c='<div class="hsx-rpp-modelnumber-popover-content">'+b.$(".hsx-rpp-modelnumber-popover-content").html()+
"</div>",h=b.$(".hsx-rpp-enterModelPopupPlaceHolder");h.css({width:b.$("#hsx-rpp-txtModelNumber").width()+"px"});a.enterModelPopoverInstance=e.create(h,{content:c,name:"hsx-rpp-enterModelNumberPrompt",position:"triggerBottom",popoverLabel:"Enter your model number to make sure this fits"});a.enterModelPopoverInstance.show();setTimeout(function(){a.enterModelPopoverInstance&&null!==a.enterModelPopoverInstance&&a.enterModelPopoverInstance.hide()},1E3)};a.removeEnterModelPopover=function(c){a.enterModelPopoverInstance&&
null!==a.enterModelPopoverInstance&&(e.remove(b.$("#hsx-rpp-txtModelNumber")),a.enterModelPopoverInstance=null);c&&c.preventDefault()};a.clearModelNumberWarnings=function(){b.$("#hsx-rpp-modelNumberErrorMessage").hide()};a.checkModelNumber=function(){a.clearModelNumberWarnings();var c=b.$("#hsx-rpp-txtModelNumber").val().replace(/ /g,"");""!==c&&(50<=c.length?b.$("#hsx-rpp-modelNumberNotFoundMessage").show():(a.metricsLogger.emitMetrics(a.config.metricsPrefix,"LookupModel",{modelNumber:c}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,
"DataQueryAjaxCall"),b.$("#hsx-rpp-feedback-model-series").attr("value",c),b.$("#hsx-rpp-feedback-brand").attr("value",""),b.ajax(a.config.modelQueryUrl,{method:"get",params:{q:c,qCategory:a.config.product_type,isDetail:1},success:function(b){a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallSuccess");a.processCheckModelNumberResult(c,b)},error:function(){b.$("#hsx-rpp-enteredModelNumberLink").html(c);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"CheckModelNumberError",
{modelNumber:c});a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallFail");b.$("#hsx-rpp-modelNumberErrorMessage").show()}})))};a.populateModelSeries=function(b,c){m.clearSelect("hsx-rpp-selectModelSeries");for(var d=!1,g=0;g<c.length;g++)0<g&&c[g-1].fields.brand!==c[g].fields.brand&&(d=!0);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ModelCollision",{modelNumber:b,hasBrandCollision:d});for(g=0;g<c.length;g++){var e=c[g].fields.modelnumber;c[g].fields.series&&(e+=
c[g].fields.series);d&&(e=c[g].fields.brand+" "+e);f.getSelect("hsx-rpp-selectModelSeries").addOption({text:e,value:""+g},g)}return d?"brand":"series"};a.processCheckModelNumberResult=function(c,h){a.modelSearchResult=h;if(1<h.hits.found){b.$("#hsx-rpp-moreInfoModelNumber").html(c);var d=a.populateModelSeries(c,h.hits.hit);a.showSelectModelSeriesFitmentContainer(d)}else 0<h.hits.hit.length?a.pickModelSeries(0):a.modelNumberAutocomplete&&a.modelNumberAutocomplete.triggerFuzzyMatch?(a.metricsLogger.emitMetrics(a.config.metricsPrefix,
"FuzzyMatchShown",{modelNumber:c}),a.modelNumberAutocomplete.triggerFuzzyMatch()):(a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ModelNumberNotFound",{modelNumber:c}),b.$("#hsx-rpp-enteredModelNumberLink").html(c),b.$("#hsx-rpp-modelNumberErrorMessage").show())};a.showSelectSeriesPopover=function(c){var h=b.$(".hsx-rpp-modelseries-popover-content").html();c&&"brand"===c?(h=h.replace(/series/g,"brand"),f.getSelect("hsx-rpp-selectModelSeries").update({option_prompt:"Select Brand"})):f.getSelect("hsx-rpp-selectModelSeries").update({option_prompt:"Select Series"});
c='<div class="hsx-rpp-modelseries-popover-content">'+h+"</div>";h=b.$(".hsx-rpp-selectSeriesPopoverHolder");h.css({width:b.$("#hsx-rpp-selectModelSeriesSpan").width()+"px"});h.css({marginLeft:b.$("#hsx-rpp-moreInfoModelNumberContainer").width()+7+"px"});a.selectSeriesPopoverInstance=e.create(h,{content:c,name:"hsx-rpp-selectModelSeriesPrompt",position:"triggerBottom"});b.$("#hsx-rpp-selectModelSeriesSpan").click(function(){a.removeSelectSeriesPopover()});a.selectSeriesPopoverInstance.show()};a.removeSelectSeriesPopover=
function(c){a.selectSeriesPopoverInstance&&null!==a.selectSeriesPopoverInstance&&(e.remove(b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries")),a.selectSeriesPopoverInstance=null);c&&c.preventDefault()};a.showSelectModelSeriesFitmentContainer=function(c){b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").removeClass("hsx-rpp-hidden");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").addClass("hsx-rpp-centerResultMessage");b.$("#hsx-rpp-enterModelNumberContainer").removeClass("hsx-rpp-centerResultMessage");
b.$("#hsx-rpp-enterModelNumberContainer").addClass("hsx-rpp-hidden");b.$("#hsx-rpp-fitsContainer").hide();b.$("#hsx-rpp-notfitsContainer").hide();m.showElement(b.$("#hsx-rpp-checkFitmentContainer"));a.showSelectSeriesPopover(c)};a.hideSelectModelSeriesFitmentContainer=function(){a.removeSelectSeriesPopover();b.$("#hsx-rpp-txtModelNumber").val("");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").removeClass("hsx-rpp-centerResultMessage");b.$("#hsx-rpp-checkFitmentContainerSelectModelSeries").addClass("hsx-rpp-hidden");
b.$("#hsx-rpp-enterModelNumberContainer").addClass("hsx-rpp-centerResultMessage");b.$("#hsx-rpp-enterModelNumberContainer").removeClass("hsx-rpp-hidden");b.$("#hsx-rpp-fitsContainer").hide();b.$("#hsx-rpp-notfitsContainer").hide();m.showElement(b.$("#hsx-rpp-checkFitmentContainer"));b.$("#hsx-rpp-txtModelNumber").focus();a.metricsLogger.emitMetrics(a.config.metricsPrefix,"ClearModel");b.state("rpp",{stripeState:"enter-model"})};a.pickModelSeries=function(c,h){var d=a.modelSearchResult.hits.hit[c],
g=d.fields.brand,e=d.fields.modelnumber,f=d.fields.modelnumber,m;d.fields.series&&(f+=d.fields.series,m=d.fields.series);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"SelectModel",{modelNumber:f});b.$("#hsx-rpp-feedback-model-series").attr("value",e);b.$("#hsx-rpp-feedback-brand").attr("value",g);m===t&&(m="BASE");a.checkFitment(g,e,m,f,b.state("rpp").asin,h)};a.checkFitment=function(c,h,d,g,e,f){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"CheckFitment",{asin:e,modelBrand:c,modelNumber:h,
series:d});a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCall");a.putMyModel(h,d,c,a.category);b.ajax(a.config.checkFitmentUrl,{method:"get",params:{brand:m.normalizeValue(c),model:m.normalizeModelField(h),series:m.normalizeModelField(d),asin:e},success:function(b){b&&1===b.success&&b.payload&&"yes"===b.payload.fitment_decision?(a.metricsLogger.emitMetrics(a.config.metricsPrefix,"FitmentRecordFound",{asin:e,modelBrand:c,modelNumber:h,series:d}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,
"DataQueryAjaxCallSuccess"),a.showFitsMessage(g,c)):(f&&!0===f&&a.metricsLogger.emitMetrics(a.config.metricsPrefix,"InconsistentFitment",{asin:e,modelBrand:c,modelNumber:h,series:d}),a.metricsLogger.emitMetrics(a.config.metricsPrefix,"NoFitmentRecordFound",{asin:e,modelBrand:c,modelNumber:h,series:d}),a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallSuccess"),a.showNotFitsMessage(g,c))},error:function(){a.metricsLogger.emitMetrics(a.config.metricsPrefix,"CheckFitmentError",
{asin:e,modelBrand:c,modelNumber:h,series:d});a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallFail");a.showNotFitsMessage(g,c)}})};a.showFitsMessage=function(c,h){var d=h+" "+c;b.state("rpp",{stripeState:"result-found",modelBrand:h,modelNumber:c});b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){a.showAllPartsThatFit(c,h)});b.$("#hsx-rpp-fitsModelNumber").html(d);m.showElement(b.$("#hsx-rpp-fitsContainer"));m.hideElement(b.$("#hsx-rpp-notfitsContainer").hide());m.hideElement(b.$("#hsx-rpp-checkFitmentContainer").hide());
m.setBulletText(m.prepareBulletText(b.state("rpp").stripeState,d,b.state("rpp").showBullet))};a.showNotFitsMessage=function(c,h){var d=h+" "+c;b.state("rpp",{stripeState:"no-result",modelBrand:h,modelNumber:c});b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){a.showAllPartsThatFit(c,h)});b.$("#hsx-rpp-notfitsModelNumber").html(d);m.hideElement(b.$("#hsx-rpp-fitsContainer"));m.showElement(b.$("#hsx-rpp-notfitsContainer"));m.hideElement(b.$("#hsx-rpp-checkFitmentContainer"));m.setBulletText(m.prepareBulletText(b.state("rpp").stripeState,
d,b.state("rpp").showBullet))};a.showAllPartsThatFit=function(c,h){var d="3741181";b.state("rpp").rootBrowseNode&&(d=b.state("rpp").rootBrowseNode);d="/s/ref="+a.config.showAllPartsForModelReftag+"?node="+d+"&rppModelNumber="+encodeURIComponent(c);d+="&rppModelBrand="+encodeURIComponent(h);a.metricsLogger.emitMetrics(a.config.metricsPrefix,"SeeAllPartsThatFit");q.location.replace(d)};a.getProductTypeFromCategory=function(b){return b in a.categoryMap?a.categoryMap[b]:b};a.putMyModel=function(c,h,d,
g){b.ajax(a.config.putMyModelUrl,{method:"GET",tryCount:0,retryLimit:2,params:{brand:d,model:c,series:h,scope:g},error:function(c,k,h){"timeout"===k?(this.tryCount++,this.tryCount<=this.retryLimit&&b.ajax(this)):400<=c.status&&500>=c.status?a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"PutMyModelAjaxFailed"):a.metricsLogger.emitCSMCounterMetrics(a.config.metricsPrefix,"DataQueryAjaxCallFail")}})};return a})});p.now("ReplacementPartsDropdownStripe").execute(function(e){"undefined"===
typeof e&&p.when("A","a-popover","a-dropdown","a-button","jQuery","HSXMetricsLogger","ReplacementPartsStripeModelHelpModule","ReplacementPartsStripeFeedbackWidgetModule","ReplacementPartsStripeUtility","jQuery-ReplacementPartsAutocomplete","ready").register("ReplacementPartsDropdownStripe",function(b,e,f,l,d,c,m,a,k){function h(a,b,c){r(a);a=g.config.noFitmentDataPopoverUrl;a+="?category="+g.category;a=e.create(b,{url:a+("&selectedBrand="+c),width:"400",position:"triggerBottom"});a.show()}function r(a){null!==
a&&"undefined"!==a&&e.remove(a)}var g={config:{},autocompleteInstances:[],noDataBrands:[],category:"",SEARCH_PAGE_TYPE:"search",DETAIL_PAGE_TYPE:"detail",BROWSE_PAGE_TYPE:"browse",FEEDBACK_BRAND_ID:"#hsx-rpp-feedback-brand",FEEDBACK_MODEL_ID:"#hsx-rpp-feedback-model-series",FITSID:"#hsx-rpp-fitsContainer",NOTFITSID:"#hsx-rpp-notfitsContainer",CHECKFITMENTID:"#hsx-rpp-checkFitmentContainer",STRIPE_CONTAINER:"#hsx-rpp-stripeContainer",TEXT_INPUT_ID:"#hsx-rpp-number-series-query",NO_DATA_POPOVER_TRIGGER:"#hsx-rpp-number-series-query",
qGroup:"inkandtoner",BRAND_BUTTON_TEXT:"Brand",finderName:"dropdown",DELAY_MS:250,timer:0,initialize:function(){b.state("rpp")||b.state.parse();var h=b.state("rpp").pageType;g.category=b.state("rpp").stripeParams.category;"brandsMissingFitment"in b.state("rpp").stripeParams&&(g.noDataBrands=b.state("rpp").stripeParams.brandsMissingFitment.split("#"));g.autocompleteInstances=[];g.metricsLogger=c.createLogger();a.loadWidget("hsx-rpp-feedbackContainer","hsx-rpp-feedbackButton",b.state("rpp"));b.state("rpp").stripeParams&&
b.state("rpp").stripeParams.scope&&(g.qGroup=b.state("rpp").stripeParams.scope);if(h===g.DETAIL_PAGE_TYPE||h===g.BROWSE_PAGE_TYPE)g.config=b.$.extend({},k.config,{showAllPartsForModelReftag:"dp_rpp_stripe_showallparts",defaultRootBrowseNode:b.state("rpp").rootBrowseNode,fitmentMessagingTextMaxLength:35,metricsPrefix:"hsxRPPDetailPageStripe"}),g.initializeDetailPage();h===g.SEARCH_PAGE_TYPE&&(g.config=b.$.extend({},k.config,{showAllPartsForModelReftag:"sx_rpp_stripe_showallparts",searchAlias:"replacement-parts",
modelSuggestUrl:k.config.modelSuggestUrl+"&qGroup="+g.qGroup,metricsPrefix:"hsxRPPSearchStripe"}),g.initializeSearchPage());b.$("#hsx-rpp-lnkHelpFindModelNumber").click(function(){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"HelpMeFindModelNumberClicked")});b.$(".hsx-rpp-popover-option-empty").hide();b.$("#hsx-rpp-brand-popover-filter").bind("paste",function(a){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"PasteBrand")});b.$(g.TEXT_INPUT_ID).bind("paste",function(a){g.metricsLogger.emitMetrics(g.config.metricsPrefix,
"PasteModelNumber")});b.$("#hsx-rpp-brand-popover-trigger").click(function(a){a="#hsx-rpp-onload-popover-search";h===g.DETAIL_PAGE_TYPE&&(a="#hsx-rpp-onload-popover");e.remove(b.$(a));e.get(b.$("#hsx-rpp-brand-popover-action"))&&e.get(b.$("#hsx-rpp-brand-popover-action")).show()});b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){g.showAllPartsThatFit(b.state("rpp").modelBrand,b.state("rpp").modelSeries,b.state("rpp").modelNumber)});b.$(g.TEXT_INPUT_ID).keyup(function(a){g.clearWarnings();var c=
b.$(this).val();13===a.keyCode&&0<c.length&&g.processEnterKeyup(c)});g.BRAND_BUTTON_TEXT=b.$("#hsx-rpp-brand-popover-trigger-announce").text().trim()},initializeSearchPage:function(){if("enter-model"===b.state("rpp").stripeState)k.showEnterModelPopover("hsx-rpp-onload-popover-search"),g.metricsLogger.emitMetrics(g.config.metricsPrefix,"Loaded",{stripeState:b.state("rpp").stripeState}),g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"Loaded");else{var a=b.state("rpp").modelNumber,c=b.state("rpp").modelBrand,
h=b.state("rpp").modelSeries,d=b.state("rpp").modelDisplayBrand;b.state("rpp",{modelNumber:k.htmlDecode(a),modelBrand:k.htmlDecode(c),modelSeries:k.htmlDecode(h)});g.metricsLogger.emitMetrics(g.config.metricsPrefix,"Loaded",{stripeState:b.state("rpp").stripeState,modelNumber:a,modelBrand:c,modelDisplayBrand:d,modelSeries:h,resultCount:b.state("rpp").resultCount,browseNodes:b.state("rpp").browseNode});b.$(g.FEEDBACK_BRAND_ID).attr("value",c);b.$(g.FEEDBACK_MODEL_ID).attr("value",h+" "+a)}b.$("#hsx-rpp-stripeAction").attr("action",
b.state("rpp").widgetRedirectURL);b.$("#hsx-rpp-part-number").bind("paste",function(){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"PastePartNumber")})},initializeDetailPage:function(){b.state("rpp");b.state("rpp");b.state("rpp");"enter-model"===b.state("rpp").stripeState&&(k.showEnterModelPopover("hsx-rpp-onload-popover"),k.showElement(b.$(g.CHECKFITMENTID)));g.metricsLogger.emitMetrics(g.config.metricsPrefix,"Loaded",{asin:b.state("rpp").asin,stripeState:b.state("rpp").stripeState,modelBrand:b.state("rpp").modelBrand,
modelNumber:b.state("rpp").modelNumber,series:b.state("rpp").modelSeries});g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"Loaded");b.$("#replacementPartsFitmentBullet").find(".hsx-rpp-fitment-focus").click(function(a){q.uet instanceof Function&&q.uet("bb","replacement-dropdown",{wb:1});a.preventDefault();k.showElement(b.$(g.STRIPE_CONTAINER));a={scrollTop:b.$("#hsx-rpp-stripeContainer").offset().top};b.$("html,body").animate(a,"fast");b.$("#hsx-rpp-brand-popover-trigger-announce").trigger("click");
k.showEnterModelPopover("hsx-rpp-onload-popover");g.metricsLogger.emitMetrics(g.config.metricsPrefix,"FitmentBulletClicked");b.state("rpp",{bulletAlreadyClicked:!0});q.uex instanceof Function&&q.uex("ld","replacement-dropdown",{wb:1})});b.$("#replacementPartsFitmentBullet").is(":visible")&&g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"BulletVisible")}};b.declarative("hsx-rpp-brand-popover-wrapper","click",function(a){g.selectBrand(a)});b.declarative("hsx-rpp-brand-popover-wrapper",
"keyup",function(a){g.popoverFilter(a)});b.declarative("hsx-rpp-btnCheckAnother","click",function(a){b.state("rpp").finderName===g.finderName&&(b.state("rpp").pageType===g.DETAIL_PAGE_TYPE?(g.metricsLogger.emitMetrics(g.config.metricsPrefix,"ClearModel"),g.reset()):(g.metricsLogger.emitMetrics(g.config.metricsPrefix,"ClearModel"),g.submitSearchForm("","","")))});b.declarative("hsx-rpp-smartbox-btnSearchPart","click",function(a){b.state("rpp").finderName===g.finderName&&"submit"===a.$target.attr("type")&&
(a=b.$("#hsx-rpp-txtPartSearch").val(),g.searchPart(a))});b.declarative("hsx-rpp-smartbox-btnSearchPart","keyup",function(a){b.state("rpp").finderName===g.finderName&&13===a.$event.keyCode&&"hsx-rpp-txtPartSearch"===a.$target.attr("id")&&(a=a.$target.val(),g.searchPart(a))});b.declarative("hsx-rpp-smartbox-btnSeeAllParts","click",function(a){b.state("rpp").finderName===g.finderName&&g.searchAllPartsForModel()});g.selectBrand=function(a){var c=a.$target.attr("class"),k="",f="",f=-1!==c.indexOf("hsx-rpp-brand-popover-option"),
c=-1!==c.indexOf("a-button-text");if(f||c)k=a.$target.attr("value"),f=a.$target.text(),b.state("rpp",{modelBrand:k}),b.state("rpp",{modelDisplayBrand:f}),e.get(b.$("#hsx-rpp-brand-popover-action")).hide(),l("#hsx-rpp-brand-popover-trigger").text(f),b.$(g.TEXT_INPUT_ID).val(""),g.metricsLogger.emitMetrics(g.config.metricsPrefix,"BrandSelected",{modelBrand:k,displayBrand:f,favorite:c}),b.$(g.FEEDBACK_BRAND_ID).attr("value",f),b.$(g.FEEDBACK_MODEL_ID).attr("value",""),a=d(g.NO_DATA_POPOVER_TRIGGER),
c=e.get(a),f=f.trim(),-1<g.noDataBrands.indexOf(f)?(h(c,a,f),b.$(g.TEXT_INPUT_ID).addClass("a-form-disabled").attr("disabled","disabled"),g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"LookForWholegoodsAttemptFail")):(r(c),b.$(g.TEXT_INPUT_ID).unbind("focus").bind("focus",function(a){a={};b.state("rpp").asin&&(a.asin=b.state("rpp").asin);b.state("rpp").modelBrand&&(a.brand=b.state("rpp").modelBrand);b.state("rpp").browseNode&&(a.browseNode=b.state("rpp").browseNode);g.qGroup&&(a.scope=
g.qGroup);b.state("rpp").category&&(a.category=b.state("rpp").category);g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCall");b.$.ajax(g.config.getMyModelUrl,{type:"GET",contentType:"application/json",data:b.$.param(a,!1),dataType:"json",success:function(a){g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallSuccess");g.autocompleteInstances[0].handleReceiveData("",a)},error:function(){g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,
"DataQueryAjaxCallFail")}})}),g.enableModelSearchInput())};g.processEnterKeyup=function(a){if(0<g.autocompleteInstances.length){var c=g.autocompleteInstances[0].getResultCount(),c=parseInt(c,10);1===c?(g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCall"),b.get(g.config.combinedModelSuggestUrl,{params:{q:a,qBrand:b.state("rpp").modelBrand,qGroup:g.qGroup,asin:b.state("rpp").asin,browseNode:b.state("rpp").browseNode,qCategory:b.state("rpp").category},success:function(c){var k=
"undefined"!==typeof c.hits.hits?c.hits.hits[0]._source:c.hits.hit[0].fields;c=k.brand?k.brand:k.normalized_brand;var h=k.series?k.series:k.normalized_series,k=k.modelnumber?k.modelnumber:k.normalized_model,d;d=(h+k).toLowerCase().replace(/\s/g,"");a=a.toLowerCase().replace(/\s/g,"");g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallSuccess");a===d?(b.state("rpp").pageType===g.DETAIL_PAGE_TYPE&&g.checkFitment(c,h,k,b.state("rpp").asin),b.state("rpp").pageType===g.SEARCH_PAGE_TYPE&&
g.filterSearchByModel(c,h,k),b.state("rpp").pageType===g.BROWSE_PAGE_TYPE&&g.showAllPartsThatFit(c,h,k)):0===b.$(".hsx-rpp-ac-summary > #hsx-rpp-selectResultMessage").length&&g.showSelectAutocompleteResultMessage()},error:function(){g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallFail")}})):1<c?g.showSelectAutocompleteResultMessage():(b.$("#hsx-rpp-noResultsMessage").addClass("hsx-rpp-hidden"),k.showElement(b.$("#hsx-rpp-noResultsMessage")),g.metricsLogger.emitMetrics(g.config.metricsPrefix,
"ModelNumberNotFound",{modelNumber:a,modelBrand:b.state("rpp").modelBrand}),g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"LookForWholegoodsAttemptFail"))}};g.showSelectAutocompleteResultMessage=function(){0===b.$(".hsx-rpp-ac-summary > #hsx-rpp-selectResultMessage").length&&b.$(".hsx-rpp-ac-summary").append(b.$("#hsx-rpp-selectResultMessage").clone().removeClass("hsx-rpp-hidden"))};g.enableModelSearchInput=function(a){a=b.state("rpp").modelBrand;g.clearWarnings();var c=g.config.combinedModelSuggestUrl;
0===g.autocompleteInstances.length?g.autocompleteInstances=b.$(g.TEXT_INPUT_ID).rppAutocomplete(c,{doFuzzyMatch:!1,displayValueFields:["series","modelnumber"],maxItemsToShow:k.autocompleteMaxItemsToShow,showCountOfResults:!0,onItemSelect:function(a,c,k,h,d){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"ModelNumberSelected",{typedModelNumber:c,modelNumber:k,modelBrand:b.state("rpp").modelBrand,isFuzzyMatch:h});a=d.brand?d.brand:d.normalized_brand;c=d.series?d.series:d.normalized_series;d=d.modelnumber?
d.modelnumber:d.normalized_model;b.state("rpp").pageType===g.DETAIL_PAGE_TYPE&&g.checkFitment(a,c,d,b.state("rpp").asin);b.state("rpp").pageType===g.SEARCH_PAGE_TYPE&&g.filterSearchByModel(a,c,d);b.state("rpp").pageType===g.BROWSE_PAGE_TYPE&&g.showAllPartsThatFit(a,c,d)},onRequestData:function(a){clearTimeout(g.timer);g.timer=setTimeout(function(){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"ModelNumberEntered",{modelNumber:a,modelBrand:b.state("rpp").modelBrand})},g.DELAY_MS)},recordCSMCounterMetric:function(a){g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,
a)},extraParams:{qBrand:a,qGroup:g.qGroup,asin:b.state("rpp").asin,browseNode:b.state("rpp").browseNode,qCategory:b.state("rpp").category}}):g.autocompleteInstances[0].setExtraParams({qBrand:a,qGroup:g.qGroup,qCategory:b.state("rpp").category,asin:b.state("rpp").asin,browseNode:b.state("rpp").browseNode});b.$(g.TEXT_INPUT_ID).removeAttr("disabled").removeClass("a-form-disabled");setTimeout(function(){b.$(document.activeElement).attr("id")!==g.TEXT_INPUT_ID&&b.$(g.TEXT_INPUT_ID).focus()},500)};g.reset=
function(){l("#hsx-rpp-brand-popover-trigger").text(g.BRAND_BUTTON_TEXT);b.$(g.TEXT_INPUT_ID).attr("disabled","disabled").addClass("a-form-disabled").val("");b.$(g.FITSID).hide();b.$(g.NOTFITSID).hide();k.showElement(b.$(g.CHECKFITMENTID));b.$(".hsx-rpp-popover-filter").val("")};g.checkFitment=function(a,c,h,d){var e={asin:d,modelBrand:a,modelDisplayBrand:b.state("rpp").modelDisplayBrand,modelNumber:h,series:c};g.metricsLogger.emitMetrics(g.config.metricsPrefix,"CheckFitment",e);g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,
"DataQueryAjaxCall");b.$(g.FEEDBACK_MODEL_ID).attr("value",c+" "+h);b.ajax(g.config.checkFitmentUrl,{method:"get",params:{brand:k.normalizeValue(a),series:k.normalizeModelField(c),model:k.normalizeModelField(h),asin:d,doBrandSeriesCheck:1,scope:g.qGroup},success:function(b){b&&1===b.success&&b.payload&&"yes"===b.payload.fitment_decision?(g.metricsLogger.emitMetrics(g.config.metricsPrefix,"FitmentRecordFound",e),g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallSuccess"),
g.showFitsMessage(a,c,h)):(g.metricsLogger.emitMetrics(g.config.metricsPrefix,"NoFitmentRecordFound",e),g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallSuccess"),g.showNotFitsMessage(a,c,h))},error:function(){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"CheckFitmentError",e);g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallFail");g.showNotFitsMessage(a,c,h)}})};g.filterSearchByModel=function(a,c,h){var d=b.$("#hsx-rpp-stripeAction"),
e=b.$('#hsx-rpp-stripeAction input[name="rh"]').val();k.setFormField(d,"rh",k.getRhWithoutKeyword(e));k.setFormField(d,"keywords","");b.$(g.FEEDBACK_BRAND_ID).attr("value",a);b.$(g.FEEDBACK_MODEL_ID).attr("value",c+" "+h);g.putMyModel(h,c,a,g.category);g.submitSearchForm(h,c,a)};g.putMyModel=function(a,c,k,h){b.ajax(g.config.putMyModelUrl,{method:"get",params:{brand:k,model:a,series:c,scope:h},error:function(a,c,k){"timeout"===c?(this.tryCount++,this.tryCount<=this.retryLimit&&b.ajax(this)):400<=
a.status&&500>=a.status?g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"PutMyModelAjaxFailed"):g.metricsLogger.emitCSMCounterMetrics(g.config.metricsPrefix,"DataQueryAjaxCallFail")}})};g.showFitsMessage=function(a,c,h){var d=a+" ";c&&(d+=c+" ");d+=h;b.state("rpp",{stripeState:"result-found"});k.setBulletText(k.prepareBulletText(b.state("rpp").stripeState,d,b.state("rpp").showBullet));k.showBullet();b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){g.showAllPartsThatFit(a,c,h)});d.length>
g.config.fitmentMessagingTextMaxLength+3&&(d=d.substring(0,g.config.fitmentMessagingTextMaxLength+3)+"...");b.$("#hsx-rpp-fitsModelNumber").html(d);k.hideElement(b.$(g.NOTFITSID).hide());k.hideElement(b.$(g.CHECKFITMENTID).hide());k.showElement(b.$(g.FITSID))};g.showNotFitsMessage=function(a,c,h){var d=a+" ";c&&(d+=c+" ");d+=h;b.state("rpp",{stripeState:"no-result"});k.setBulletText(k.prepareBulletText(b.state("rpp").stripeState,d,0));b.$(".hsx-rpp-seeAllPartsThatFit").click(function(){g.showAllPartsThatFit(a,
c,h)});d.length>g.config.fitmentMessagingTextMaxLength+3&&(d=d.substring(0,g.config.fitmentMessagingTextMaxLength+3)+"...");b.$("#hsx-rpp-notfitsModelNumber").html(d);k.hideElement(b.$(g.FITSID));k.hideElement(b.$(g.CHECKFITMENTID));k.showElement(b.$(g.NOTFITSID))};g.showAllPartsThatFit=function(a,b,c){a="/s/ref="+g.config.showAllPartsForModelReftag+"?node="+g.config.defaultRootBrowseNode+"&rpp="+k.getEncodedParameter(a,b,c);q.location.assign(a);g.metricsLogger.emitMetrics(g.config.metricsPrefix,
"SeeAllPartsThatFit")};g.searchAllPartsForModel=function(){var a=b.$("#hsx-rpp-stripeAction");a.attr("action","/s/ref="+g.config.showAllPartsForModelReftag);k.setFormField(a,"keywords","");k.setFormField(a,"rh","");k.setFormField(a,"node",b.state("rpp").rootBrowseNode);var a=b.state("rpp").modelNumber,c=b.state("rpp").modelSeries,h=b.state("rpp").modelBrand;g.metricsLogger.emitMetrics(g.config.metricsPrefix,"SearchAllPartsForModel",{modelNumber:a,modelBrand:h,modelSeries:c});g.submitSearchForm(a,
c,h)};g.searchPart=function(a){var c=b.state("rpp").modelNumber,h=b.state("rpp").modelSeries,d=b.state("rpp").modelBrand,e=b.$("#hsx-rpp-stripeAction"),r=k.getFormField(e,"keywords"),f=k.getFormField(e,"rh"),r=f.replace(r,a);k.setFormField(e,"keywords",a);k.setFormField(e,"rh",r);b.$("#twotabsearchtextbox").val(a);g.metricsLogger.emitMetrics(g.config.metricsPrefix,"SearchPart",{keyword:a,prevRH:f,reformedRH:r});g.submitSearchForm(c,h,d)};g.popoverFilter=function(a){var c=a.$target.val().toLowerCase(),
c=k.toHalfWidth(c);if(13===a.keyCode){a=b.$(".hsx-rpp-brand-popover-option").length;var h=b.$(".hsx-rpp-brand-popover-option:hidden").length;1===a-h&&(a=b.$(".hsx-rpp-brand-popover-option:visible")[0],b.$(a).trigger("click"))}b.$(".hsx-rpp-brand-popover-option").each(function(a,k){var h=b.$(k).attr("value").toLowerCase(),d=b.$(k).text().toLowerCase();0===h.indexOf(c)||0===d.indexOf(c)?b.$(k).show():b.$(k).hide()});a=b.$(".hsx-rpp-brand-popover-option").length;h=b.$(".hsx-rpp-brand-popover-option:hidden").length;
0!==a&&h===a?(k.showElement(b.$("#hsx-rpp-brand-popover-filter").siblings("span.hsx-rpp-popover-option-empty")),clearTimeout(g.timer),g.timer=setTimeout(function(){g.metricsLogger.emitMetrics(g.config.metricsPrefix,"BrandNotFound",{modelBrand:b.$("#hsx-rpp-brand-popover-filter").val()})},g.DELAY_MS)):k.hideElement(b.$("#hsx-rpp-brand-popover-filter").siblings("span.hsx-rpp-popover-option-empty"))};g.createEntityFilters=function(a,b,c,k,h,d){var g=[];g.brand=[];g.model=[];g.series=[];g.brand.value=
c;g.brand.text=k;g.model.value=a;g.model.text=b;g.series.value=h;g.series.text=d;return g};g.submitSearchForm=function(a,c,h){var d=b.$("#hsx-rpp-stripeAction"),e=b.state("rpp").modelDisplayBrand,e=g.createEntityFilters(a,a,h,e,c,c),e=k.getEncodedParameterForSmartbox(e,g.finderName);k.setFormField(d,k.searchParameterConfig.parameter,e);b.objectIsEmpty(a)&&b.objectIsEmpty(c)&&b.objectIsEmpty(h)&&k.setFormField(d,"rd","1");b.$(d).submit()};g.clearWarnings=function(){k.hideElement(b.$("#hsx-rpp-errorMessage"));
b.$("#hsx-rpp-noResultsMessage").hide()};g.getBrandOption=function(a,b,c,k){var h=15;"undefined"!==typeof k&&-1!==k&&(h=k);a=a.length<h+3?a:a.substring(0,h)+"...";return'<span class="hsx-rpp-popover-option '+c+'" title="'+a+'" value="'+b+'" tabindex="0">'+a+"</span>"};return g})});p.when("A","a-popover","SmartboxTextHandler","HSXMetricsLogger","SmartboxDisplayHandler","ReplacementPartsStripeFeedbackWidgetModule","ready").register("SmartboxAutoComplete",function(e,b,n,f,l,d){var c={},
m;c.config={delay:250,keysToIgnoreFromSearch:[112,113,114,115,116,117,118,119,120,122,123,124,125,126,16,17,20,33,34,37,38,39,40],minimumLength:2};c.initialize=function(a){e.state("rpp")&&e.state(n.config.entityFiltersPageStateKey)||e.state.parse();m=e.$("#"+a);c.metricsLogger=f.createLogger();c.mouseDownSelected=!1;l.initialize(a);n.initialize(l);e.$("#hsx-rpp-smartbox-search");d.loadWidget("hsx-rpp-feedbackContainer","hsx-rpp-feedbackButton",e.state("rpp"));m.keydown(function(a){if(40===a.keyCode)a.preventDefault(),
l.moveSelect(1);else if(38===a.keyCode)a.preventDefault(),l.moveSelect(-1);else if(13===a.keyCode||9===a.keyCode)c.handleEnterPress(),a.preventDefault()});e.$("#hsx-rpp-lnkModelNumberPrompt").click(c.triggerEnterModelPopover);m.focus(function(a){if(!0===l.experienceEnhancePopoverClose)m.blur(),l.experienceEnhancePopoverClose=!1;else{l.removeExperienceEnhancePopover(e.$("#hsx-rpp-smartbox-txtModelNumber"));n.config.customerEngaged||(c.metricsLogger.emitMetrics(n.config.metricsPrefix,"CustomerEngaged"),
n.config.customerEngaged=!0);var b=m.val();""===b?(n.myModelQuery(),n.autoPrefilled()):1<b.length&&c.textHandler(a)}});m.keyup(function(a){-1===e.$.inArray(a.keyCode,c.config.keysToIgnoreFromSearch)&&c.delay(function(){c.textHandler(a)},c.config.delay)});m.bind("paste",function(a){c.delay(function(){n.getCurrentQueryType()===n.config.qType.autocomplete&&c.metricsLogger.emitMetrics(n.config.metricsPrefix,"PasteModel");c.textHandler(a)},c.config.delay)});c.textHandler(e.$.Event("keyup",{keyCode:null}));
m.blur(function(){c.mouseDownSelected||l.hideSuggestionBox()});e.$("#hsx-rpp-smartbox-suggestions").bind("mousedown","li",function(a){c.mouseDownSelected=!0}).bind("mouseup","li",function(a){c.mouseDownSelected=!1});e.$("#hsx-rpp-smartbox-suggestions").delegate("a","click",function(a){c.metricsLogger.emitMetrics(n.config.metricsPrefix,"PartSelected",{"partNumber:":m.val()});e.state.replace(n.config.partVerifiedKey,{state:!0});n.searchPart(e.$(this).text())});e.$("#hsx-rpp-smartbox-suggestions").bind("click",
"li",function(a){a.preventDefault();var b=e.$(a.target);"B"===a.target.tagName&&(b=b.parent());c.updateFilterWithSelectedItem(b)})};c.textHandler=function(a){if(!n.config.partSearch){var b=e.$.trim(m.val());"undefined"!==typeof b&&(8===a.keyCode&&b.length<c.config.minimumLength?(n.entityContext={},n.autoPrefilled()):(b.length>=c.config.minimumLength||0<n.getFiltersCount())&&-1===e.$.inArray(a.keyCode,c.config.keysToIgnoreFromSearch)&&n.search(b))}};c.handleEnterPress=function(){var a=l.getHighlightedListItem();
if("undefined"===typeof a){var b=m.val(),a=c.checkExactMatchItem(b);null===a&&c.metricsLogger.emitMetrics(n.config.metricsPrefix,"ModelNumberNotFound",{modelNumber:b})}c.updateFilterWithSelectedItem(a)};c.checkExactMatchItem=function(a){var b=e.$("li",e.$("#hsx-rpp-smartbox-results-popover"));a=a.trim().toLowerCase().split(/[ -]+/);for(var c=0;c<b.length;c++){for(var d=e.$(b[c]).data("modelInfo").toLowerCase().split(" "),g=a.slice(),f=0;f<d.length;f++)if(""!==d[f]&&0!==d[f].length){var m=g.indexOf(d[f]);
if(-1<m)g.splice(m,1);else break}if(0===g.length&&f===d.length)return e.$(b[c])}return null};c.updateFilterWithSelectedItem=function(a){if(a){var b=a.data("action");if(!e.objectIsEmpty(b))if("searchPart"===b)n[b](a.data("modelInfo"));else c.metricsLogger.emitMetrics(n.config.metricsPrefix,"AutocompleteUsed",{entity:"AutoComplete",value:a.data("id")}),m.val(a.data("modelInfo").toLowerCase()),n.updateEntityFilterWithSelectedItem(a);else if(a.data("entity")){var b=a.data("entity"),h=a.text();c.metricsLogger.emitMetrics(n.config.metricsPrefix,
"AutocompleteUsed",{entity:b,value:h});n.updateEntityFilter(b,h,a.data("id"),n.config.entityFilterSource.customerSelection)}}};c.triggerEnterModelPopover=function(){c.metricsLogger.emitMetrics(n.config.metricsPrefix,"EnterModelPopover");c.enterModelPopoverInstance||c.updatePopoverInstance();c.enterModelPopoverInstance&&(c.enterModelPopoverInstance.show(),setTimeout(function(){c.enterModelPopoverInstance&&null!==c.enterModelPopoverInstance&&c.enterModelPopoverInstance.hide()},2E3))};c.updatePopoverInstance=
function(){var a='<div class="hsx-rpp-modelnumber-popover-content">'+e.$(".hsx-rpp-modelnumber-popover-content").html()+"</div>",k=e.$(".hsx-rpp-enterModelPopupPlaceHolder");k.css({width:e.$(".hsx-rpp-smartbox-search").width()+"px"});c.enterModelPopoverInstance=b.create(k,{content:a,name:"hsx-rpp-enterModelNumberPrompt",position:"triggerBottom",width:e.$(".hsx-rpp-smartbox-search").width()+"px",popoverLabel:"Enter your model number to make sure this fits"})};c.delay=function(){var a=0;return function(b,
c){clearTimeout(a);a=setTimeout(b,c)}}();e.declarative("hsx-rpp-smartbox-btnSearchPart","click keyup",function(a){if(e.state("rpp").finderName===n.finderName){var b="";"click"===a.type&&"a-button-input"===a.$target.attr("class")&&(b=e.$.trim(m.val()));"keyup"===a.type&&13===a.$event.which&&(b=e.$.trim(m.val()));0<b.length&&(c.metricsLogger.emitMetrics(n.config.metricsPrefix,"PartSecondarySearch",{partKeyword:b}),n.searchPart(b))}});e.declarative("hsx-rpp-btnCheckAnother","click",function(a){e.state("rpp").finderName===
n.finderName&&(e.state("rpp",{stripeState:n.config.state.enterModel}),c.metricsLogger.emitMetrics(n.config.metricsPrefix,"ClearModel"),n.resetStripe())});e.$("#hsx-rpp-lnkHelpFindModelNumber").click(function(){e.state("rpp").finderName===n.finderName&&c.metricsLogger.emitMetrics(n.config.metricsPrefix,"HelpMeFindModelNumberClicked")});e.declarative("hsx-rpp-smartbox-input","click keydown mouseenter",function(a){a=!m||!m.is(e.$("#hsx-rpp-smartbox-txtModelNumber"));e.state("rpp").finderName===n.finderName&&
a&&c.initialize("hsx-rpp-smartbox-txtModelNumber")});e.declarative("hsx-rpp-smartbox-btnSearchPart","click keydown mouseenter",function(a){a=!m||!m.is(e.$("#hsx-rpp-txtPartSearch"));e.state("rpp").finderName===n.finderName&&a&&c.initialize("hsx-rpp-txtPartSearch")});return c});p.when("A","a-popover","a-button","HSXMetricsLogger","ReplacementPartsStripeUtility","ReplacementPartsStripeModelHelpModule","ready").register("SmartboxTextHandler",function(e,b,n,f,l,d){var c={},m;c.entityContext=
{};c.currentState=null;c.DETAIL_PAGE_TYPE="detail";c.SEARCH_PAGE_TYPE="search";c.BROWSE_PAGE_TYPE="browse";c.finderName="smartbox";c.config={queryUrl:"/gp/replacement-parts/ajax/smartbox-query.html",configUrl:"/gp/replacement-parts/ajax/smartbox-config.html",checkFitmentUrl:"/gp/replacement-parts/ajax/hsx-rpp-dp-ajax-handler.html",putMyModelUrl:"/gp/replacement-parts/ajax/my-model.html",getMyModelUrl:"/gp/replacement-parts/ajax/my-model.html?getMyModel=1",metricsPrefix:"hsxRPPSmartbox",showAllPartsForModelReftag:"dp_rpp_stripe_showallparts",
entityFiltersPageStateKey:"hsx-rpp-entity-filters",myModelPageStateKey:"hsx-rpp-my-model-data",stripe:"sb",customerEngaged:!1,qType:{autocomplete:"smartboxAutocomplete",partVerification:"partVerification",part:"part"},modelTypes:{recentlySearchedModels:"myModels",popularModels:"popularModels",elasticSearchModels:"elasticSearchModels"},entityFilterSource:{autocomplete:"Smartbox Auto Complete"},state:{resultsFound:"result-found",noResults:"no-result",enterModel:"enter-model"},entities:{brand:{required:"true",
text:"display_brand",value:"normalized_brand"},model:{required:"true",text:"display_model",value:"normalized_model"},series:{required:"true",text:"display_series",value:"normalized_series"},part:{required:"false",text:"part_number",value:"part_number",action:"searchPart"}},entitySequence:["brand","series","model"],orderMap:{brand:["brand","series","model"],series:["series","model","brand"],model:["model","brand","series"]}};c.initialize=function(a){m=a;c.metricsLogger=f.createLogger();(a=e.state(c.config.entityFiltersPageStateKey))&&
0!==l.getKeys(a).length||e.state(c.config.entityFiltersPageStateKey,{});(a=e.state(c.config.myModelPageStateKey))&&0!==l.getKeys(a).length||c.initializeMyModelCache();c.config.pageType=e.state("rpp").pageType;c.config.metricsPrefix=c.config.pageType===c.DETAIL_PAGE_TYPE?c.config.metricsPrefix+"DetailPage":c.config.metricsPrefix+"SearchPage";(a=e.state("rpp"))?c.parseWidgetConfig(a):c.metricsLogger.emitMetrics(c.config.metricsPrefix,"WidgetConfigLoadFailed");c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"StripeLoaded",{stripeState:c.currentState,resultCount:e.state("rpp").resultCount});c.currentState===c.config.state.enterModel&&c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"StripeLoaded");c.bindEventonEntityFilterUpdate();c.currentState!==c.config.state.enterModel&&m.adjustTextboxPosition();var b="ink_toner"!==c.config.category&&"camera"!==c.config.category&&"pc"!==c.config.category;c.currentState===c.config.state.enterModel&&b&&(d.helpMeFindModelNumber.initialize(),d.bindEvents(c.metricsLogger,
c.config.metricsPrefix));b=c.getModelBrandDisplayValue();l.setBulletText(l.prepareBulletText(c.currentState,b,a.showBullet));c.currentState!==c.config.state.noResults&&0!==a.showBullet&&l.showBullet();c.myModelQuery();e.$("#replacementPartsFitmentBullet").find(".hsx-rpp-fitment-focus").click(function(a){a.preventDefault();l.showElement(e.$("#hsx-rpp-stripeContainer"));a={scrollTop:e.$("#hsx-rpp-stripeContainer").offset().top};e.$("html,body").animate(a,"fast");c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"FitmentBulletClicked");e.state("rpp",{bulletAlreadyClicked:!0});e.$("#hsx-rpp-smartbox-txtModelNumber").focus()});e.state.bind("rpp",c.updateBulletForStateChange);e.declarative("hsx-rpp-smartbox-btnSeeAllParts","click",function(a){e.state("rpp").finderName===c.finderName&&c.showAllPartsThatFit()});c.config.hideStripeOnLoad||c.currentState!==c.config.state.enterModel||""!==e.$("#hsx-rpp-smartbox-txtModelNumber").val().trim()||m.showExperienceEnhancePopover(e.$("#hsx-rpp-smartbox-txtModelNumber"),
c.config.pageType,c.config.category);e.on("a:popover:dismiss:rpp-smartbox-experienceEnhance-popover",function(){m.removeExperienceEnhancePopover(e.$("#hsx-rpp-smartbox-txtModelNumber"));m.experienceEnhancePopoverClose=!0})};c.updateBulletForStateChange=function(a,b){if(b.stripeState&&"detail"===a.pageType){var h=c.getModelBrandDisplayValue();l.setBulletText(l.prepareBulletText(e.state("rpp").stripeState,h,e.state("rpp").showBullet));l.showBullet()}};c.parseWidgetConfig=function(a){c.config.partSearch=
a.partSearch;c.config.asin=a.asin;c.config.browseNode=a.browseNode;c.config.category=a.category;c.currentState=a.stripeState;c.config.hideStripeOnLoad=a.hideStripeOnLoad;a.stripeParams&&(c.config.scope=a.stripeParams.scope);c.config.pageType!==c.DETAIL_PAGE_TYPE&&c.currentState!==c.config.state.enterModel&&(c.config.partSearch=!0);e.$.ajax(c.config.configUrl,{type:"GET",contentType:"application/json",dataType:"json",success:function(a){a?c.pullStringsFromPageState(a):c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"EntityConfigNull",{entityConfigVersion:c.config.entityConfigVersion})},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,"EntityConfigCallFailed",{entityConfigVersion:c.config.entityConfigVersion})}})};c.pullStringsFromPageState=function(a){a?c.config.strings=a:c.metricsLogger.emitMetrics(c.config.metricsPrefix,"StringsUndefined")};c.bindEventonEntityFilterUpdate=function(){e.state.bind(c.config.entityFiltersPageStateKey,function(a,b){c.updateFeedbackParams();m.updateSuggestions({});
!0===c.isDataAvailableForFitmentCheck()&&c.doFitmentCheck()})};c.isDataAvailableForFitmentCheck=function(){var a=e.state(c.config.entityFiltersPageStateKey);if(a){var b=!0;e.$.each(c.config.entitySequence,function(h,d){if("true"===c.config.entities[d].required&&!a[d])return b=!1});return b}};c.doFitmentCheck=function(){c.config.pageType===c.SEARCH_PAGE_TYPE?(c.putMyModel(),c.submitForm()):c.config.pageType===c.BROWSE_PAGE_TYPE?c.showAllPartsThatFit():c.checkFitment()};c.showAllPartsThatFit=function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"SeeAllPartsThatFit");if(c.config.pageType===c.DETAIL_PAGE_TYPE){var a=e.state(c.config.entityFiltersPageStateKey),a=l.getEncodedParameterForSmartbox(a,c.config.stripe),b=e.state("rpp").rootBrowseNode;q.location.assign("/s/ref="+c.config.showAllPartsForModelReftag+"?node="+b+"&rpp="+a)}else a=e.$("#hsx-rpp-stripeAction"),l.setFormField(a,"keywords",""),l.setFormField(a,"rh",""),l.setFormField(a,"node",e.state("rpp").rootBrowseNode),c.submitForm()};c.searchAllPartsForModel=function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"SearchAllPartsForModel");var a=e.$("#hsx-rpp-stripeAction");l.setFormField(a,"keywords","");l.setFormField(a,"rh","");l.setFormField(a,"node",e.state("rpp").rootBrowseNode);c.submitForm()};c.submitForm=function(){var a=e.state(c.config.entityFiltersPageStateKey),b="";a&&(b=l.getEncodedParameterForSmartbox(a,c.config.stripe));var h=e.$("#hsx-rpp-txtPartSearch").val(),a=e.$("#hsx-rpp-stripeAction");a.attr("action","/s/ref="+c.config.showAllPartsForModelReftag);l.setFormField(a,"rpp",b);c.currentState===
c.config.state.enterModel?(b=e.$("#hsx-rpp-stripeAction input[name='rh']").val(),l.setFormField(a,"rh",l.getRhWithoutKeyword(b)),l.setFormField(a,"keywords","")):"undefined"!==typeof h&&l.setFormField(a,"keywords",h);l.setFormField(a,"rd","1");e.$(a).submit()};c.searchPart=function(a){if(a){var b=e.$("#hsx-rpp-stripeAction"),h=l.getFormField(b,"keywords"),d=l.getFormField(b,"rh"),h=d.replace(h,a);l.setFormField(b,"keywords",a);l.setFormField(b,"rh",h);b.attr("action","/s/ref="+c.config.showAllPartsForModelReftag);
e.$("#twotabsearchtextbox").val(a);c.metricsLogger.emitMetrics(c.config.metricsPrefix,"SearchPart",{keyword:a,prevRH:d,reformedRH:h});e.$(b).submit()}};c.putMyModel=function(){var a=e.state(c.config.entityFiltersPageStateKey),b=a.model?a.model.value:"",h=a.series?a.series.value:"",d=c.config.asin,g=c.config.scope;e.ajax(c.config.putMyModelUrl,{method:"get",params:{brand:l.normalizeValue(a.brand?a.brand.value:""),model:l.normalizeModelField(b),series:l.normalizeModelField(h),asin:d,scope:g},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,
"putMyModel failed")}})};c.updateEntityFilterWithSelectedItem=function(a){if(a){var b=a.data("id");a=a.data("modelType");if(b){var h=e.state(c.config.entityFiltersPageStateKey),d=b.split("#");if(d&&1<d.length){var g={},f=0;e.$.each(c.config.entitySequence,function(a,b){if("true"===c.config.entities[b].required){var k=d[f++];(k=k?k.split("^"):null)&&2===k.length&&(h[b]={text:k[0],value:k[1],source:c.config.entityFilterSource.autocomplete},""!==b&&(g["display_"+b]=k[0],g["normalized_"+b]=k[1]))}});
a===c.config.modelTypes.popularModels&&c.metricsLogger.emitMetrics(c.config.metricsPrefix,"PopularModelSelected",{"modelBrand ":h.brand.value,"modelNumber ":h.model.value,"modelSeries ":h.series.value});b=e.state(c.config.myModelPageStateKey);b.myModels.data.unshift(g);e.state.replace(c.config.myModelPageStateKey,b);h.modelType=a;e.state.replace(c.config.entityFiltersPageStateKey,h);m.hideSuggestionBox()}}}};c.search=function(a){if(null!==a){var b={};a=e.$.trim(a);b.input=a;var h=c.getCurrentQueryType();
b.qType=h;c.config.scope&&(b.scope=c.config.scope);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCall");c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"LookForWholegoodsAttempt");e.$.ajax(c.config.queryUrl,{type:"GET",contentType:"application/json",data:e.$.param(b,!1),dataType:"json",success:function(d){var g={};g[h]={};g[h]=c.parseSearchResults(d,a);h===c.config.qType.autocomplete&&(d=e.state(c.config.myModelPageStateKey),c.myModelDataExists(d,"data")?
(g[h].myModels=c.parseSearchResultsForMyModel(d.myModels,a),g[h].popularModels=c.parseSearchResultsForMyModel(d.popularModels,a)):c.metricsLogger.emitMetrics(c.config.metricsPrefix,"NoMyModelData",b));c.searchResultsHandler(g,h,a);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallSucceed")},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,"SearchCallFailed",b);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallFail");c.searchResultsErrorHandler(h,
a,c.config.strings.ajax_error)}})}};c.myModelQuery=function(){var a=e.state(c.config.myModelPageStateKey);if(!c.myModelDataExists(a,"data")){var b={};c.config.pageType===c.DETAIL_PAGE_TYPE?c.config.asin&&(b.asin=c.config.asin):c.config.browseNode&&(b.browseNode=c.config.browseNode);c.config.scope&&(b.scope=c.config.scope);c.config.category&&(b.category=c.config.category);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCall");e.$.ajax(c.config.getMyModelUrl,{type:"GET",contentType:"application/json",
data:e.$.param(b,!1),dataType:"json",success:function(a){c.myModelDataExists(a,"data")&&(e.state.replace(c.config.myModelPageStateKey,a),c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallSucceed"))},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,"MyModelQueryFailed",b);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallFail")}})}};c.initializeMyModelCache=function(){e.state(c.config.myModelPageStateKey,{myModels:{"meta-data":{count:0},
data:[]},popularModels:{"meta-data":{count:0},data:[]}})};c.myModelDataExists=function(a,b){return a&&(a.myModels&&"undefined"!==typeof a.myModels[b]&&0<a.myModels[b].length||a.popularModels&&"undefined"!==typeof a.popularModels[b]&&0<a.popularModels[b].length)?!0:!1};c.isValidInput=function(a){return a?a!==c.entityContext.prevSearchQuery:!0};c.getCurrentQueryType=function(){var a="";return a=c.config.partSearch?c.config.qType.part:c.config.qType.autocomplete};c.createSuggestionsEntity=function(a,
b,h,d){var g=[];e.$.each(a,function(a,f){var m="",l="";c.config.partSearch?"undefined"!==typeof h?(m=f[h][c.config.entities.part.text],l=f[h][c.config.entities.part.value]):(m=f[c.config.entities.part.text],l=f[c.config.entities.part.value]):(l=c.matchOrder(f,c.config.orderMap,b,h,d),m=l.text,l=l.value);e.objectIsEmpty(m)||e.objectIsEmpty(l)||g.push({text:e.$.trim(m),value:l.slice(0,-1)})});return g};c.parseSearchResults=function(a,b){var h={results:[]};a&&(a.aggregations?(h.total=a.aggregations.group_by.buckets.length,
e.$.each(a.aggregations.group_by.buckets,function(a,b){if(!(a>=c.config.aggregatedResultLimit)){var k;b.key&&(k=b.key.split("#"));k&&1<k.length&&h.results.push({text:k[0],value:k[1]})}})):(h.total=a.hits.total,h.results=c.createSuggestionsEntity(a.hits.hits,b,"_source",!0)));return h};c.parseSearchResultsForMyModel=function(a,b,h){var d={};d.results=c.createSuggestionsEntity(a.data,b,h,!1);return d};c.autoPrefilled=function(){var a=c.getCurrentQueryType();if(a===c.config.qType.autocomplete){var b=
{};b[a]={};var h=e.state(c.config.myModelPageStateKey);h.myModels&&h.popularModels&&(b[a].myModels=c.parseSearchResultsForMyModel(h.myModels),b[a].popularModels=c.parseSearchResultsForMyModel(h.popularModels),h=c.getSuggestionsAttributes(a,!0),m.updateSuggestions(b,a,h,""))}};c.matchOrder=function(a,b,h,d,g){var e="",f=[],m={},l="";"undefined"!==typeof h&&(f=h.toLowerCase().split(/[ -]+/));for(var x=c.config.entitySequence,n=0;n<x.length;n++){var z=x[n],w="",w="undefined"!==typeof d?a[d][c.config.entities[z].value]:
a[c.config.entities[z].value];""===w&&(l=z);m[z]=w.split(/[ -]+/)}z=0;for(w=!1;z<f.length;){w=!1;for(n=0;n<x.length;n++){for(var p=m[x[n]],v=!1,q=0;q<p.length;q++)if(c.isPrefix(p[q],f[z])){for(var t=z,J=q;t<f.length&&J<p.length&&c.isPrefix(p[J],f[t]);)t++,J++;if(t===f.length||J===p.length){""===e&&(e=x[n]);z=t;v=!0;break}}if(!0===v){w=!0;break}}if(!1===w)break}if(!g)return"undefined"===typeof h||w?c.constructSuggestionText(a,b.brand,d):{text:"",value:""};""===e&&(e=""!==l?l:"model");return c.constructSuggestionText(a,
b[e],d)};c.constructSuggestionText=function(a,b,h){var d="",g="";e.$.each(b,function(b,k){d="undefined"!==typeof h?d+(a[h][c.config.entities[k].text]+" "):d+(a[c.config.entities[k].text]+" ")});var f=!1;e.$.each(c.config.entitySequence,function(b,k){"undefined"!==typeof h?(g+=a[h][c.config.entities[k].text]+"^"+a[h][c.config.entities[k].value]+"#",c.checkFieldValueMismatch(a[h][c.config.entities[k].text],a[h][c.config.entities[k].value])&&(f=!0)):(g+=a[c.config.entities[k].text]+"^"+a[c.config.entities[k].value]+
"#",c.checkFieldValueMismatch(a[c.config.entities[k].text],a[c.config.entities[k].value])&&(f=!0))});f&&c.metricsLogger.emitMetrics(c.config.metricsPrefix,"FieldValueCaseMismatch");return{text:d,value:g}};c.checkFieldValueMismatch=function(a,b){return a.toLowerCase()===b.toLowerCase()&&a!==b?!0:!1};c.isPrefix=function(a,b){return a.length<b.length?!1:a.toLowerCase().substring(0,b.length)===b};c.updateEntityContext=function(a,b){a&&(c.entityContext.prevSearchQuery=b,e.$.each(a,function(a,b){b&&b.results&&
(c.entityContext[a]=b.total)}))};c.searchResultsHandler=function(a,b,h){c.updateEntityContext(a,h);var d="";a[b]&&"undefined"!==typeof a[b].results&&0>=a[b].results.length&&!c.config.partSearch&&!c.myModelDataExists(a[b],"results")?(b!==c.config.qType.autocomplete&&c.metricsLogger.emitMetrics(c.config.metricsPrefix,"EntityNotFound",{qType:b,q:h}),c.config.pageType!==c.DETAIL_PAGE_TYPE?c.partVerification(h,b):(d=c.config.strings.no_model_match,h=c.getSuggestionsAttributes(b,!1),m.updateSuggestions(a,
b,h,d),c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"LookForWholegoodsAttemptFail"))):(h=c.getSuggestionsAttributes(b,!1),c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"LookForWholegoodsAttemptSucceed"),m.updateSuggestions(a,b,h,d))};c.partVerification=function(a,b){if(null!==a){var h={};a=e.$.trim(a);e.state(c.config.entityFiltersPageStateKey);h.input=a;h.qType=c.config.qType.partVerification;c.config.scope&&(h.scope=c.config.scope);var d="";c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,
"DataQueryAjaxCall");e.$.ajax(c.config.queryUrl,{type:"GET",contentType:"application/json",data:e.$.param(h,!1),dataType:"json",success:function(h){var e=c.getSuggestionsAttributes(b,!1);h&&h.hits&&0<h.hits.total?(e.isPartNumber=1,e.partNumber=a,d=c.config.strings.no_model_match_part,c.metricsLogger.emitMetrics(c.config.metricsPrefix,"PartNumberFound",{"partNumber:":a}),c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"LookForWholegoodsAttemptSuccess")):(c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,
"LookForWholegoodsAttemptFail"),d=c.config.strings.no_model_match);m.updateSuggestions(h,b,e,d);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallSucceed")},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,"SearchCallFailed",h);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallFail");d=c.config.strings.no_model_match;var a=c.getSuggestionsAttributes(b,!1);m.updateSuggestions({},b,a,d)}})}};c.checkFitment=function(){var a=
e.state(c.config.entityFiltersPageStateKey),b=a.brand?a.brand.value:"",h=a.model?a.model.value:"",d=a.series?a.series.value:"",g=1,f=c.config.asin,m=c.config.scope,B={asin:f,modelBrand:b,modelDisplayBrand:a.brand?a.brand.text:"",modelNumber:h,modelSeries:d};(a.modelType?a.modelType:"")===c.config.modelTypes.elasticSearchModels&&(g=0);c.metricsLogger.emitMetrics(c.config.metricsPrefix,"CheckFitment",B);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCall");e.ajax(c.config.checkFitmentUrl,
{method:"get",params:{brand:l.normalizeValue(b),model:l.normalizeModelField(h),series:l.normalizeModelField(d),scope:m,asin:f,savedModelSelected:g},success:function(a){a&&1===a.success&&a.payload&&"yes"===a.payload.fitment_decision?(c.metricsLogger.emitMetrics(c.config.metricsPrefix,"FitmentRecordFound",B),e.state("rpp",{modelBrand:b,modelNumber:h,modelSeries:d,stripeState:c.config.state.resultsFound}),c.showFitsMessage()):(c.metricsLogger.emitMetrics(c.config.metricsPrefix,"NoFitmentRecordFound",
B),e.state("rpp",{modelBrand:b,modelNumber:h,modelSeries:d,stripeState:c.config.state.noResults}),c.showNotFitsMessage());c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCallSucceed")},error:function(){c.metricsLogger.emitMetrics(c.config.metricsPrefix,"CheckFitmentError",B);c.metricsLogger.emitCSMCounterMetrics(c.config.metricsPrefix,"DataQueryAjaxCall");e.state("rpp",{modelBrand:b,modelNumber:h,modelSeries:d,stripeState:c.config.state.noResults});c.showNotFitsMessage()}})};
c.updateFeedbackParams=function(){var a=e.state(c.config.entityFiltersPageStateKey),b=a.brand?a.brand.value:"",a=(a.model?a.model.value:"")+" "+(a.series?a.series.value:"");e.$("#hsx-rpp-feedback-model-series").attr("value",a);e.$("#hsx-rpp-feedback-brand").attr("value",b)};c.getModelBrandDisplayValue=function(){var a="",b=e.state(c.config.entityFiltersPageStateKey);e.$.each(c.config.entitySequence,function(c,d){b[d]&&(a+=b[d].text+" ")});return""!==a?a.slice(0,-1):a};c.getSuggestionsAttributes=function(a,
b){var h="",d="";a===c.config.qType.autocomplete?(h=c.config.qType.autocomplete,d=c.config.strings.model):a===c.config.qType.part&&(h="searchPart");return{action:h,title:d,partSearch:c.config.partSearch,isAutoPrefilled:b,myModelTitle:{myModels:c.config.strings.my_model,popularModels:c.config.strings.popular_model}}};c.searchResultsErrorHandler=function(a,b,h){b=c.getSuggestionsAttributes(a,!1);m.updateSuggestions({},a,b,h)};c.resetStripe=function(){c.clear();c.config.pageType===c.DETAIL_PAGE_TYPE?
c.showEnterModelMessage():c.submitForm()};c.clear=function(){c.config.pageType===c.DETAIL_PAGE_TYPE&&m.updateSuggestions({});e.$("#hsx-rpp-smartbox-txtModelNumber").val("");e.state.replace(c.config.entityFiltersPageStateKey,{});c.entityContext={}};c.showEnterModelMessage=function(){c.currentState=c.config.state.enterModel;e.$("#hsx-rpp-fitsContainer").addClass("aok-hidden");e.$("#hsx-rpp-notfitsContainer").addClass("aok-hidden");e.$("#hsx-rpp-checkFitmentContainer").removeClass("aok-hidden")};c.updateEntityFilter=
function(a,b,h,d){var g=e.state(c.config.entityFiltersPageStateKey);g&&(g[a]={text:b,value:h,source:d});e.state(c.config.entityFiltersPageStateKey,g);"brand"===a?e.state("rpp",{modelBrand:b}):"model"===a?e.state("rpp",{modelNumber:b}):"series"===a&&e.state("rpp",{modelSeries:b})};c.getFiltersCount=function(){return l.getKeys(e.state(c.config.entityFiltersPageStateKey)).length};c.parseEntityFilterForQuery=function(){var a=e.state(c.config.entityFiltersPageStateKey),b={};a&&e.$.each(a,function(a,c){b[a]=
c.value});return b};c.showFitsMessage=function(){c.currentState=c.config.state.resultsFound;var a=e.state(c.config.entityFiltersPageStateKey);e.$("#hsx-rpp-fitsContainer").removeClass("aok-hidden");e.$("#hsx-rpp-notfitsContainer").addClass("aok-hidden");e.$("#hsx-rpp-checkFitmentContainer").addClass("aok-hidden");var b=c.getModelBrandDisplayValue();e.$("#hsx-rpp-fitsModelNumber").text(b);a=l.getEncodedParameterForSmartbox(a,c.config.stripe);b=e.state("rpp").rootBrowseNode;a="/s/ref="+c.config.showAllPartsForModelReftag+
"?node="+b+"&rpp="+a;e.$("#hsx-rpp-smartbox-seeallparts").data("url",a)};c.showNotFitsMessage=function(){c.currentState=c.config.state.resultsFound;var a=e.state(c.config.entityFiltersPageStateKey);e.$("#hsx-rpp-fitsContainer").addClass("aok-hidden");e.$("#hsx-rpp-notfitsContainer").removeClass("aok-hidden");e.$("#hsx-rpp-checkFitmentContainer").addClass("aok-hidden");var b=c.getModelBrandDisplayValue();e.$("#hsx-rpp-notfitsModelNumber").text(b);a=l.getEncodedParameterForSmartbox(a,c.config.stripe);
b=e.state("rpp").rootBrowseNode;a="/s/ref="+c.config.showAllPartsForModelReftag+"?node="+b+"&rpp="+a;e.$("#hsx-rpp-smartbox-seeallparts").data("url",a)};return c});p.when("A","a-popover","ReplacementPartsStripeUtility","ready").register("SmartboxDisplayHandler",function(e,b,n){var f={},l,d,c,m,a=-1,k=[];f.modelTypes={recentlySearchedModels:"myModels",popularModels:"popularModels",elasticSearchModels:"elasticSearchModels"};f.modelNumLimits={myModels:10,popularModels:10,elasticSearchModels:5};
f.experienceEnhancePopoverClose=!1;f.initialize=function(a){l=e.$("#"+a);d=e.$("#hsx-rpp-smartbox-results-popover");c=d.find("#hsx-rpp-smartbox-suggestions");m=d.find("#hsx-rpp-smartbox-looking-for-more-items")};f.findPos=function(a){for(var b=a.offset(),c=0;a.length&&!a.is("body");){var k=a.css("z-index");if((k=parseInt(k,99))||!isNaN(k))c=Math.max(k,c);a=a.offsetParent()}return{x:Math.ceil(b.left),y:Math.ceil(b.top),zIndex:c+10}};f.getSuggestions=function(a,b,c,d,m){for(var B=[],n=0,x=f.modelNumLimits[d],
R=e.$.trim(l.val()),z=0;z<a.length&&n<x;z++){var p=a[z];if(p.text&&e.$.trim(p.text)){var q=p.text,p=p.value;if(-1===k.indexOf(p.toLowerCase())){k.push(p.toLowerCase());var v=f.highlightMatchingText(q.toLowerCase(),R.toLowerCase());c.isAutoPrefilled||d===f.modelTypes.recentlySearchedModels&&(v+=m);var t=e.$("<li/>").addClass("a-size-base");c.isAutoPrefilled&&t.addClass("hsx-rpp-smartbox-list-suggestion-autoPrefilled-li");t.html(v);t.data({entity:b,id:p,action:c.action,modelType:d,modelInfo:q});t.hover(function(){e.$(this).addClass("hsx-rpp-smartbox-ac-hover")},
function(){e.$(this).removeClass("hsx-rpp-smartbox-ac-hover")});B.push(t);n++}}}return B};f.getSuggestionsPopoverHeader=function(a){var b=e.$("<li/>").addClass("a-size-base hsx-rpp-smartbox-list-header");b.html("<span class='hsx-rpp-smartbox-list-header-text a-color-secondary'>"+a+"</span>");return b};f.getSuggestionsLabel=function(a){return a="<span class='hsx-rpp-smartbox-autocomplete-lilabel a-color-secondary'>"+("<b>"+a+"<b/>")+"</span>"};f.updateSuggestions=function(a,b,g,y){if(a){c.removeClass("aok-hidden").html("");
if(y){g&&g.isPartNumber&&(y=y.replace("[part]",'<b><a class="hsx-rpp-smartbox-part-search" id="hsx-rpp-smartbox-part-search">'+g.partNumber+"</a></b>"));y=e.$("<span />").attr({"class":"a-size-base a-color-base"}).html(y);var l=e.$("<div/>").addClass("a-spacing-top-mini a-padding-small");l.append(y);c.append(l)}var B=e.$("<ul/>");k=[];g&&!g.partSearch&&(f.constructMyModelItems(B,a,b,g,f.modelTypes.recentlySearchedModels),f.constructMyModelItems(B,a,b,g,f.modelTypes.popularModels));b&&a[b]&&a[b].results&&
0<a[b].results.length&&(B.data({entity:b,total:a[b].total}),y="",g.partSearch||(y=g.isAutoPrefilled?f.getSuggestionsPopoverHeader(g.myModelTitle[f.modelTypes.elasticSearchModels]):f.getSuggestionsLabel(g.myModelTitle[f.modelTypes.elasticSearchModels])),a=f.getSuggestions(a[b].results,b,g,f.modelTypes.elasticSearchModels,y),"undefined"!==typeof a&&0<a.length&&(g.isAutoPrefilled&&B.append(y),e.$.each(a,function(a,b){B.append(b)}),c.append(B)));d.html()&&b?(f.updateresultsPopoverPosition(),d.removeClass("aok-hidden")):
d.addClass("aok-hidden");m.addClass("aok-hidden")}};f.constructMyModelItems=function(a,b,k,d,m){if(k&&b[k]&&b[k][m]&&b[k][m].results&&0<b[k][m].results.length){var l="";d.isAutoPrefilled?(l=f.getSuggestionsPopoverHeader(d.myModelTitle[m]),a=e.$("<ul/>").addClass("hsx-rpp-smartbox-list-suggestion-autoPrefilled-ul")):l=f.getSuggestionsLabel(d.myModelTitle[m]);b=f.getSuggestions(b[k][m].results,k,d,m,l);"undefined"!==typeof b&&0<b.length&&(d.isAutoPrefilled&&a.append(l),e.$.each(b,function(b,c){a.append(c)}),
c.append(a))}};f.hideSuggestionBox=function(){d.addClass("aok-hidden");a=-1};f.isSuggestedBoxDisplayed=function(){return!d.hasClass("aok-hidden")};f.adjustTextboxPosition=function(){l.css({"padding-left":"58 px"})};f.highlightMatchingText=function(a,b){if(a&&b&&1<b.length){if(a.match(b))return a.replace(b,"<b>"+b+"</b>");for(var c=a.split(/[ -]+/),k=[],d=0;d<c.length;d++)k.push(!1);for(var e=b.split(/[ -]+/),d=0;d<c.length;d++)for(var f=0;f<e.length;f++)if(c[d]===e[f]){c[d]=c[d].replace(e[f],"<b>"+
e[f]+"</b>");k[d]=!0;break}for(d=0;d<c.length;d++)for(f=0;f<e.length;f++)if(c[d].startsWith(e[f])&&!1===k[d]){c[d]=c[d].replace(e[f],"<b>"+e[f]+"</b>");break}return c.join(" ")}return a};f.updateresultsPopoverPosition=function(){a=-1;var b=f.findPos(l),c=l.innerWidth(),k=l.outerHeight();d.css({width:parseInt(c,10)+"px",top:b.y+k+"px",left:b.x+"px","z-index":b.zIndex,position:"absolute"})};f.toProperCase=function(a,b){b||(b=" ");for(var c=a.split(b),d=[],k=0;k<c.length;k++){var e=c[k].charAt(0).toUpperCase();
d.push(e+c[k].slice(1))}return d.join(b)};f.moveSelect=function(b){if(f.isSuggestedBoxDisplayed()){var c=e.$("li",d);if(!(0>b&&0===a||0<b&&a===c.length-1)&&(-1<a&&a<c.length&&e.$(c[a]).removeClass("hsx-rpp-smartbox-ac-hover"),a+=b,c&&0<=a&&a<c.length)){var k=e.$(c[a]);k&&(k.data("id")?k.addClass("hsx-rpp-smartbox-ac-hover"):(a+=b,0<=a&&a<c.length&&(k=e.$(c[a]),k.addClass("hsx-rpp-smartbox-ac-hover"))))}}};f.getHighlightedListItem=function(){if(f.isSuggestedBoxDisplayed()){var b=e.$("li",d);if(0<=
a&&a<b.length)return e.$(b[a])}else return null};f.highlightEntity=function(a){a.addClass("hsx-rpp-smartbox-highlight-entity")};f.isEntityHighlighted=function(a){return a.hasClass("hsx-rpp-smartbox-highlight-entity")};f.updatePart=function(a){l.val(a);f.hideSuggestionBox()};f.showExperienceEnhancePopover=function(a,c,k){c="/gp/replacement-parts/ajax/smartbox-experience-enhance-popover.html?pageType="+c+("&category="+k);b.create(a,{name:"rpp-smartbox-experienceEnhance-popover",url:c,width:"300",position:"triggerBottom"}).show();
q.setTimeout(function(b){f.removeExperienceEnhancePopover(a);f.experienceEnhancePopoverClose=!0},1E4)};f.removeExperienceEnhancePopover=function(a){null!==b.get(a)&&"undefined"!==b.get(a)&&b.remove(a);e.$("#hsx-rpp-smartbox-txtModelNumber").focus(function(a){a.preventDefault()})};return f})});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors,a=f?f("MiniSellerProfileAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,f){});
/* ******** */
